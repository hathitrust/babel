/*!
Copyright (c) 2011, 2012 Julien Wajsberg <felash@gmail.com>
All rights reserved.

Official repository: https://github.com/julienw/jquery-trap-input
License is there: https://github.com/julienw/jquery-trap-input/blob/master/LICENSE
This is version 1.2.0.
*/
(function(z,y){function w(d){if(d.keyCode===9){var c=!!d.shiftKey;v(this,d.target,c)&&(d.preventDefault(),d.stopPropagation())}}function v(G,F,E){var D=r(G),C=F,B,A,m,l;do{B=D.index(C),A=B+1,m=B-1,l=D.length-1;switch(B){case -1:return !1;case 0:m=l;break;case l:A=0}E&&(A=m),C=D.get(A);try{C.focus()}catch(i){}}while(F===F.ownerDocument.activeElement);return !0}function u(){return this.tabIndex>0}function t(){return !this.tabIndex}function s(d,c){return d.t-c.t||d.i-c.i}function r(a){var h=z(a),g=[],f=0;return n.enable&&n.enable(),h.find("a[href], link[href], [draggable=true], [contenteditable=true], :input:enabled, [tabindex=0]").filter(":visible").filter(t).each(function(d,c){g.push({v:c,t:0,i:f++})}),h.find("[tabindex]").filter(":visible").filter(u).each(function(d,c){g.push({v:c,t:c.tabIndex,i:f++})}),n.disable&&n.disable(),g=z.map(g.sort(s),function(b){return b.v}),z(g)}function q(){return this.keydown(w),this.data(x,!0),this}function p(){return this.unbind("keydown",w),this.removeData(x),this}function o(){return !!this.data(x)}var x="trap.isTrapping";z.fn.extend({trap:q,untrap:p,isTrapping:o});var n={};z.find.find&&z.find.attr!==z.attr&&function(){function h(c){var e=c.getAttributeNode(j);return e&&e.specified?parseInt(e.value,10):y}function b(){i[j]=i.tabIndex=h}function a(){delete i[j],delete i.tabIndex}var j="tabindex",i=z.expr.attrHandle;n={enable:b,disable:a}}()})(jQuery);
/* /htapps/tburtonw.babel/ls/web/js/jquery.trap.min-min.js */
jQuery.fn.boxy=function(a){a=a||{};return this.each(function(){var c=this.nodeName.toLowerCase(),b=this;if(c=="a"){jQuery(this).click(function(){var h=Boxy.linkedTo(this),e=this.getAttribute("href"),g=jQuery.extend({actuator:this,title:this.title},a);if(h){h.show()}else{if(e.indexOf("#")>=0){var f=jQuery(e.substr(e.indexOf("#"))),d=f.clone(true);f.remove();g.unloadOnHide=false;new Boxy(d,g)}else{if(!g.cache){g.unloadOnHide=true}Boxy.load(this.href,g)}}return false})}else{if(c=="form"){jQuery(this).bind("submit.boxy",function(){Boxy.confirm(a.message||"Please confirm:",function(){jQuery(b).unbind("submit.boxy").submit()});return false})}}})};function Boxy(b,a){this.boxy=jQuery(Boxy.WRAPPER);jQuery.data(this.boxy[0],"boxy",this);this.visible=false;this.options=jQuery.extend({},Boxy.DEFAULTS,a||{});if(this.options.modal){this.options=jQuery.extend(this.options,{center:true,draggable:false})}if(this.options.actuator){jQuery.data(this.options.actuator,"active.boxy",this)}this.setContent(b||"<div></div>");this._setupTitleBar();this.boxy.css("display","none").appendTo(document.body);this.toTop();if(this.options.fixed){if(jQuery.browser.msie&&jQuery.browser.version<7){this.options.fixed=false}else{this.boxy.addClass("fixed")}}if(this.options.center&&Boxy._u(this.options.x,this.options.y)){this.center()}else{this.moveTo(Boxy._u(this.options.x)?this.options.x:Boxy.DEFAULT_X,Boxy._u(this.options.y)?this.options.y:Boxy.DEFAULT_Y)}if(this.options.show){this.show()}}Boxy.EF=function(){};jQuery.extend(Boxy,{WRAPPER:"<table cellspacing='0' cellpadding='0' border='0' class='boxy-wrapper'><tr><td class='top-left'></td><td class='top'></td><td class='top-right'></td></tr><tr><td class='left'></td><td class='boxy-inner'></td><td class='right'></td></tr><tr><td class='bottom-left'></td><td class='bottom'></td><td class='bottom-right'></td></tr></table>",DEFAULTS:{title:null,closeable:true,draggable:true,clone:false,actuator:null,center:true,show:true,modal:false,fixed:true,closeText:"[close]",unloadOnHide:false,clickToFront:false,behaviours:Boxy.EF,afterDrop:Boxy.EF,afterShow:Boxy.EF,afterHide:Boxy.EF,beforeUnload:Boxy.EF},DEFAULT_X:50,DEFAULT_Y:50,zIndex:1337,dragConfigured:false,resizeConfigured:false,dragging:null,load:function(b,a){a=a||{};var c={url:b,type:"GET",dataType:"html",cache:false,success:function(d){d=jQuery(d);if(a.filter){d=jQuery(a.filter,d)}new Boxy(d,a)}};jQuery.each(["type","cache"],function(){if(this in a){c[this]=a[this];delete a[this]}});jQuery.ajax(c)},get:function(a){var b=jQuery(a).parents(".boxy-wrapper");return b.length?jQuery.data(b[0],"boxy"):null},linkedTo:function(a){return jQuery.data(a,"active.boxy")},alert:function(b,c,a){return Boxy.ask(b,["OK"],c,a)},confirm:function(b,c,a){return Boxy.ask(b,["OK","Cancel"],function(d){if(d=="OK"){c()}},a)},ask:function(c,f,j,l){l=jQuery.extend({modal:true,closeable:false},l||{},{show:true,unloadOnHide:true});var e=jQuery("<div></div>").append(jQuery('<div class="question"></div>').html(c));var a={},h=[];if(f instanceof Array){for(var d=0;d<f.length;d++){a[f[d]]=f[d];h.push(f[d])}}else{for(var b in f){a[f[b]]=b;h.push(f[b])}}var g=jQuery('<form class="answers"></form>');g.html(jQuery.map(h,function(i){return"<input type='button' value='"+i+"' />"}).join(" "));jQuery("input[type=button]",g).click(function(){var i=this;Boxy.get(this).hide(function(){if(j){j(a[i.value])}})});e.append(g);new Boxy(e,l)},isModalVisible:function(){return jQuery(".boxy-modal-blackout").length>0},_u:function(){for(var a=0;a<arguments.length;a++){if(typeof arguments[a]!="undefined"){return false}}return true},_handleResize:function(a){var b=jQuery(document);jQuery(".boxy-modal-blackout").css("display","none").css({width:b.width(),height:b.height()}).css("display","block")},_handleDrag:function(a){var b;if(b=Boxy.dragging){b[0].boxy.css({left:a.pageX-b[1],top:a.pageY-b[2]})}},_nextZ:function(){return Boxy.zIndex++},_viewport:function(){var e=document.documentElement,a=document.body,c=window;return jQuery.extend(jQuery.browser.msie?{left:a.scrollLeft||e.scrollLeft,top:a.scrollTop||e.scrollTop}:{left:c.pageXOffset,top:c.pageYOffset},!Boxy._u(c.innerWidth)?{width:c.innerWidth,height:c.innerHeight}:(!Boxy._u(e)&&!Boxy._u(e.clientWidth)&&e.clientWidth!=0?{width:e.clientWidth,height:e.clientHeight}:{width:a.clientWidth,height:a.clientHeight}))}});Boxy.prototype={estimateSize:function(){this.boxy.css({visibility:"hidden",display:"block"});var a=this.getSize();this.boxy.css("display","none").css("visibility","visible");return a},getSize:function(){return[this.boxy.width(),this.boxy.height()]},getContentSize:function(){var a=this.getContent();return[a.width(),a.height()]},getPosition:function(){var a=this.boxy[0];return[a.offsetLeft,a.offsetTop]},getCenter:function(){var b=this.getPosition();var a=this.getSize();return[Math.floor(b[0]+a[0]/2),Math.floor(b[1]+a[1]/2)]},getInner:function(){return jQuery(".boxy-inner",this.boxy)},getContent:function(){return jQuery(".boxy-content",this.boxy)},setContent:function(a){a=jQuery(a).css({display:"block"}).addClass("boxy-content");if(this.options.clone){a=a.clone(true)}this.getContent().remove();this.getInner().append(a);this._setupDefaultBehaviours(a);this.options.behaviours.call(this,a);return this},moveTo:function(a,b){this.moveToX(a).moveToY(b);return this},moveToX:function(a){if(typeof a=="number"){this.boxy.css({left:a})}else{this.centerX()}return this},moveToY:function(a){if(typeof a=="number"){this.boxy.css({top:a})}else{this.centerY()}return this},centerAt:function(a,c){var b=this[this.visible?"getSize":"estimateSize"]();if(typeof a=="number"){this.moveToX(a-b[0]/2)}if(typeof c=="number"){this.moveToY(c-b[1]/2)}return this},centerAtX:function(a){return this.centerAt(a,null)},centerAtY:function(a){return this.centerAt(null,a)},center:function(b){var a=Boxy._viewport();var c=this.options.fixed?[0,0]:[a.left,a.top];if(!b||b=="x"){this.centerAt(c[0]+a.width/2,null)}if(!b||b=="y"){this.centerAt(null,c[1]+a.height/2)}return this},centerX:function(){return this.center("x")},centerY:function(){return this.center("y")},resize:function(b,a,d){if(!this.visible){return}var c=this._getBoundsForResize(b,a);this.boxy.css({left:c[0],top:c[1]});this.getContent().css({width:c[2],height:c[3]});if(d){d(this)}return this},tween:function(c,a,e){if(!this.visible){return}var d=this._getBoundsForResize(c,a);var b=this;this.boxy.stop().animate({left:d[0],top:d[1]});this.getContent().stop().animate({width:d[2],height:d[3]},function(){if(e){e(b)}});return this},isVisible:function(){return this.visible},show:function(){if(this.visible){return}if(this.options.modal){var a=this;if(!Boxy.resizeConfigured){Boxy.resizeConfigured=true;jQuery(window).resize(function(){Boxy._handleResize()})}this.modalBlackout=jQuery('<div class="boxy-modal-blackout"></div>').css({zIndex:Boxy._nextZ(),opacity:0.7,width:jQuery(document).width(),height:jQuery(document).height()}).appendTo(document.body);this.toTop();if(this.options.closeable){jQuery(document.body).bind("keypress.boxy",function(b){var c=b.which||b.keyCode;if(c==27){a.hide();jQuery(document.body).unbind("keypress.boxy")}});this.modalBlackout.bind("click",function(){a.hide()})}}this.boxy.stop().css({opacity:1}).show();this.visible=true;this._fire("afterShow");return this},hide:function(b){if(!this.visible){return}var a=this;if(this.options.modal){jQuery(document.body).unbind("keypress.boxy");this.modalBlackout.animate({opacity:0},function(){jQuery(this).remove()})}this.boxy.stop().animate({opacity:0},300,function(){a.boxy.css({display:"none"});a.visible=false;a._fire("afterHide");if(b){b(a)}if(a.options.unloadOnHide){a.unload()}});return this},toggle:function(){this[this.visible?"hide":"show"]();return this},hideAndUnload:function(a){this.options.unloadOnHide=true;this.hide(a);return this},unload:function(){this._fire("beforeUnload");this.boxy.remove();if(this.options.actuator){jQuery.data(this.options.actuator,"active.boxy",false)}},toTop:function(){this.boxy.css({zIndex:Boxy._nextZ()});return this},getTitle:function(){return jQuery("> .title-bar h2",this.getInner()).html()},setTitle:function(a){jQuery("> .title-bar h2",this.getInner()).html(a);return this},_getBoundsForResize:function(c,a){var b=this.getContentSize();var e=[c-b[0],a-b[1]];var d=this.getPosition();return[Math.max(d[0]-e[0]/2,0),Math.max(d[1]-e[1]/2,0),c,a]},_setupTitleBar:function(){if(this.options.title){var b=this;var a=jQuery("<div class='title-bar'></div>").html("<h2>"+this.options.title+"</h2>");if(this.options.closeable){a.append(jQuery("<a href='#' class='close'></a>").html(this.options.closeText))}if(this.options.draggable){a[0].onselectstart=function(){return false};a[0].unselectable="on";a[0].style.MozUserSelect="none";if(!Boxy.dragConfigured){jQuery(document).mousemove(Boxy._handleDrag);Boxy.dragConfigured=true}a.mousedown(function(c){b.toTop();Boxy.dragging=[b,c.pageX-b.boxy[0].offsetLeft,c.pageY-b.boxy[0].offsetTop];jQuery(this).addClass("dragging")}).mouseup(function(){jQuery(this).removeClass("dragging");Boxy.dragging=null;b._fire("afterDrop")})}this.getInner().prepend(a);this._setupDefaultBehaviours(a)}},_setupDefaultBehaviours:function(a){var b=this;if(this.options.clickToFront){a.click(function(){b.toTop()})}jQuery(".close",a).click(function(){b.hide();return false}).mousedown(function(c){c.stopPropagation()})},_fire:function(a){this.options[a].call(this)}};
/* /htapps/tburtonw.babel/ls/web/js/jquery.boxy-min.js */
var displayLSFeedback=function(){var d="[Your email address]";var c=window.location.pathname;var b=96;var e=4096;var f="/cgi";if(c.indexOf("/shcgi/")>=0){f="/shcgi"}var a=f+"/feedback";var h='<div id="mdpFeedbackForm"><form method="POST" action="{feedbackUrl}" id="CBfeedback" name="CBfeedback"><input type="hidden" value="ls" name="m" /><input type="hidden" value="Large-scale Search" name="id" /><div id="mdpEmail" class="row"><label id="mdpEmailLabel" for="email">To request a reply, enter your email address below.</label><span><input id="email" name="email" class="overlay" value="{DEFAULT_EMAIL_VALUE}" size="50" maxlength="{emailLen}" /></span></div><div id="mdpFlexible_2_Other" class="row"><label id="mdpCommentsLabel" for="comments">Problems or comments?</label><textarea name="comments" id="comments" class="overlay" rows="4" maxlength="{commentsLen}"></textarea></div><div id="emptyFBError" aria-live="assertive" aria-atomic="true"></div><div id="mdpFBtools"><div class="mdpFBbuttons"><input id="mdpFBinputbutton" type="submit" name="op" value="Submit" /><a id="mdpFBcancel" href="#"><strong>Cancel</strong></a></div></div></form></div>';h=h.replace("{DEFAULT_EMAIL_VALUE}",d).replace("{feedbackUrl}",a).replace("{emailLen}",b).replace("{commentsLen}",e);var j=$(h).appendTo("body");var g=j.find("form");var k=g.get(0);var i=new Boxy(j,{show:false,modal:true,draggable:false,closeable:true,closeText:"<span class='accessBannerCloseText'>close</span> <span class='accessBannerClose'>X</span></span>",clone:false,unloadOnHide:true,title:"Feedback"});if(!g.data("initialized")){$("#email").bind("click",function(){clickclear(this,d)}).bind("focus",function(){clickclear(this,d)}).bind("blur",function(){clickrecall(this,d)});$("input[type=submit], #mdpFBcancel",g).click(function(p){var o=this;p.preventDefault();var n=Boxy.get(this);if($(this).attr("id")=="mdpFBcancel"){n.hide().getContent().untrap();return false}var q=1;var l={};for(var m=0;m<k.length;m++){if((k.elements[m].type=="checkbox"||k.elements[m].type=="radio")&&k.elements[m].checked){q=0;l[k.elements[m].name]=k.elements[m].value}else{if((k.elements[m].type=="text"||k.elements[m].type=="textarea")&&(k.elements[m].value.length>0)&&(k.elements[m].value!=d)){q=0;l[k.elements[m].name]=k.elements[m].value}else{if(k.elements[m].type=="hidden"){l[k.elements[m].name]=k.elements[m].value}}}}if(q==1){$(k).find("#emptyFBError").append("<strong>You must enter feedback before submitting or cancel.</strong>");return false}$(k).submit()});g.data("initialized",true)}$("#emptyFBError").empty();i.show().getContent().trap();i.getInner().find(".title-bar h2").attr("tabindex","-1").focus();return false};$(document).ready(function(){$("#feedback, #feedback_footer").click(function(a){a.preventDefault();displayLSFeedback();return false})});
/* /htapps/tburtonw.babel/ls/web/js/feedbackLSForm-min.js */
head.ready(function(){var b=(window.location.protocol=="https:"?"https://encrypted.google.com":"http://books.google.com")+"/books?callback=?";var a=60;$("[data-bookid]").each(function(){var d=$(this);var c=d.data("bookid");$.getJSON(b,{jscmd:"viewapi",bibkeys:c},function(g){if(g.length==0){var f=$('<img class="bookCover" aria-hidden="true" alt=""/>');f.attr("src","/common/unicorn/img/nocover-thumbnail.png");d.append(f)}var e=selectGoogleLink(g,1,1);if(e.thumbnail_url){var f=$('<img class="bookCover" aria-hidden="true" alt=""/>');f.load(function(){f=jQuery(this);owidth=f.attr("width");if(owidth>a){f.attr("width",a);f.attr("height",f.attr("height")*(a/owidth))}d.append(f)}).attr("src",e.thumbnail_url)}else{var f=$('<img class="bookCover" aria-hidden="true" alt=""/>');f.attr("src","/common/unicorn/img/nocover-thumbnail.png");d.append(f)}})})});function getGoogleBookInfo(a,b,f){var g="";var c="";var d="";var h="";if(a.length>0){var e="//books.google.com/books?jscmd=viewapi&bibkeys="+a+"&callback=?";jQuery.getJSON(e,function(j){if(j.length==0){return}var i="";googleLink=selectGoogleLink(j,b,f);if(googleLink.searchNum){jQuery("#ELEC_holdings").append('<tr><th></th><td style="width: 50%;"></td><td>'+googleLink.link+"</td></tr>");jQuery("#dummyElec").show();if(jQuery("#ELEC_"+b).length){jQuery("#ELEC_"+b).replaceWith('<tr><td class="holdingLocation">Electronic Resources</td><td><a href="/Record/'+b+'/Holdings#holdings">See Holdings</a></td>')}else{jQuery("#holdings"+b).append('<tr><td class="holdingLocation">Electronic Resources</td><td>'+googleLink.link+"</td></tr>")}}if(googleLink.thumbnail_url){img=jQuery('<img class="bookCover" aria-hidden="true" alt="">');img.load(function(){img=jQuery(this);owidth=img.attr("width");if(owidth>75){img.attr("width",75);img.attr("height",img.attr("height")*(75/owidth))}jQuery("#GoogleCover_"+b).empty().append(img).show()}).attr("src",googleLink.thumbnail_url)}})}}function getViewRank(a){if(a=="noview"){return 0}if(a=="partial"){return 2}if(a=="full"){return 3}return 0}function selectGoogleLink(f,a,d){var c=[];c.thumbnailImg="";c.link="";c.searchNum="";var b=0;for(num in f){var e=getViewRank(f[num].preview);if(f[num].thumbnail_url){c.thumbnailImg='<img alt="Cover Image" src="'+f[num].thumbnail_url+'">';c.thumbnail_url=f[num].thumbnail_url}if(e>b){if(f[num].thumbnail_url){c.thumbnailImg='<img alt="Cover Image" src="'+f[num].thumbnail_url+'">'}b=e;viewInfo=translateGooglePreview(f[num].preview);c.link='<a class="clickpostlog" ref="googlebook|'+a+"|google|"+d+'" href="'+f[num].preview_url+'" target="fulltext">Google Online ('+viewInfo+")</a>";c.searchNum=num}}return c}function translateGooglePreview(a){if(a=="full"){return("Available Online")}if(a=="noview"){return("Snippet View")}if(a=="partial"){return("Limited View")}return(a)};
/* /htapps/tburtonw.babel/ls/web/js/google_covers-min.js */
head.ready(function(){var b=$("select[name=sz],select[name=sort]");b.each(function(){f(this)});function f(g){g.changed=false;g.onfocus=e;g.onchange=d;g.onkeydown=c;g.onclick=a;return true}function d(j){var g;if(j&&j.value){g=j}else{g=this}if(g.changed||g.value!=g.initValue){var l=window.location.href;var k=l;var h=g.name;var i=new RegExp(";?"+h+"=([^;&]+);?","g");l=l.replace(i,"");l+=";"+h+"="+g.value;window.location.href=l}return false}function a(){this.changed=true}function e(){this.initValue=this.value;return true}function c(i){var j;var k="9";var h="13";var g="27";if(i){j=i}else{j=event}if((j.keyCode==h||j.keyCode==k)&&this.value!=this.initValue){this.changed=true;selectChanged(this)}else{if(j.keyCode==g){this.value=this.initValue}else{this.changed=false}}return true}});
/* /htapps/tburtonw.babel/ls/web/js/search_tools-min.js */
head.ready(function(){var f="0";var b="__NEW__";var r="";var a=[];var i=25;var p=$("#c2");var c=$(".errormsg");var u=$(".toolbar.alt");var e=$("#checkAll");var o=$(".select input[type=checkbox]");function t(v){if(!c.length){c=$('<div class="alert alert-error"></div>').insertAfter(u)}c.text(v).show()}function l(){c.hide().text()}function k(){var v="/cgi/mb";if(location.pathname.indexOf("/shcgi/")>-1){v="/shcgi/mb"}return v}function d(v){var w=[];v.each(function(){w.push($(this).val())});return w}function q(y){var v={};var x=y.split("|");for(var w=0;w<x.length;w++){kv=x[w].split("=");v[kv[0]]=kv[1]}return v}function g(){o.attr("checked",null);e.attr("checked",null)}function j(x){var v=$("select[name=c2]");var w=v.find("option[value='"+x.coll_id+"']");if(!w.length){w=$("<option></option>").val(x.coll_id).text(x.coll_name).appendTo(v)}}function h(x){var B=$(".mb-status");if(!B.length){B=$('<div class="mb-status alert alert-success"></div>').prependTo($(".main")).hide()}var C=x.coll_id;var z=x.coll_name;var A='<a href="mb?a=listis;c='+C+'">'+z+"</a>";var D=x.NumAdded;var y=x.NumFailed;var v;var w;if(y>0){w="numFailed items could not be added to your collection,\n "+D+" items were added to "+A}else{if(D>1){w=D+" items were added to "+A}else{w=D+" item was added to "+A}}B.html(w).show();j(x);g()}function n(z,y){var x={movit:true,delit:true,movitnc:true};if(!x[z.a]){z.page="ajax"}if(z.page=="ajax"){$.ajax({url:k(),data:$.param(z,true)}).done(function(A){console.log(A);var B=q(A);$(".btn-loading").removeClass("btn-loading");h(B);if(y){y()}})}else{var v=$.extend({},$.url().param(),z);var w=$("<form method='POST'></form>");w.attr("action",k());_.each(_.keys(v),function(B){var A=v[B];A=$.isArray(A)?A:[A];_.each(A,function(C){$("<input type='hidden' />").attr({name:B}).val(C).appendTo(w)})});w.submit()}}function m(w){var v=$.extend({creating:false,label:"Save Changes"},w);var z=new Image();z.src="/common/unicorn/img/throbber.gif";var x=$('<form class="form-horizontal" action="mb"><div class="control-group"><label class="control-label" for="edit-cn">Collection Name</label><div class="controls"><input type="text" class="input-large" maxlength="100" name="cn" id="edit-cn" value="" placeholder="Your collection name" /><span class="label counter" id="edit-cn-count">100</span></div></div><div class="control-group"><label class="control-label" for="edit-desc">Description</label><div class="controls"><textarea id="edit-desc" name="desc" rows="4" maxlength="255" class="input-large" placeholder="Add your collection description."></textarea><span class="label counter" id="edit-desc-count">255</span></div></div><div class="control-group"><div class="controls"><label class="radio inline"><input type="radio" name="shrd" id="edit-shrd-0" value="0" checked="checked" > Private </label><label class="radio inline"><input type="radio" name="shrd" id="edit-shrd-1" value="1" > Public </label></div></div></form>');x.attr("action",k());if(v.cn){x.find("input[name=cn]").val(v.cn)}if(v.desc){x.find("textarea[name=desc]").val(v.desc)}if(v.shrd!=null){x.find("input[name=shrd][value="+v.shrd+"]").attr("checked","checked")}else{if(!HT.login_status.logged_in){x.find("input[name=shrd][value=0]").attr("checked","checked");$('<div class="alert alert-info">Login to create public/permanent collections.</div>').appendTo(x);x.find("input[name=shrd][value=1]").parent().remove()}}if(v.$hidden){v.$hidden.clone().appendTo(x)}else{$("<input type='hidden' name='c' />").appendTo(x).val(v.c);$("<input type='hidden' name='a' />").appendTo(x).val(v.a)}if(v.$selected){v.$selected.clone().attr("type","hidden").appendTo(x)}var y=bootbox.dialog(x,[{label:"Cancel","class":"btn-dismiss"},{label:v.label,"class":"btn-primary",callback:function(){var B=$.trim(x.find("input[name=cn]").val());var A=$.trim(x.find("textarea[name=desc]").val());if(!B){$('<div class="alert alert-error">You must enter a collection name.</div>').appendTo(x);return false}y.find(".btn-primary").addClass("btn-loading");n({a:v.a,id:d(v.$selected),cn:B,desc:A,shrd:x.find("input[name=shrd]").val()},function(){y.modal("hide")});return false}}]);y.find("input[type=text],textarea").each(function(){var C=$(this);var B=$("#"+C.attr("id")+"-count");var A=C.attr("maxlength");B.text(A-C.val().length);C.bind("keyup",function(){B.text(A-C.val().length)})})}function s(v,z,y){if(v<=1000&&v+z>1000){var w;if(z>1){w="these "+z+" items"}else{w="this item"}var x="Note: Your collection contains "+v+" items.  Adding "+w+" to your collection will increase its size to more than 1000 items.  This means your collection will not be searchable until it is indexed, usually within 48 hours.  After that, just newly added items will see this delay before they can be searched. \n\nDo you want to proceed?";confirm(x,function(A){if(A){y()}})}else{y()}}e.click(function(w){var v=$(this).attr("checked")||null;o.attr("checked",v)});$(".SelectedItemActions button").click(function(A){A.preventDefault();var y=this.id;var B=$(this);l();var C=p.val();var z=p.find("option:selected").text();var v=$(".id:checked");if(v.length==0){t("You must choose an item");return}if((C==f)&&(y=="copyit"||y=="movit"||y=="addI"||y=="addits")){t("You must select a collection.");return}if(C==b){m({creating:true,$selected:v,a:y+"nc"});return}B.addClass("btn-loading");var D=v.length;var w=getCollSizeArray();var x=w[C];s(x,D,function(){n({a:y,id:d(v),c2:C})})});$("#trigger-editc").click(function(w){w.preventDefault();var v=$(this);m({a:"editc",cn:v.data("cn"),desc:v.data("desc"),shrd:v.data("shrd"),c:v.data("c")})})});
/* /htapps/tburtonw.babel/ls/web/js/collection_tools-min.js */
(function(a){if(typeof define==="function"&&define.amd){if(typeof jQuery!=="undefined"){define(["jquery"],a)}else{define([],a)}}else{if(typeof jQuery!=="undefined"){a(jQuery)}else{a()}}})(function(b,e){var q={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],p={anchor:"fragment"},a={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},l=Object.prototype.toString,s=/^[0-9]+$/;function o(u,x){var z=decodeURI(u),w=a[x||false?"strict":"loose"].exec(z),y={attr:{},param:{},seg:{}},v=14;while(v--){y.attr[t[v]]=w[v]||""}y.param.query=f(y.attr.query);y.param.fragment=f(y.attr.fragment);y.seg.path=y.attr.path.replace(/^\/+|\/+$/g,"").split("/");y.seg.fragment=y.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");y.attr.base=y.attr.host?(y.attr.protocol?y.attr.protocol+"://"+y.attr.host:y.attr.host)+(y.attr.port?":"+y.attr.port:""):"";return y}function m(v){var u=v.tagName;if(typeof u!=="undefined"){return q[u.toLowerCase()]}return u}function c(x,w){if(x[w].length==0){return x[w]={}}var v={};for(var u in x[w]){v[u]=x[w][u]}x[w]=v;return v}function k(y,w,v,z){var u=y.shift();if(!u){if(g(w[v])){w[v].push(z)}else{if("object"==typeof w[v]){w[v]=z}else{if("undefined"==typeof w[v]){w[v]=z}else{w[v]=[w[v],z]}}}}else{var x=w[v]=w[v]||[];if("]"==u){if(g(x)){if(""!=z){x.push(z)}}else{if("object"==typeof x){x[j(x).length]=z}else{x=w[v]=[w[v],z]}}}else{if(~u.indexOf("]")){u=u.substr(0,u.length-1);if(!s.test(u)&&g(x)){x=c(w,v)}k(y,x,u,z)}else{if(!s.test(u)&&g(x)){x=c(w,v)}k(y,x,u,z)}}}}function d(y,x,B){if(~x.indexOf("]")){var A=x.split("["),u=A.length,z=u-1;k(A,y,"base",B)}else{if(!s.test(x)&&g(y.base)){var w={};for(var v in y.base){w[v]=y.base[v]}y.base=w}i(y.base,x,B)}return y}function f(u){return h(String(u).split(/&|;/),function(v,A){try{A=decodeURIComponent(A.replace(/\+/g," "))}catch(x){}var B=A.indexOf("="),z=n(A),w=A.substr(0,z||B),y=A.substr(z||B,A.length),y=y.substr(y.indexOf("=")+1,y.length);if(""==w){w=A,y=""}return d(v,w,y)},{base:{}}).base}function i(x,w,y){var u=x[w];if(e===u){x[w]=y}else{if(g(u)){u.push(y)}else{x[w]=[u,y]}}}function n(x){var u=x.length,w,y;for(var v=0;v<u;++v){y=x[v];if("]"==y){w=false}if("["==y){w=true}if("="==y&&!w){return v}}}function h(y,v){var w=0,u=y.length>>0,x=arguments[2];while(w<u){if(w in y){x=v.call(e,x,y[w],w,y)}++w}return x}function g(u){return Object.prototype.toString.call(u)==="[object Array]"}function j(v){var u=[];for(prop in v){if(v.hasOwnProperty(prop)){u.push(prop)}}return u}function r(u,v){if(arguments.length===1&&u===true){v=true;u=e}v=v||false;u=u||window.location.toString();return{data:o(u,v),attr:function(w){w=p[w]||w;return typeof w!=="undefined"?this.data.attr[w]:this.data.attr},param:function(w){return typeof w!=="undefined"?this.data.param.query[w]:this.data.param.query},fparam:function(w){return typeof w!=="undefined"?this.data.param.fragment[w]:this.data.param.fragment},segment:function(w){if(typeof w==="undefined"){return this.data.seg.path}else{w=w<0?this.data.seg.path.length+w:w-1;return this.data.seg.path[w]}},fsegment:function(w){if(typeof w==="undefined"){return this.data.seg.fragment}else{w=w<0?this.data.seg.fragment.length+w:w-1;return this.data.seg.fragment[w]}}}}if(typeof b!=="undefined"){b.fn.url=function(v){var u="";if(this.length){u=b(this).attr(m(this[0]))||""}return r(u,v)};b.url=r}else{window.purl=r}});
/* /htapps/tburtonw.babel/ls/web/js/purl-min.js */
function get_selected(d){var c=document.getElementById(d);var a=c.selectedIndex;var b=c.options[a].value;return b}function jumpToColl(){var a=window.location;var j=a.host;var m=a.pathname;var i=a.protocol;var b=a.search;var f=get_selected("jumpToColl");var e="a=listis;c="+f;var g;var h=/(sz=[^\&\;]+)[\&\;]/;var k=b.match(h);if(k!==null){g=k[1];e=e+";"+g+";"}m=m.replace(/ptsearch/g,"mb");m=m.replace(/pt/g,"mb");m=m.replace(/ls/g,"mb");var d=i+"//"+j+m+"?"+e;window.location=d}function doSort(){var b=window.location.toString();var c=get_selected("SortWidgetSort");var a;if(/sort/.test(b)){a=b.replace(/sort=(title|auth|date|rel)_[ad]/,"sort="+c)}else{a=b+";sort="+c}window.location=a}function get_new_size(d){var b=document.getElementById(d);var a=b.selectedIndex;var c=b.options[a].value;return c}function redisplay_new_slice_size(d){var e=d;var b=window.location.toString();var c=get_new_size(e);var a;var f;if(/a=listsrchm/.test(b)){a=b.replace(/a=listsrchm/,"a=srchm");b=a}if(/sz/.test(b)){a=b.replace(/sz=(\d+)/,"sz="+c)}else{a=b+";sz="+c}if(/pn/.test(a)){f=a.replace(/pn=(\d+)/,"pn=1")}else{f=a+";pn=1"}location=f}var root=document.getElementById("itemTable");var checkboxes;var checkIt=function(a){a.checked=true};var unCheckIt=function(a){a.checked=false};var checkAll=function(){checkboxes=YAHOO.util.Dom.getElementsByClassName("iid","input",root,checkIt)};var uncheckAll=function(){checkboxes=YAHOO.util.Dom.getElementsByClassName("iid","input",root,unCheckIt)};var changeAllCheckboxes=function(b){var a;if(typeof b.currentTarget!="undefined"){a=b.currentTarget}else{a=b.srcElement}if(a.checked===true){checkAll()}else{uncheckAll()}};function initCheckall(){YAHOO.util.Event.addListener("checkAll","click",changeAllCheckboxes)}function doYouReally(a){return confirm("Really delete collection: "+a+"?")}function confirmLarge(a,e){if(a+e<=1000){return true}else{if(a<=1000){var c;if(e>1){c="these "+e+" items"}else{c="this item"}var d="Note: Your collection contains "+a+" items.  Adding "+c+" to your collection will increase its size to more than 1000 items.  This means your collection will not be searchable until it is indexed, usually within 48 hours.  After that, just newly added items will see this delay before they can be searched. \n\nDo you want to proceed?";var b=confirm(d);if(b){return true}else{return false}}else{return true}}};
/* /htapps/tburtonw.babel/ls/web/js/listUtils-min.js */
YAHOO.namespace("mbooks");var sDEBUG=false;function dMsg(a){if(sDEBUG===true){alert(a)}}function displayErrorMsg(a){search_errormsg.setBody(a);search_errormsg.show()}function getCgiParams(){var h={};var g=window.location.toString();var b=g.split(/\?/);if(b[1]){var f=b[1].split(/\;|\&/);for(var d=0;d<f.length;d++){var a=f[d].split(/\=/);var c=a[0];var e=a[1];h[c]=e}}return h}function getForm(a){return document.getElementById("itemlist_searchform")}function initSearchErrorMessage(b){var a="errormsg";search_errormsg=new YAHOO.widget.Module(a,{visible:false});search_errormsg.render()}function processSearch(d){dMsg("processSearch was called");var c=getForm(d);var a=c.q1.value;var f=c.id;initSearchErrorMessage(f);a=a.replace(/^\s*|\s*$/g,"");if(a===""){var b="<div class='error'>Please enter a search term.</div>";displayErrorMsg(b);return false}else{return c.submit()}}var interceptSubmitByEnter=function(a){YAHOO.util.Event.stopEvent(a);processSearch(a);return false};YAHOO.util.Event.addListener("itemlist_searchform","submit",interceptSubmitByEnter);
/* /htapps/tburtonw.babel/ls/web/js/search-min.js */
head.ready(function(){$("a.lessfacets").hide();$("a.morefacets").bind("click",function(b){var f=getFacetClass(this);var e="dd."+f;$(e).css("display","block").css("visibility","visible");var d="a.morefacets."+f;$(d).hide();var a="a.lessfacets."+f;$(a).show();b.preventDefault()});$("a.lessfacets").bind("click",function(b){var f=getFacetClass(this);var e="dd."+f+".hidefacet";$(e).hide();var d="a.morefacets."+f;$(d).show();var a="a.lessfacets."+f;$(a).hide();b.preventDefault()})});function getFacetClass(b){var a=$(b).attr("class").split(" ");var d=a[0];return d};
/* /htapps/tburtonw.babel/ls/web/js/ls_misc-min.js */
head.ready(function(){if($.browser.msie&&$.browser.version<8){$("#advanced_searchform").css("visibility","visible");$(".IEcell.parenRight.parenGroup1").replaceWith('<td class="IEtd paren parenGroup1">)</td>');$(".IEcell.parenLeft.parenGroup1").replaceWith('<td class="IEtd paren  parenGroup1">(</td>');$(".IEcell.parenRight").replaceWith('<td class="IEtd paren">)</td>');$(".IEcell.parenLeft").replaceWith('<td class="IEtd paren">(</td>');$(".IEmiddleCell").wrap('<td class="IEtd"/>');$(".IErow").wrap('<tr class="IEtr"/>');$(".parenGroup").wrapInner('<table class="IEtable" />')}showHidePdates();if($("#q3").val()==""&&$("#q4").val()==""){$(".parenGroup1").css("visibility","hidden");hideGroup2();$("#removeGroup").hide()}else{$("#addGroup").hide()}$("#addGroup").click(function(a){showGroup2();$(".parenGroup1").css("visibility","visible");$("#removeGroup").show();$("#addGroup").hide();a.preventDefault()});$("#removeGroup").click(function(a){$("#q3").val("");$("#q4").val("");hideGroup2();$(".parenGroup1").css("visibility","hidden");$("#removeGroup").hide();$("#addGroup").show();a.preventDefault()});$("#reset").click(function(a){doReset(a);a.preventDefault()});$("#advanced_searchform").submit(function(c){var b=checkForQuery();if(b===true){var a=checkPdate();if(a===false){}else{var d=new Array();d=getRowNums();redirect(d)}}c.preventDefault()})});function doReset(c){var b=$("#advanced_searchform").find("input:text");$(b).val("");var a=$("#advanced_searchform").find(".orFacet :selected");a.attr("selected",false);$(".orFacet [value='language:All']").attr("selected",true);$(".orFacet [value='format:All']").attr("selected",true);$("#advanced_searchform").find("input:checked").attr("checked",false);$("#anyall1 option").attr("selected",false);$("#anyall1 option[value='all']").attr("selected",true);$("#anyall2 option").attr("selected",false);$("#anyall2 option[value='all']").attr("selected",true);$("#op2 option").attr("selected",false);$("#op2 option[value='AND'] ").attr("selected",true);$("#field1 option").attr("selected",false);$("#field1 option[value='ocr']").attr("selected",true);$("#field2 option").attr("selected",false);$("#field2 option[value='title']").attr("selected",true);$("#yop option").attr("selected",false);$("#yop option[value='after']").attr("selected",true);$("#yop-between").val("").hide();$("#yop-end").val("").hide();$("#yop-start").val("").show()}function checkPdate(){var e=true;var d=$(":input.yop");$(d).each(function(f,g){var i=$(g).val();if((i.match(/^\s*\d+\s*$/))||(i==="")){}else{var h="You must enter a number from 0 to 9999 for the publication date";showErrMsg(h,"yopErrMsg");e=false;return e}});if(e===true){var a=$("#yop-start").val();var c=$("#yop-end").val();if(a===""){a=0}if(c===""){c=10000}if(a>c){var b="start date must be less than end date";showErrMsg(b,"yopErrMsg");return false}}return e}function checkForQuery(){var a=false;var b=$("#advanced_searchform").find(":input.querybox");$(b).each(function(d,e){var f=$(e).val();if(f!==""){a=true}});if(a===false){var c="Please enter a search term.";showErrMsg(c,"submitErrMsg");showErrMsg(c,"queryErrMsg")}return a}function showErrMsg(a,c){var b="#"+c;$("<div  class='alert-error alert' ></div>").html(a).appendTo(b)}function getRowNums(){var b=new Array();var a=0;$("#advanced_searchform").find(":input.querybox").each(function(d){var c=d+1;var e=$(this).val();if(e===""){}else{b[a]=c;a++}});return b}function redirect(c){var a=document.createElement("form");a.id="newform";var b=($("#advanced_searchform").serialize());if(b.length>2000){a.method="post"}document.body.appendChild(a);$("#advanced_searchform").find(":input").each(function(h,g){var k=$(g).val();var d=$(g).attr("name");var j=$(g).attr("type");if(j==="checkbox"){var l=$(g).attr("checked");if(l){addInput(d,k)}}else{var m=d.match(/(op|anyall|field|q)([1-4])/);if(m){if(d==="op3"){addInput(d,k)}var e=m[2];var f=0;for(f=0;f<=c.length;f++){if(e==c[f]){addInput(d,k)}}}else{if(d.match(/(facet_lang|facet_format)/)){processMultiSelectFacet(d,k)}else{if(d=="srch"){}else{addInput(d,k)}}}}});$("#newform").submit()}function processMultiSelectFacet(b,d){if((d[0]==="language:All"||d[0]==="format:All")&&typeof d!=="string"){var a=new Array();var c=1;for(c=0;c<d.length-1;c++){a[c]=d[c+1]}addInput(b,a)}else{if(d[0]==="language:All"||d[0]==="format:All"){}else{addInput(b,d)}}}function addInput(a,d){if(d===null||d===""){return}var e=d;var c=typeof d;if(c==="string"){$("<input>").attr({type:"hidden",name:a,value:d}).appendTo("#newform")}else{var b=0;for(b=0;b<=d.length;b++){$("<input>").attr({type:"hidden",name:a,value:d[b]}).appendTo("#newform")}}}function changeRange(a){sel=$("#"+a);name=sel.attr("name");val=sel.val();$(".yop").val("").hide();if(val=="before"){$("#"+name+"-end").val("").show().val("")}if(val=="after"){$("#"+name+"-start").show().val("")}if(val=="between"){$("#"+name+"-start").show().val("");$("#"+name+"-between").show();$("#"+name+"-end").show().val("")}if(val=="in"){$("#"+name+"-in").show().val("")}}function hideGroup2(){$("#op3").hide();$("#fieldsetGroup2").hide()}function showGroup2(){$("#op3").show();$("#fieldsetGroup2").show()}function showHidePdates(){if($("#yop").val()=="between"){$("#yop-between").show()}else{$("#yop-between").val("").hide()}var a=true;var b=$(":input.yop");$(b).each(function(c,d){var e=$(d).val();if(e.match(/^\s*\d+\s*$/)){a=false}else{$(d).hide()}});if(a){$("#yop-start").show().val("")}};
/* /htapps/tburtonw.babel/ls/web/js/ls_advanced-min.js */
