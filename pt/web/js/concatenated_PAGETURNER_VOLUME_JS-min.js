/*! nanoScrollerJS - v0.7.2
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2013 James Florentino; Licensed MIT */
(function(g,k,t){var c,l,h,v,d,e,a,n,s,j,w,x,b,m,r,u,i,f,p,o,q;o={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:false,preventPageScrolling:false,disableResize:false,alwaysVisible:false,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null};u="scrollbar";r="scroll";n="mousedown";s="mousemove";w="mousewheel";j="mouseup";m="resize";d="drag";f="up";b="panedown";h="DOMMouseScroll";v="down";p="wheel";e="keydown";a="keyup";i="touchmove";c=k.navigator.appName==="Microsoft Internet Explorer"&&/msie 7./i.test(k.navigator.appVersion)&&k.ActiveXObject;l=null;q=function(){var y,A,z;y=t.createElement("div");A=y.style;A.position="absolute";A.width="100px";A.height="100px";A.overflow=r;A.top="-9999px";t.body.appendChild(y);z=y.offsetWidth-y.clientWidth;t.body.removeChild(y);return z};x=(function(){function y(A,z){this.el=A;this.options=z;l||(l=q());this.$el=g(this.el);this.doc=g(t);this.win=g(k);this.$content=this.$el.children("."+z.contentClass);this.$content.attr("tabindex",0);this.content=this.$content[0];if(this.options.iOSNativeScrolling&&(this.el.style.WebkitOverflowScrolling!=null)){this.nativeScrolling()}else{this.generate()}this.createEvents();this.addEvents();this.reset()}y.prototype.preventScrolling=function(A,z){if(!this.isActive){return}if(A.type===h){if(z===v&&A.originalEvent.detail>0||z===f&&A.originalEvent.detail<0){A.preventDefault()}}else{if(A.type===w){if(!A.originalEvent||!A.originalEvent.wheelDelta){return}if(z===v&&A.originalEvent.wheelDelta<0||z===f&&A.originalEvent.wheelDelta>0){A.preventDefault()}}}};y.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"});this.iOSNativeScrolling=true;this.isActive=true};y.prototype.updateScrollValues=function(){var z;z=this.content;this.maxScrollTop=z.scrollHeight-z.clientHeight;this.contentScrollTop=z.scrollTop;if(!this.iOSNativeScrolling){this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop}};y.prototype.createEvents=function(){var z=this;this.events={down:function(A){z.isBeingDragged=true;z.offsetY=A.pageY-z.slider.offset().top;z.pane.addClass("active");z.doc.bind(s,z.events[d]).bind(j,z.events[f]);return false},drag:function(A){z.sliderY=A.pageY-z.$el.offset().top-z.offsetY;z.scroll();z.updateScrollValues();if(z.contentScrollTop>=z.maxScrollTop){z.$el.trigger("scrollend")}else{if(z.contentScrollTop===0){z.$el.trigger("scrolltop")}}return false},up:function(A){z.isBeingDragged=false;z.pane.removeClass("active");z.doc.unbind(s,z.events[d]).unbind(j,z.events[f]);return false},resize:function(A){z.reset()},panedown:function(A){z.sliderY=(A.offsetY||A.originalEvent.layerY)-(z.sliderHeight*0.5);z.scroll();z.events.down(A);return false},scroll:function(A){if(z.isBeingDragged){return}z.updateScrollValues();if(!z.iOSNativeScrolling){z.sliderY=z.sliderTop;z.slider.css({top:z.sliderTop})}if(A==null){return}if(z.contentScrollTop>=z.maxScrollTop){if(z.options.preventPageScrolling){z.preventScrolling(A,v)}z.$el.trigger("scrollend")}else{if(z.contentScrollTop===0){if(z.options.preventPageScrolling){z.preventScrolling(A,f)}z.$el.trigger("scrolltop")}}},wheel:function(A){if(A==null){return}z.sliderY+=-A.wheelDeltaY||-A.delta;z.scroll();return false}}};y.prototype.addEvents=function(){var z;this.removeEvents();z=this.events;if(!this.options.disableResize){this.win.bind(m,z[m])}if(!this.iOSNativeScrolling){this.slider.bind(n,z[v]);this.pane.bind(n,z[b]).bind(""+w+" "+h,z[p])}this.$content.bind(""+r+" "+w+" "+h+" "+i,z[r])};y.prototype.removeEvents=function(){var z;z=this.events;this.win.unbind(m,z[m]);if(!this.iOSNativeScrolling){this.slider.unbind();this.pane.unbind()}this.$content.unbind(""+r+" "+w+" "+h+" "+i,z[r])};y.prototype.generate=function(){var B,C,A,z,D;A=this.options;z=A.paneClass,D=A.sliderClass,B=A.contentClass;if(!this.$el.find(""+z).length&&!this.$el.find(""+D).length){this.$el.append('<div class="'+z+'"><div class="'+D+'" /></div>')}this.pane=this.$el.children("."+z);this.slider=this.pane.find("."+D);if(l){C=this.$el.css("direction")==="rtl"?{left:-l}:{right:-l};this.$el.addClass("has-scrollbar")}if(C!=null){this.$content.css(C)}return this};y.prototype.restore=function(){this.stopped=false;this.pane.show();this.addEvents()};y.prototype.reset=function(){var F,G,H,A,B,z,D,C,E;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight;return}if(!this.$el.find("."+this.options.paneClass).length){this.generate().stop()}if(this.stopped){this.restore()}F=this.content;H=F.style;A=H.overflowY;if(c){this.$content.css({height:this.$content.height()})}G=F.scrollHeight+l;z=this.pane.outerHeight();C=parseInt(this.pane.css("top"),10);B=parseInt(this.pane.css("bottom"),10);D=z+C+B;E=Math.round(D/G*D);if(E<this.options.sliderMinHeight){E=this.options.sliderMinHeight}else{if((this.options.sliderMaxHeight!=null)&&E>this.options.sliderMaxHeight){E=this.options.sliderMaxHeight}}if(A===r&&H.overflowX!==r){E+=l}this.maxSliderTop=D-E;this.contentHeight=G;this.paneHeight=z;this.paneOuterHeight=D;this.sliderHeight=E;this.slider.height(E);this.events.scroll();this.pane.show();this.isActive=true;if((F.scrollHeight===F.clientHeight)||(this.pane.outerHeight(true)>=F.scrollHeight&&A!==r)){this.pane.hide();this.isActive=false}else{if(this.el.clientHeight===F.scrollHeight&&A===r){this.slider.hide()}else{this.slider.show()}}this.pane.css({visibility:(this.options.alwaysVisible?"visible":"")});return this};y.prototype.scroll=function(){if(!this.isActive){return}this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.$content.scrollTop((this.paneHeight-this.contentHeight+l)*this.sliderY/this.maxSliderTop*-1);if(!this.iOSNativeScrolling){this.slider.css({top:this.sliderY})}return this};y.prototype.scrollBottom=function(z){if(!this.isActive){return}this.reset();this.$content.scrollTop(this.contentHeight-this.$content.height()-z).trigger(w);return this};y.prototype.scrollTop=function(z){if(!this.isActive){return}this.reset();this.$content.scrollTop(+z).trigger(w);return this};y.prototype.scrollTo=function(z){if(!this.isActive){return}this.reset();this.scrollTop(g(z).get(0).offsetTop);return this};y.prototype.stop=function(){this.stopped=true;this.removeEvents();this.pane.hide();return this};y.prototype.flash=function(){var z=this;if(!this.isActive){return}this.reset();this.pane.addClass("flashed");setTimeout(function(){z.pane.removeClass("flashed")},this.options.flashDelay);return this};return y})();g.fn.nanoScroller=function(y){return this.each(function(){var z,A;if(!(A=this.nanoscroller)){z=g.extend({},o,y);this.nanoscroller=A=new x(this,z)}if(y&&typeof y==="object"){g.extend(A.options,y);if(y.scrollBottom){return A.scrollBottom(y.scrollBottom)}if(y.scrollTop){return A.scrollTop(y.scrollTop)}if(y.scrollTo){return A.scrollTo(y.scrollTo)}if(y.scroll==="bottom"){return A.scrollBottom(0)}if(y.scroll==="top"){return A.scrollTop(0)}if(y.scroll&&y.scroll instanceof g){return A.scrollTo(y.scroll)}if(y.stop){return A.stop()}if(y.flash){return A.flash()}}return A.reset()})}})(jQuery,window,document);
/* /htapps/roger.babel/pt/web/js/jquery.nanoscroller-min.js */
/*! jQuery.fracs %BUILD_VERSION% - //larsjung.de/fracs - MIT License */
(function(m,w,h){var s=h(m),H=h(w),E=h.extend,B=h.isFunction,z=[].slice,n=Math.max,l=Math.min,C=Math.round,x=function(J,I){return typeof J===I},k=function(J,I){return J instanceof I},c=function(I){return I&&I.nodeType},g=function(I){return c(I)?I:(k(I,h)?I[0]:undefined)},o=function(J,I,K){h.each(J,function(L,M){K=I.call(M,K,L,M)});return K},p=(function(){var J={},I=1;return function(K){if(!K){return 0}if(!J[K]){J[K]=I;I+=1}return J[K]}}()),u=function(M,L,K){var J,I,N;if(M===L){return true}if(!M||!L||M.constructor!==L.constructor){return false}for(J=0,I=K.length;J<I;J+=1){N=K[J];if(M[N]&&B(M[N].equals)&&!M[N].equals(L[N])){return false}if(M[N]!==L[N]){return false}}return true};var j=function(L,K,J,I){this.left=C(L);this.top=C(K);this.width=C(J);this.height=C(I);this.right=this.left+this.width;this.bottom=this.top+this.height};E(j.prototype,{equals:function(I){return u(this,I,["left","top","width","height"])},area:function(){return this.width*this.height},relativeTo:function(I){return new j(this.left-I.left,this.top-I.top,this.width,this.height)},intersection:function(M){if(!k(M,j)){return null}var O=n(this.left,M.left),K=l(this.right,M.right),N=n(this.top,M.top),J=l(this.bottom,M.bottom),L=K-O,I=J-N;return(L>=0&&I>=0)?new j(O,N,L,I):null},envelope:function(M){if(!k(M,j)){return this}var O=l(this.left,M.left),K=n(this.right,M.right),N=l(this.top,M.top),J=n(this.bottom,M.bottom),L=K-O,I=J-N;return new j(O,N,L,I)}});E(j,{ofContent:function(J,I){if(!J||J===w||J===m){return new j(0,0,H.width(),H.height())}if(I){return new j(0,0,J.scrollWidth,J.scrollHeight)}else{return new j(J.offsetLeft-J.scrollLeft,J.offsetTop-J.scrollTop,J.scrollWidth,J.scrollHeight)}},ofViewport:function(J,I){if(!J||J===w||J===m){return new j(s.scrollLeft(),s.scrollTop(),s.width(),s.height())}if(I){return new j(J.scrollLeft,J.scrollTop,J.clientWidth,J.clientHeight)}else{return new j(J.offsetLeft,J.offsetTop,J.clientWidth,J.clientHeight)}},ofElement:function(J){var I=h(J);if(!I.is(":visible")){return null}var K=I.offset();return new j(K.left,K.top,I.outerWidth(),I.outerHeight())}});var b=function(L,I,K,J){this.visible=L||0;this.viewport=I||0;this.possible=K||0;this.rects=(J&&E({},J))||null};E(b.prototype,{equals:function(I){return this.fracsEqual(I)&&this.rectsEqual(I)},fracsEqual:function(I){return u(this,I,["visible","viewport","possible"])},rectsEqual:function(I){return u(this.rects,I.rects,["document","element","viewport"])}});E(b,{of:function(L,J){var M,I,K;L=(c(L)&&j.ofElement(L))||L;J=(c(J)&&j.ofViewport(J))||J||j.ofViewport();M=L.intersection(J);if(!M){return new b()}I=M.area();K=l(L.width,J.width)*l(L.height,J.height);return new b(I/L.area(),I/J.area(),I/K,{document:M,element:M.relativeTo(L),viewport:M.relativeTo(J)})}});var v=function(J,I){this.els=J;this.viewport=I};var r=["width","height","left","right","top","bottom"],y=["possible","visible","viewport"],e=function(J,I,K){var L;if(h.inArray(K,r)>=0){L=j.ofElement(J)}else{if(h.inArray(K,y)>=0){L=b.of(J,I)}}return L?L[K]:0},a=function(J,I){return J.val-I.val},t=function(J,I){return I.val-J.val};E(v.prototype,{sorted:function(J,K){var I=this.viewport;return h.map(this.els,function(L){return{el:L,val:e(L,I,J)}}).sort(K?t:a)},best:function(I,J){return this.els.length?this.sorted(I,J)[0]:null}});var A=function(K){var M=j.ofContent(K,true),I=j.ofViewport(K,true),J=M.width-I.width,L=M.height-I.height;this.content=M;this.viewport=I;this.width=J<=0?null:I.left/J;this.height=L<=0?null:I.top/L;this.left=I.left;this.top=I.top;this.right=M.right-I.right;this.bottom=M.bottom-I.bottom};E(A.prototype,{equals:function(I){return u(this,I,["width","height","left","top","right","bottom","content","viewport"])}});var F=function(I){this.el=I||m};E(F.prototype,{equals:function(I){return u(this,I,["el"])},scrollState:function(){return new A(this.el)},scrollTo:function(L,K,J){var I=this.el===m?h("html,body"):h(this.el);L=L||0;K=K||0;J=isNaN(J)?1000:J;I.stop(true).animate({scrollLeft:L,scrollTop:K},J)},scroll:function(L,K,J){var I=this.el===m?s:h(this.el);L=L||0;K=K||0;this.scrollTo(I.scrollLeft()+L,I.scrollTop()+K,J)},scrollToRect:function(K,I,J,L){I=I||0;J=J||0;this.scrollTo(K.left-I,K.top-J,L)},scrollToElement:function(J,I,L,M){var K=j.ofElement(J).relativeTo(j.ofContent(this.el));this.scrollToRect(K,I,L,M)}});var d={init:function(){this.callbacks=h.Callbacks("memory unique");this.currVal=null;this.prevVal=null;this.checkProxy=h.proxy(this.check,this);this.autoCheck()},bind:function(I){this.callbacks.add(I)},unbind:function(I){if(I){this.callbacks.remove(I)}else{this.callbacks.empty()}},trigger:function(){this.callbacks.fireWith(this.context,[this.currVal,this.prevVal])},check:function(I){var J=this.updatedValue(I);if(J===undefined){return false}this.prevVal=this.currVal;this.currVal=J;this.trigger();return true},$autoTarget:s,autoEvents:"load resize scroll",autoCheck:function(I){this.$autoTarget[I===false?"off":"on"](this.autoEvents,this.checkProxy)}};var i=function(J,I){this.context=J;this.viewport=I;this.init()};E(i.prototype,d,{updatedValue:function(){var I=b.of(this.context,this.viewport);if(!this.currVal||!this.currVal.equals(I)){return I}}});var f=function(K,I,J,L){this.context=new v(K,I);this.property=J;this.descending=L;this.init()};E(f.prototype,d,{updatedValue:function(){var I=this.context.best(this.property,this.descending);if(I){I=I.val>0?I.el:null;if(this.currVal!==I){return I}}}});var G=function(I){if(!I||I===m||I===w){this.context=m}else{this.context=I;this.$autoTarget=h(I)}this.init()};E(G.prototype,d,{updatedValue:function(){var I=new A(this.context);if(!this.currVal||!this.currVal.equals(I)){return I}}});var D=function(M,K){var L=E({},K),O=function(S,R,Q,P){Q=B(Q)?Q.apply(S,R):Q;if(B(P[Q])){return P[Q].apply(S,R)}h.error('Method "'+Q+'" does not exist on jQuery.'+M)},N=function(){return O(this,z.call(arguments),L.defaultStatic,N)},J=function(P){if(B(J[P])){return J[P].apply(this,z.call(arguments,1))}return O(this,z.call(arguments),L.defaultMethod,J)},I=function(P){if(P){E(N,P.statics);E(J,P.methods)}N.modplug=I};I.prev={statics:h[M],methods:h.fn[M]};I(K);h[M]=N;h.fn[M]=J};var q="fracs";D(q,{statics:{version:"%BUILD_VERSION%",Rect:j,Fractions:b,Group:v,ScrollState:A,Viewport:F,FracsCallbacks:i,GroupCallbacks:f,ScrollStateCallbacks:G,fracs:function(J,I){return b.of(J,I)}},methods:{content:function(I){return this.length?j.ofContent(this[0],I):null},envelope:function(){return o(this,function(J){var I=j.ofElement(this);return J?J.envelope(I):I})},fracs:function(K,L,I){if(!x(K,"string")){I=L;L=K;K=null}if(!B(L)){I=L;L=null}I=g(I);var J=q+".fracs."+p(I);if(K==="unbind"){return this.each(function(){var M=h(this).data(J);if(M){M.unbind(L)}})}else{if(K==="check"){return this.each(function(){var M=h(this).data(J);if(M){M.check()}})}else{if(B(L)){return this.each(function(){var N=h(this),M=N.data(J);if(!M){M=new i(this,I);N.data(J,M)}M.bind(L)})}}}return this.length?b.of(this[0],I):null},intersection:function(){return o(this,function(J){var I=j.ofElement(this);return J?J.intersection(I):I})},max:function(J,K,I){if(!B(K)){I=K;K=null}I=g(I);if(K){new f(this,I,J,true).bind(K);return this}return this.pushStack(new v(this,I).best(J,true).el)},min:function(J,K,I){if(!B(K)){I=K;K=null}I=g(I);if(K){new f(this,I,J).bind(K);return this}return this.pushStack(new v(this,I).best(J).el)},rect:function(){return this.length?j.ofElement(this[0]):null},scrollState:function(J,K){var I=q+".scrollState";if(!x(J,"string")){K=J;J=null}if(J==="unbind"){return this.each(function(){var L=h(this).data(I);if(L){L.unbind(K)}})}else{if(J==="check"){return this.each(function(){var L=h(this).data(I);if(L){L.check()}})}else{if(B(K)){return this.each(function(){var M=h(this),L=M.data(I);if(!L){L=new G(this);M.data(I,L)}L.bind(K)})}}}return this.length?new A(this[0]):null},scroll:function(K,J,I){return this.each(function(){new F(this).scroll(K,J,I)})},scrollTo:function(J,I,K,L){if(h.isNumeric(J)){L=K;K=I;I=J;J=null}J=g(J);return this.each(function(){if(J){new F(this).scrollToElement(J,I,K,L)}else{new F(this).scrollTo(I,K,L)}})},scrollToThis:function(J,K,L,I){I=new F(g(I));I.scrollToElement(this[0],J,K,L);return this},softLink:function(J,K,L,I){I=new F(g(I));return this.filter("a[href^=#]").each(function(){var M=h(this);M.on("click",function(){I.scrollToElement(h(M.attr("href"))[0],J,K,L)})})},sort:function(K,J,I){if(!x(J,"boolean")){I=J;J=null}I=g(I);return this.pushStack(h.map(new v(this,I).sorted(K,!J),function(L){return L.el}))},viewport:function(I){return this.length?j.ofViewport(this[0],I):null}},defaultStatic:"fracs",defaultMethod:"fracs"})}(window,document,jQuery));
/* /htapps/roger.babel/pt/web/js/jquery.fracs-min.js */
(function(a){a.belowthefold=function(c,d){var b=a(window).height()+a(window).scrollTop();return b<=a(c).offset().top-d.threshold};a.abovethetop=function(b,c){var d=a(window).scrollTop();return d>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(c,d){var b=a(window).width()+a(window).scrollLeft();return b<=a(c).offset().left-d.threshold};a.leftofscreen=function(b,c){var d=a(window).scrollLeft();return d>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return !a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(c,d,b){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c,d,b){return a.abovethetop(c,{threshold:0})},"left-of-screen":function(c,d,b){return a.leftofscreen(c,{threshold:0})},"right-of-screen":function(c,d,b){return a.rightofscreen(c,{threshold:0})},"in-viewport":function(c,d,b){return a.inviewport(c,{threshold:0})}})})(jQuery);
/* /htapps/roger.babel/pt/web/js/jquery.viewport-min.js */
(function(){var b=jQuery.event,a=function(o,j,n,e){var p,l,k,m,g,i,c,d,f;for(p=0;p<j.length;p++){l=j[p];m=l.indexOf(".")<0;if(!m){c=l.split(".");l=c.shift();d=new RegExp("(^|\\.)"+c.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")}k=(o[l]||[]).slice(0);for(g=0;g<k.length;g++){i=k[g];f=(m||d.test(i.namespace));if(f){if(e){if(i.selector===e){n(l,i.origHandler||i.handler)}}else{if(e===null){n(l,i.origHandler||i.handler,i.selector)}else{if(!i.selector){n(l,i.origHandler||i.handler)}}}}}}};b.find=function(i,h,c){var g=($._data(i)||{}).events,d=[],f,e,j;if(!g){return d}a(g,h,function(l,k){d.push(k)},c);return d};b.findBySelector=function(f,e){var d=$._data(f).events,c={},g=function(i,l,k){var h=c[i]||(c[i]={}),j=h[l]||(h[l]=[]);j.push(k)};if(!d){return c}a(d,e,function(j,i,h){g(h||"",j,i)},null);return c};b.supportTouch="ontouchend" in document;$.fn.respondsTo=function(c){if(!this.length){return false}else{return b.find(this[0],$.isArray(c)?c:[c]).length>0}};$.fn.triggerHandled=function(c,d){c=(typeof c=="string"?$.Event(c):c);this.trigger(c,d);return c.handled};b.setupHelper=function(f,d,e){if(!e){e=d;d=null}var g=function(i){var j,h=i.selector||"";if(h){j=b.find(this,f,h);if(!j.length){$(this).delegate(h,d,e)}}else{if(!b.find(this,f,h).length){b.add(this,d,e,{selector:h,delegate:this})}}},c=function(i){var j,h=i.selector||"";if(h){j=b.find(this,f,h);if(!j.length){$(this).undelegate(h,d,e)}}else{if(!b.find(this,f,h).length){b.remove(this,d,e,{selector:h,delegate:this})}}};$.each(f,function(){b.special[this]={add:g,remove:c,setup:function(){},teardown:function(){}}})}})(jQuery);(function(c){var h=/Phantom/.test(navigator.userAgent),e=!h&&"ontouchend" in document,f="touchmove scroll",i=e?"touchstart":"mousedown",g=e?"touchend":"mouseup",a=e?"touchmove":"mousemove",d=function(j){var k=j.originalEvent.touches?j.originalEvent.touches[0]:j;return{time:(new Date).getTime(),coords:[k.pageX,k.pageY],origin:c(j.target)}};var b=c.event.swipe={delay:500,max:75,min:30};c.event.setupHelper(["swipe","swipeleft","swiperight","swipeup","swipedown"],i,function(m){var p=d(m),k,l=m.delegateTarget||m.currentTarget,j=m.handleObj.selector,o=this;function n(q){if(!p){return}k=d(q);if(Math.abs(p.coords[0]-k.coords[0])>10){q.preventDefault()}}c(document.documentElement).bind(a,n).one(g,function(t){c(this).unbind(a,n);if(p&&k){var r=Math.abs(p.coords[0]-k.coords[0]),q=Math.abs(p.coords[1]-k.coords[1]),u=Math.sqrt(r*r+q*q);if(k.time-p.time<b.delay&&u>=b.min){var s=["swipe"];if(r>=b.min&&q<b.min){s.push(p.coords[0]>k.coords[0]?"swipeleft":"swiperight")}else{if(q>=b.min&&r<b.min){s.push(p.coords[1]<k.coords[1]?"swipedown":"swipeup")}}c.each(c.event.find(l,s,j),function(){this.call(o,m,{start:p,end:k})})}}p=k=undefined})})})(jQuery);
/* /htapps/roger.babel/pt/web/js/jquerypp.custom-min.js */
(function(c,b,e){var d=b.Modernizr;c.BookBlock=function(f,g){this.$el=c(g);this._init(f)};c.BookBlock.defaults={speed:1000,easing:"ease-in-out",shadows:true,shadowSides:0.2,shadowFlip:0.1,perspective:1300,circular:false,nextEl:"",prevEl:"",autoplay:false,interval:3000,keyboard:true,onEndFlip:function(g,f){return false},onBeforeFlip:function(f){return false}};c.BookBlock.prototype={_init:function(f){this.options=c.extend(true,{},c.BookBlock.defaults,f);this.$el.css("perspective",this.options.perspective);this.$items=this.$el.children(".bb-item");this.itemsCount=this.$items.length;this.current=0;this.$current=this.$items.eq(this.current).show();this.elWidth=this.$el.width();var g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.transEndEventName=g[d.prefixed("transition")];this.support=d.csstransitions&&d.csstransforms3d;if(c.browser.webkit){this.support=true}this._initEvents();if(this.options.autoplay){this.options.circular=true;this._startSlideshow()}},_initEvents:function(){var f=this;if(this.options.nextEl!==""){c(this.options.nextEl).on("click.bookblock",function(){f._stopSlideshow();f._navigate("next");return false})}if(this.options.prevEl!==""){c(this.options.prevEl).on("click.bookblock",function(){f._stopSlideshow();f._navigate("prev");return false})}if(this.options.keyboard==true){c(document).keydown(function(i){var h=i.keyCode||i.which;var g={left:37,up:38,right:39,down:40};switch(h){case g.left:f._stopSlideshow();f._navigate("prev");break;case g.right:f._stopSlideshow();f._navigate("next");break}})}},next:function(){this._stopSlideshow();this._navigate("next")},prev:function(){this._stopSlideshow();this._navigate("prev")},jump:function(f){f-=1;if(f===this.current||f>=this.itemsCount||f<0){return false}this._stopSlideshow();this._navigate(f>this.current?"next":"prev",f)},isActive:function(){return this.isAnimating},_navigate:function(f,g){if(this.isAnimating){return false}this.options.onBeforeFlip(this.current);this.isAnimating=true;this.$current=this.$items.eq(this.current);if(g!==e){this.current=g}else{if(f==="next"){if(!this.options.circular&&this.current===this.itemsCount-1){this.end=true}else{this.current=this.current<this.itemsCount-1?this.current+1:0}}else{if(f==="prev"){if(!this.options.circular&&this.current===0){this.end=true}else{this.current=this.current>0?this.current-1:this.itemsCount-1}}}}if(!this.options.circular&&this.end){this.$nextItem=this.$current}else{this.$nextItem=this.$items.eq(this.current)}if(!this.support){this._layoutNoSupport(f)}else{this._layout(f)}},toggleLayoutSupport:function(){if(!this._master_support){this._master_support=this.support}if(this._master_support){this.support=!this.support}},_layoutNoSupport:function(g){this.$items.fadeOut("fast");this.$nextItem.fadeIn("fast");this.end=false;this.isAnimating=false;var f=g==="next"&&this.current===this.itemsCount-1||g==="prev"&&this.current===0;this.options.onEndFlip(this.current,f)},_layout:function(h){var r=this,q=this._addSide("left",h),k=this._addSide("middle",h),f=this._addSide("right",h),n=q.find("div.bb-overlay"),p=k.find("div.bb-flipoverlay:first"),s=k.find("div.bb-flipoverlay:last"),o=f.find("div.bb-overlay"),g=this.options.speed;this.$items.hide();this.$el.prepend(q,k,f);if(this.end){g=400}k.css({transition:"all "+g+"ms "+this.options.easing}).on(this.transEndEventName,function(u){if(u.target.className==="bb-page"){r.$el.children("div.bb-page").remove();r.$nextItem.show();r.end=false;r.isAnimating=false;var t=h==="next"&&r.current===r.itemsCount-1||h==="prev"&&r.current===0;r.options.onEndFlip(r.current,t)}});if(h==="prev"){k.css({transform:"rotateY(-180deg)"})}if(this.options.shadows&&!this.end){var j=(h==="next")?{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms"}:{transition:"opacity "+this.options.speed/2+"ms linear",opacity:this.options.shadowSides},m=(h==="next")?{transition:"opacity "+this.options.speed/2+"ms linear"}:{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms",opacity:this.options.shadowFlip},i=(h==="next")?{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms",opacity:this.options.shadowFlip}:{transition:"opacity "+this.options.speed/2+"ms linear"},l=(h==="next")?{transition:"opacity "+this.options.speed/2+"ms linear",opacity:this.options.shadowSides}:{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms"};p.css(m);s.css(i);n.css(j);o.css(l)}setTimeout(function(){var t=(h==="next")?"rotateY(-180deg)":"rotateY(0deg)";if(r.end){t=(h==="next")?"rotateY(-15deg)":"rotateY(-165deg)"}k.css({transform:t});if(r.options.shadows&&!r.end){p.css({opacity:(h==="next")?r.options.shadowFlip:0});s.css({opacity:(h==="next")?0:r.options.shadowFlip});n.css({opacity:(h==="next")?r.options.shadowSides:0});o.css({opacity:(h==="next")?0:r.options.shadowSides})}},30)},_addSide:function(h,g){var f;switch(h){case"left":f=c('<div class="bb-page"><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+(g==="next"?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",102);break;case"middle":f=c('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content" style="left:'+(-this.elWidth/2)+"px;width:"+this.elWidth+'px"><div class="bb-inner">'+(g==="next"?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-flipoverlay"></div></div></div><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+(g==="next"?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-flipoverlay"></div></div></div></div>').css("z-index",103);break;case"right":f=c('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content" style="left:'+(-this.elWidth/2)+"px;width:"+this.elWidth+'px"><div class="bb-inner">'+(g==="next"?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",101);break}return f},_startSlideshow:function(){var f=this;this.slideshow=setTimeout(function(){f._navigate("next");if(f.options.autoplay){f._startSlideshow()}},this.options.interval)},_stopSlideshow:function(){if(this.options.autoplay){clearTimeout(this.slideshow);this.options.autoplay=false}}};var a=function(f){if(b.console){b.console.error(f)}};c.fn.bookblock=function(h){var f=c.data(this,"bookblock");if(typeof h==="string"){var g=Array.prototype.slice.call(arguments,1);this.each(function(){if(!f){a("cannot call methods on bookblock prior to initialization; attempted to call method '"+h+"'");return}if(!c.isFunction(f[h])||h.charAt(0)==="_"){a("no such method '"+h+"' for bookblock instance");return}f[h].apply(f,g)})}else{this.each(function(){if(f){f._init()}else{f=c.data(this,"bookblock",new c.BookBlock(h,this))}})}return f}})(jQuery,window);
/* /htapps/roger.babel/pt/web/js/jquery.bookblock-min.js */
!function(b){var a=function(d,c){this.element=b(d);var e=this.element.outerWidth();this.picker=b('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element);this.id=this.element.data("slider-id")||c.id;if(this.id){this.picker[0].id=this.id}var g=this.element.data("slider-tooltip")||c.tooltip;this.label=c.label;this.tooltip=this.picker.find(".tooltip");this.tooltipInner=this.tooltip.find("div.tooltip-inner");this.orientation=this.element.data("slider-orientation")||c.orientation;switch(this.orientation){case"vertical":this.picker.addClass("slider-vertical");this.stylePos="top";this.mousePos="pageY";this.sizePos="offsetHeight";this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",e);this.orientation="horizontal";this.stylePos="left";this.mousePos="pageX";this.sizePos="offsetWidth";this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px";break}this.min=this.element.data("slider-min")||c.min;this.max=this.element.data("slider-max")||c.max;this.step=this.element.data("slider-step")||c.step;this.value=this.element.data("slider-value")||c.value;if(this.value[1]){this.range=true}this.selection=this.element.data("slider-selection")||c.selection;this.selectionEl=this.picker.find(".slider-selection");if(this.selection==="none"){this.selectionEl.addClass("hide")}this.selectionElStyle=this.selectionEl[0].style;this.handle1=this.picker.find(".slider-handle:first");this.handle1Stype=this.handle1[0].style;this.handle2=this.picker.find(".slider-handle:last");this.handle2Stype=this.handle2[0].style;var f=this.element.data("slider-handle")||c.handle;switch(f){case"round":this.handle1.addClass("round");this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle");this.handle2.addClass("triangle");break}if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection=="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];this.layout();this.picker.on({mousedown:b.proxy(this.mousedown,this)});if(g==="show"){this.picker.on({mouseenter:b.proxy(this.showTooltip,this),mouseleave:b.proxy(this.hideTooltip,this)})}else{this.tooltip.addClass("hide")}};a.prototype={constructor:a,over:false,inDrag:false,showTooltip:function(){this.tooltip.addClass("in");this.over=true},hideTooltip:function(){if(this.inDrag===false){this.tooltip.removeClass("in")}this.over=false},layout:function(){this.handle1Stype[this.stylePos]=this.percentage[0]+"%";this.handle2Stype[this.stylePos]=this.percentage[1]+"%";if(this.orientation=="vertical"){this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%";this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"}else{this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%";this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%"}if(this.range){this.tooltipInner.text((this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step)+" : "+(this.min+Math.round((this.diff*this.percentage[1]/100)/this.step)*this.step));this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}else{var c=(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step);if(this.label){c=this.label(c,this.max)}this.tooltipInner.text(c);this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}},mousedown:function(d){this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];var c=this.getPercentage(d);if(this.range){var g=Math.abs(this.percentage[0]-c);var e=Math.abs(this.percentage[1]-c);this.dragged=(g<e)?0:1}else{this.dragged=0}this.percentage[this.dragged]=c;this.layout();b(document).on({mousemove:b.proxy(this.mousemove,this),mouseup:b.proxy(this.mouseup,this)});this.inDrag=true;var f=this.calculateValue();this.element.trigger({type:"slideStart",value:f}).trigger({type:"slide",value:f});return false},mousemove:function(d){var c=this.getPercentage(d);if(this.range){if(this.dragged===0&&this.percentage[1]<c){this.percentage[0]=this.percentage[1];this.dragged=1}else{if(this.dragged===1&&this.percentage[0]>c){this.percentage[1]=this.percentage[0];this.dragged=0}}}this.percentage[this.dragged]=c;this.layout();var e=this.calculateValue();this.element.trigger({type:"slide",value:e}).data("value",e).prop("value",e);return false},mouseup:function(c){b(document).off({mousemove:this.mousemove,mouseup:this.mouseup});this.inDrag=false;if(this.over==false){this.hideTooltip()}this.element;var d=this.calculateValue();console.log("MOUSEUP",d);this.element.trigger({type:"slideStop",value:d}).data("value",d).prop("value",d);return false},calculateValue:function(){var c;if(this.range){c=[(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step),(this.min+Math.round((this.diff*this.percentage[1]/100)/this.step)*this.step)];this.value=c}else{c=(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step);this.value=[c,this.value[1]]}return c},getPercentage:function(d){var c=(d[this.mousePos]-this.offset[this.stylePos])*100/this.size;c=Math.round(c/this.percentage[2])*this.percentage[2];return Math.max(0,Math.min(100,c))},getValue:function(){if(this.range){return this.value}return this.value[0]},setValue:function(c){this.value=c;if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection=="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.layout()}};b.fn.slider=function(c,d){return this.each(function(){var g=b(this),f=g.data("slider"),e=typeof c==="object"&&c;if(!f){g.data("slider",(f=new a(this,b.extend({},b.fn.slider.defaults,e))))}if(typeof c=="string"){f[c](d)}})};b.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round"};b.fn.slider.Constructor=a}(window.jQuery);
/* /htapps/roger.babel/pt/web/js/bootstrap-slider-min.js */
var HT=HT||{};HT.scrolling={};var $window;head.ready(function(){i=$(window);var b=i.scrollTop();var a=i.scrollLeft();HT.x=10;var k=function(){var t=i.height()-$(".header.fixed").height()-$(".navbar-static-top").height();var s=t-$(".bibLinks").height()-HT.x;$("#sidebar").height(t).find(".scrollable").height(s).addClass("nano");$(".sidebar.dummy").height($("#sidebar").height());$(".scrollable.nano").nanoScroller({alwaysVisible:true})};HT.scrolling.rebuild_sidebar=k;var h=false;var c=function(){var s=0;l.each(function(){var v=$(this);var A=v.offset();var u=v.outerWidth();var z=v.outerHeight();if(v.is("#toolbar-vertical")){u=40}else{if(v.is("#toolbar-horizontal")){z=40}}if(!v.attr("id")){s+=1;v.attr("id","id"+s)}v.css({position:"fixed",top:A.top,left:A.left,width:u}).addClass("stuck");if(!v.is(".no-dummy")){var B=0;var y=$("<div><div></div></div>").attr("id",v.attr("id")+"-dummy").attr("class",v.attr("class")).addClass("dummy").removeClass("stuck").css({height:z+B,width:u});v.before(y).addClass("fixed-placed");y=$("#"+v.attr("id")+"-dummy");if(v.is("#header")){console.log("ORIGINAL:",v.css("height"),v.height(),v.outerHeight(false),v.outerHeight(true),v.innerHeight(),y.height(),y.outerHeight());var t=2*3}v.css("top",y.offset().top).width(y.outerWidth()).addClass("static");if(v.is(".fixed-x")){v.css("left",y.offset().left)}q[v.attr("id")]=y}});h=true;n(true);k()};$(".header").addClass("fixed").addClass("fixed-x").data("extra-height",40).data("shadow","#navbar-inner");var l=$(".fixed");var r=$(".fixed.fixed-x");var o=$(".fixed.fixed-y");var q={};var g=$(".main");setTimeout(c,10);var e=function(){if(!h){return}var s=$(window).scrollLeft();l.filter(".fixed-y").each(function(){var t=$(this);var u=q[t.attr("id")];t.css({left:u.offset().left-s})})};var p=function(){if(!h){return}var s=$(window).scrollTop();if(s==b){return}o.each(function(){var C=$(this);var y=C.data("margin-top")||0;var u=q[C.attr("id")];var A=parseInt(C.css("top"));if(!C.is(":visible")){return}var v=A+C.height();if(b<s){var t,z;z=t=A+(b-s);if(!C.is(".unlocked")&&z<=y){z=y}if((z>=0||C.is(".unlocked"))&&z<A){C.css({top:z})}var x=C.fracs();var w=g.fracs();if(x.rects.viewport.bottom-w.rects.viewport.bottom>0){var B=x.rects.viewport.bottom-w.rects.viewport.bottom;C.css({top:t});C.addClass("unlocked")}}else{var z=u.offset().top-s;if(z>=y){C.css({top:z});C.removeClass("unlocked")}else{if(C.is(".unlocked")){z=A-(s-b);if(z>=y){z=y;C.removeClass("unlocked")}C.css({top:z})}}}if(A<=y){C.addClass("locked")}else{C.removeClass("locked")}});r.each(function(){var t=$(this);var v=q[t.attr("id")];t.css({top:v.offset().top-s});if(t.attr("id")=="header"){var u=$("#menu-toggle");if(t.fracs().visible<0.5){if(!u.length){u=$('<div id="menu-toggle"><a href="#"><span class="offscreen">Toggle Header</span><i class="icomoon-reorder"></i></a></div>').appendTo("#navbar-inner");u.find("a").click(function(w){w.preventDefault();f($(this))})}u.show()}else{u.hide()}}});b=s};var d=function(){if(!h){return}var t=$(window).scrollLeft();o.each(function(){var v=$(this);var w=q[v.attr("id")];var u=w.offset().left+t;v.css({left:u})});r.each(function(){var w=$(this);var x=q[w.attr("id")];var u=x.offset().left+parseInt(x.css("margin-left"));var v=$(w.data("shadow"));var u=($(window).width()-v.width())/2;w.css({width:v.width(),left:u});x.width(w.outerWidth())});var s=$(".container.page.centered");s.removeClass("page");setTimeout(function(){s.addClass("page");k()},100)};var m=_.debounce(d,250);var f=function(t){var s=$("#header");if(s.is(".dropped")){var u=s.data("pos");s.animate({top:u.top},function(){s.removeClass("dropped");t.removeClass("active")})}else{var u={top:s.css("top")};s.data("pos",u);s.addClass("dropped").animate({top:40},function(){t.addClass("active")})}};var j=-1;var n=function(w){if(!h){return}var v=i.width();var s=function(y){var z=y.width();return(v/2)-(z/2)};var u=$(".container.page");var t=$(".header.dummy");if(!t.length){return}var x=s(t);if(s(u)<x){if(j!=x){u.css("margin-left",x);j=x}}else{if(j>0){u.css("margin-left","");j=-1}}e()};$(window).on("scroll",n);$(window).on("scroll",p);$(window).on("scroll",e);if(!$("html").is(".mobile")){var i=get_resize_root();i.on("resize",m)}$(window).on("reset",function(){setTimeout(function(){l.removeClass("locked");$(window).scroll()},100)})});
/* /htapps/roger.babel/pt/web/js/scrolling-min.js */
var HT=HT||{};var $body=$("body");HT.Reader={init:function(a){this.options=$.extend({},this.options,a);this.id=this.options.params.id;this.imgsrv=Object.create(HT.ImgSrv).init({base:window.location.pathname.replace("/pt","/imgsrv")});this._tracking=false;return this},options:{},start:function(){var a=this;this._handleView(this.getView(),"start");this.bindEvents();this.manager=Object.create(HT.Manager).init({reader:a,id:a.id,seq:a.options.params.seq});this.manager.start();if(this.options.params.ui=="fullscreen"){var b=$("#action-toggle-fullscreen");if(!b.is(":disabled")){setTimeout(function(){a._toggleFullScreen(b)},250)}}},updateView:function(a){if(a==this.getView()){return}HT.prefs.set({pt:{view:a}});if(a=="image"||a=="plaintext"){window.location.href=this.$views.find("a[data-target="+a+"]").attr("href");return}this.$views.find("a.active").removeClass("active");this.$views.find("a[data-target="+a+"]").addClass("active");this._tracking=false;this._handleView(this.getView(),"exit");this._handleView(a,"start");this.setView(a);this.manager.restart()},bindEvents:function(){var a=this;$("body").on("click","a",function(b){if($(this).attr("disabled")){b.preventDefault();return false}});this._bindAction("toggle.fullscreen",this._toggleFullScreen);if(this.getView()=="image"||this.getView()=="plaintext"){$(".toolbar").find("a[href='']").attr("disabled","disabled").attr("tabindex","-1");$(".action-views").on("click","a",function(){var b=$(this).data("target");console.log("SETTING PREFERENCE",b);HT.prefs.set({pt:{view:b}})});return}a.$views=$(".action-views");a.$views.on("click","a",function(d){d.preventDefault();var c=$(this);var b=c.data("target");a.updateView(b)});a.$views.find("a.active").removeClass("active").end().find("a[data-target='"+a.getView()+"']").addClass("active");$(".toolbar .btn[data-toggle*=tracking]").each(function(){if($(this).data("target")=="image"||$(this).data("target")=="plaintext"){return}var b=$(this).data("toggle");if(b.indexOf("tracking-action")<0){$(this).data("toggle",b.replace("tracking","tracking-action"))}});this._bindAction("go.first");this._bindAction("go.prev");this._bindAction("go.next");this._bindAction("go.last");this._bindAction("zoom.in");this._bindAction("zoom.out");this._bindAction("rotate.clockwise");this._bindAction("rotate.counterclockwise");$(".table-of-contents").on("click","a",function(c){c.preventDefault();var b=$(this).data("seq");$.publish("action.go.page",(b));$(".bb-bookblock").removeClass("lowered")});$("#action-go-page").click(function(d){d.preventDefault();var c=$.trim($("#input-go-page").val());var b;if(!c){return}if(c.match(/^\d+/)){b=a.manager.getSeqForPageNum(c);if(!b){b=c}}else{if(c.substr(0,1)=="n"){b=c.substr(1)}}if(b){$.publish("action.go.page",(b))}});$.subscribe("update.go.page",function(d,b){var f=b;if($.isArray(b)){b=b[0]!=null?b[0]:b[1]}var c=a.manager.getPageNumForSeq(b);if(!c){c=""}$("#input-go-page").val(c);a.setCurrentSeq(b,f)});$.subscribe("update.focus.page",function(c,b){a.setCurrentSeq(b);a.updateView("1up")});$.subscribe("view.ready.reader",function(){a._tracking=true;$(window).trigger("reset")});$.subscribe("disable.download.page.pdf",function(){$(".page-pdf-link").attr("disabled","disabled").addClass("disabled").attr("tabindex",-1)});$.subscribe("enable.download.page.pdf",function(){$(".page-pdf-link").attr("disabled",null).removeClass("disabled").attr("tabindex",null)});$.subscribe("enable.download.page.pdf",function(){$(".page-pdf-link").attr("disabled",null).removeClass("disabled")});$.subscribe("view.end.reader",function(){$.publish("enable.zoom");$.publish("enable.rotate");$.publish("enable.download.page");$.publish("enable.toggle.fullscreen")});$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){console.log("FULLSCREEN?",$(document).fullScreen());$.publish("action.toggle.fullscreen");$(window).resize()})},getCurrentSeq:function(){return this._current_seq||this.options.params.seq||1},setCurrentSeq:function(b){var a=this;this._current_seq=b;HT.params.seq=b;this._updateState();this._updateLinks.apply(this,arguments);$(".action-views").find("a").each(function(){a._updateLinkSeq($(this),b)})},_toggleFullScreen:function(a){var c=$(a);var b=$(".sidebar");if(c.hasClass("active")){$(".sidebar.dummy").show("fast",function(){$("#sidebar").css("visibility","hidden");$(window).scroll();$("#sidebar").css("visibility","visible").show("fast");c.removeClass("active");c.find(".icomoon-fullscreen-exit").removeClass("icomoon-fullscreen-exit").addClass("icomoon-fullscreen");$.publish("action.toggle.fullscreen")})}else{$(".sidebar").hide("fast",function(){$(window).scroll();c.addClass("active");c.find(".icomoon-fullscreen").removeClass("icomoon-fullscreen").addClass("icomoon-fullscreen-exit");$.publish("action.toggle.fullscreen")})}},_bindAction:function(d,b){var a=this;var e="#action-"+d.replace(".","-");var c=$(e);c.click(function(f){f.preventDefault();if(b==null){$.publish("action."+d,(this))}else{b.apply(a,c)}}).subscribe("disable."+d,function(){$(this).attr("disabled","disabled").attr("tabindex",-1)}).subscribe("enable."+d,function(){$(this).attr("disabled",null).attr("tabindex",null)})},getView:function(){return this._current_view||this.options.params.view},setView:function(b){var a={Scroll:"1up",Flip:"2up",Thumbnail:"thumb",Image:"image",PlainText:"plaintext"};this._current_view=b;this.options.params.view=b;this._updateState({view:b})},getViewModule:function(){var a={"1up":"Scroll","2up":"Flip",thumb:"Thumbnail",image:"Image",plaintext:"PlainText"};return HT.Viewer[a[this.getView()]]},_updateState:function(c){var b=window.location.pathname;b+="?id="+HT.params.id;b+=";view="+this.getView();b+=";seq="+this.getCurrentSeq();if(HT.params.debug){b+=";debug="+HT.params.debug}if(HT.params.skin){b+=";skin="+HT.params.skin}if(window.history&&window.history.replaceState!=null){window.history.replaceState(null,document.title,b)}else{var a="#view="+this.getView();a+=";seq="+this.getCurrentSeq();window.location.replace(a)}this._trackPageview(b);$.publish("update.reader.state")},_trackPageview:function(a){if(this._tracking&&HT.analytics&&HT.analytics.enabled){HT.analytics.trackPageview(a)}},_updateLinks:function(c,d){var b=this;if(!c){c=this.getCurrentSeq()}if(this.getView()=="2up"){_.each(d,function(f,g){var e=$("#pagePdfLink"+(g+1));b._updateLinkSeq(e,f)})}else{var a=$("#pagePdfLink");b._updateLinkSeq(a,c)}b._updateLinkSeq($("#pageURL"),c)},_updateLinkSeq:function(c,b){if(b==null){c.attr("disabled","disabled").attr("tabindex",-1)}else{if(!c.hasClass("disabled")){c.attr("disabled",null).attr("tabindex",null)}if(c.is("input")){var a=c.val();c.val(a.replace(/seq=\d+/,"seq="+b))}else{var a=c.attr("href");c.attr("href",a.replace(/seq=\d+/,"seq="+b))}}},_handleView:function(a,b){if(a=="2up"){this._handleFlip(b)}},_handleFlip:function(b){var a=$("#pagePdfLink").parent();if(b=="start"){var d=a.clone(true).find("a").attr("id","pagePdfLink1").text("Download left page (PDF)").end().insertAfter(a);var c=a.clone(true).find("a").attr("id","pagePdfLink2").text("Download right page (PDF)").end().insertAfter(d);a.hide()}else{$("#pagePdfLink1").parent().remove();$("#pagePdfLink2").parent().remove();a.show()}},_parseParams:function(){},EOT:true};head.ready(function(){if(window.location.hash){var c=window.location.hash.substr(1).split(";");for(var a=0;a<c.length;a++){var b=c[a].split("=");HT.params[b[0]]=b[1]}}HT.reader=Object.create(HT.Reader).init({params:HT.params});HT.reader.start();$(".toolbar-vertical .btn").each(function(){var d=$(this);var e=d.text();d.tooltip({title:e,placement:"left",container:"#main",delay:{show:250,hide:50},xtrigger:"hover focus",animation:false})});$(".toolbar-horizontal .btn").each(function(){var d=$(this);var e=d.find(".label").text();if(e){d.tooltip({title:e,placement:"top",container:".toolbar-horizontal",delay:{show:250,hide:50},xtrigger:"hover focus",animation:false})}});$("html").on("click.dropdown.reader",".table-of-contents .btn",function(d){$(".bb-bookblock").toggleClass("lowered")});HT.analytics.getTrackingLabel=function(d){var e=HT.params.id+" "+HT.params.seq+" "+HT.params.size+" "+HT.params.orient+" "+HT.params.view;return e}});
/* /htapps/roger.babel/pt/web/js/reader-min.js */
var HT=HT||{};HT.Manager={init:function(a,b){this.options=$.extend({},this.options,a);this.data={};self.page_num_map={};self.num_seq_map={};self.seq_num_map={};return this},options:{},start:function(){var b=this;this.view=Object.create(b.options.reader.getViewModule()).init({manager:b,reader:b.options.reader});if(!b.view.options.is_dynamic){b.view.start();return}var a=this.options.reader.imgsrv.get_action_url("meta",{});$.ajaxSetup({async:false});$.getJSON(a+"callback=?",{id:this.options.id,format:"items",limit:1000002,method:"fudged",start:0,debug:HT.params.debug||""},function(c){b.data=c;b.num_pages=c.items.length;b.reading_order=c.readingOrder;b.parse_page_numbers();$.ajaxSetup({async:true});b.view.start()},"json")},restart:function(){var a=this;a.view.end();delete a.view;a.view=Object.create(a.options.reader.getViewModule()).init({manager:a,reader:a.options.reader});a.view.start();$(window).trigger("reset")},parse_page_numbers:function(){var a=this;a.num_seq_map={};a.seq_num_map={};for(var b=0;b<a.data.items.length;b++){var c=a.data.items[b];if(c.page_num){if(a.num_seq_map[c.page_num]===undefined){a.num_seq_map[c.page_num]=c.seq}a.seq_num_map[c.seq]=c.page_num}}},getSeqForPageNum:function(a){return this.num_seq_map[a]},getPageNumForSeq:function(a){return this.seq_num_map[a]},getAltTextForSeq:function(a){var c="";var b=this.getPageNumForSeq(a);if(b){c+="page "+b}else{c+="sequence "+a}return c},rotate_image:function(b){var a=this.get_page_meta(b);if(!a.orient){a.orient=0}a.orient+=1;if(a.orient==4){a.orient=0}this.set_page_meta({seq:b.seq,meta:a})},set_page_meta:function(a){this.data.items[a.seq]=a.meta},get_page_meta:function(e){var d;if(this.data.items[e.seq-1]){d=this.data.items[e.seq-1]}else{var a=680;var b=a*1.3;d={width:a,height:b,orient:0}}if(e.width){var c=e.width/d.width;d.width=e.width;d.height=d.height*c}return d},has_feature:function(b,a){if(typeof(b)=="number"){b=this.get_page_meta({seq:b})}if(b.features&&_.indexOf(b.features,a)>-1){return true}return false},get_image:function(g){var a=this;var d=this.get_page_meta(g);args={seq:g.seq,id:this.options.id,width:g.width};if(g.height){args.height=g.height}if(g.orient){args.orient=g.orient}var f=this.options.reader.imgsrv.get_action_url(g.action||"image",args);var e=false;var c=$.Deferred();var b=$("<img/>");b.load(c.resolve);b.error(c.reject);b.get(0).src=f;$.when(c.promise()).done(function(){var h=new Image();$(h).load(function(){var k;var j;var i;if(g.orient==1||g.orient==3){j=h.width;i=h.height}else{i=h.width;j=h.height}k=680/i;j=j*k;a.data.items[g.seq]={width:680,height:j};b.data("seq",g.seq);b.data("natural-height",h.height);b.data("natural-width",h.width);b.trigger("image.fudge")}).attr("src",b.get(0).src)}).fail(function(h){b.get(0).src="/imgsrv/common-web/graphics/503_image_distorted.jpg";b.data("natural-width",320);b.data("natural-height",480);b.trigger("image.fudge")});return b},EOT:true};
/* /htapps/roger.babel/pt/web/js/manager-min.js */
var HT=HT||{};HT.ImgSrv={init:function(a){this.options=$.extend({},this.options,a);return this},options:{},get_action_url:function(c,d){var b=this.options.base+"/"+c+"?";var a=[];if(d.id){a.push("id="+d.id)}if(d.seq){a.push("seq="+d.seq)}if(d.width){a.push("width="+Math.ceil(d.width))}if(d.height){a.push("height="+Math.ceil(d.height))}if(d.orient!==undefined){a.push("orient="+d.orient)}if(d.format){a.push("format="+d.format)}if(d.limit){a.push("limit="+d.limit)}if(d.method){a.push("method="+d.method)}if(d.start){a.push("start="+d.start)}if(a.length&&HT.params.debug){a.push("debug="+HT.params.debug)}return b+a.join(";")},EOT:true};
/* /htapps/roger.babel/pt/web/js/imgsrv-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Image={init:function(b){var a=this;return this},options:{},start:function(){$body.addClass("view-image");this.bindEvents()},bindEvents:function(){var a=this;$.publish("disable.toggle.fullscreen");$body.find(".page-item img").load(function(){$(window).scroll()})},_gotoLink:function(a){window.location.href=$(a).attr("href")},EOT:true};
/* /htapps/roger.babel/pt/web/js/image-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Scroll={init:function(b){var a=this;this.options=$.extend({},this.options,b);this.w=this.options.default_w;this.zoom=this.options.zoom;this.zoom_levels=[0.25,0.5,0.75,1,1.25,1.5,1.75,2,3,4];this.orient_cache={};return this},options:{default_w:680,zoom:1,is_dynamic:true},start:function(){$("body").addClass("view-1up");$.publish("enable.download.page");this.options.seq=this.options.reader.getCurrentSeq();this.bindEvents();this.bindScroll();this.drawPages()},end:function(){$.unsubscribe(".scroll");$.publish("view.end");$("#content").empty();$(window).unbind(".scroll");$("body").unbind(".scroll");$(window).scrollTop(0);$("body").removeClass("view-1up")},bindEvents:function(){var a=this;$.subscribe("action.go.next.scroll",function(d){a.gotoPage(null,1)});$.subscribe("action.go.prev.scroll",function(d){a.gotoPage(null,-1)});$.subscribe("action.go.first.scroll",function(d){a.gotoPage(1)});$.subscribe("action.go.last.scroll",function(d){a.gotoPage(a.options.manager.num_pages)});$.subscribe("action.go.page.scroll",function(f,d){a.gotoPage(d)});$.subscribe("action.zoom.in.scroll",function(d){a.updateZoom(1)});$.subscribe("action.zoom.out.scroll",function(d){a.updateZoom(-1)});$.subscribe("action.rotate.clockwise.scroll",function(d){a.rotateCurrentPage(1)});$.subscribe("action.rotate.counterclockwise.scroll",function(d){a.rotateCurrentPage(-1)});$("body").on("image.fudge.scroll","img",function(){var f=$(this).data("natural-height");var d=$(this).parent().height();$(this).parent().addClass("loaded");var e=50;if(Math.abs(f-d)>e){$(this).parent().height(f);$(this).parent().addClass("imaged").addClass("expanded")}});var c=_.debounce(function(){if(a._resizing){return}a._resizing=true;var g=$("#content");var f=g.width();var e=-1;var d=0;for(var h=0;h<a.zoom_levels.length;h++){var j=a.zoom_levels[h];if(a.options.default_w*j*1.2>f){break}a.w=a.options.default_w*j;a.zoom=j}a.drawPages();a._resizing=false},250);var b=get_resize_root();b.on("resize.viewer.scroll",c)},updateZoom:function(d){var b=this;var c=b.zoom_levels.indexOf(b.zoom);var a=c+d;if(a+d<0){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}if(a+d>=b.zoom_levels.length){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}b.zoom=b.zoom_levels[a];b.w=b.options.default_w*b.zoom;b.drawPages()},rotateCurrentPage:function(e){var b=this;var d=$(".page-item.current");var a=d.data("seq");var c=this.getPageOrient(a);this.orient_cache[a]=c=(c+1)%4;this.drawPages()},getPageOrient:function(a){return this.orient_cache[a]||0},bindScroll:function(){var a=this;var c=$(window);var b=_.debounce(function(){var s=Date.now();var h=[];var k=c.scrollTop();var d=c.height();var g=$(".page-item.current");var t=0;if(g.length){t=g.fracs().visible}if(!$(".page-item").length){return}var v=$(".page-item.imaged");v.addClass("checking");var e=$(".page-item");var u=$();var p=0;var l;var m=false;for(var o=0;o<e.length;o++){var q=e.slice(o,o+1);var r=q.fracs();if(r.visible){a.loadPage(q);u.push(q);if(r.visible>p){p=r.visible;l=q}m=true}else{if(m){break}}}if(l.attr("id")!=g.attr("id")){g.removeClass("current").attr("aria-hidden","true");l.addClass("current").attr("aria-hidden","false");$.publish("update.go.page",(l.data("seq")))}var j=u.slice(0,1).prev();var n=u.slice(-1).next();a.loadPage(j);a.loadPage(n);$(".page-item.checking").removeClass("imaged").removeClass("loaded").removeClass("checking").find("img").remove();a.checkPageStatus()},250);$(window).on("scroll.viewer.scroll",b)},gotoPage:function(b,d){var a=this;if(b==null){var c=$(".page-item.current");var b=c.data("seq")}if(d!=null){b+=d}var c=$("#page"+b);if(!c.length){return}$("html,body").animate({scrollTop:c.offset().top-100},"fast",function(){$(window).trigger("scroll.viewer.scroll")})},loadPage:function(b){if(!b.length){return}if(!b.is(".imaged")){b.addClass("imaged");var a=b.data("seq");if(!a){console.log("NO SEQUENCE?",b);return}var c=this.options.manager.get_image({seq:a,width:this.w,orient:this.getPageOrient(a)});var d="image of "+this.options.manager.getAltTextForSeq(a);c.attr("alt",d);b.append(c)}else{b.removeClass("checking")}},getCurrentSeq:function(){var a=$(".page-item.current");if(a.length){return a.data("seq")}return null},drawPages:function(){var c=this;var i=c.getCurrentSeq();if(i==null&&c.options.seq){i=c.options.seq;delete c.options.seq}$("#content").empty();var e=document.createDocumentFragment();for(var b=1;b<=this.options.manager.num_pages;b++){var g=this.options.manager.get_page_meta({seq:b,width:c.w,orient:c.getPageOrient(b)});var d=$('<div class="page-item" aria-hidden="true"><div class="page-num">{SEQ}</div>'.replace("{SEQ}",b)).appendTo($(e));d.attr("id","page"+b);var a=g.width;var f=g.height;if(c.getPageOrient(b)==1||c.getPageOrient(b)==3){f=g.width;a=g.height}d.css({height:f+2,width:a+4});d.data("seq",b)}$("#content").append(e);$(window).scroll();if(i&&i>1){setTimeout(function(){c.gotoPage(i);$.publish("view.ready")},500)}},checkPageStatus:function(){var a=this;var c=$("#page1").fracs();var b=$("#page"+a.options.manager.num_pages).fracs();if(c.visible>=0.9){$.publish("disable.go.first")}else{$.publish("enable.go.first")}if(b.visible>=0.9){$.publish("disable.go.last")}else{$.publish("enable.go.last")}},EOT:true};
/* /htapps/roger.babel/pt/web/js/scroll-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Thumbnail={init:function(b){var a=this;this.options=$.extend({},this.options,b);this.w=-1;return this},options:{default_w:150,min_w:75,max_w:250,is_dynamic:true},start:function(){$body.addClass("view-thumb");this.bindEvents();this.bindScroll();this.calculate();this.drawPages();$.publish("disable.rotate");$.publish("disable.download.page")},end:function(){$.unsubscribe(".thumb");$.publish("view.end");$("#content").empty();$(window).unbind(".thumb");$("body").unbind(".thumb");$(window).scrollTop(0);$body.removeClass("view-thumb");console.log("UNBOUND THUMBNAIL")},bindEvents:function(){var a=this;$.subscribe("action.go.first.thumb",function(d){$("html,body").animate({scrollTop:0})});$.subscribe("action.go.last.thumb",function(d){$("html,body").animate({scrollTop:$("body").height()-$(window).height()})});$.subscribe("action.go.next.thumb",function(g){var f=$("body");var h=$(window);var d=h.height()/3;$("html,body").animate({scrollTop:f.scrollTop()+d})});$.subscribe("action.go.prev.thumb",function(g){var f=$("body");var h=$(window);var d=h.height()/3;$("html,body").animate({scrollTop:f.scrollTop()-d})});$.subscribe("action.go.page.thumb",function(f,d){a.gotoPage(d)});$.subscribe("action.zoom.in.thumb",function(d){a.updateZoom(1.25)});$.subscribe("action.zoom.out.thumb",function(d){a.updateZoom(0.8)});$body.on("click.thumb",".page-link",function(f){f.preventDefault();var d=$(this).attr("href").substr(1);$.publish("update.focus.page",(d))});$body.on("image.fudge.thumb","img",function(){var g=$(this).data("natural-height");var h=$(this).parents(".page-item");var e=h.height();var f=50;var j=(g>e)?e:g;var i=(g>e)?g:e;h.addClass("loaded").removeClass("loading")});var c=_.debounce(function(){if(a._resizing){return}a._resizing=true;a.w=-1;a.drawPages();a._resizing=false},250);var b=get_resize_root();b.on("resize.viewer.thumb",c)},updateZoom:function(b){var a=this;a.w=a.w*b;if(a.w*b>a.options.max_w){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}if(b*a.w<a.options.min_w){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}a.drawPages()},bindScroll:function(){var a=this;var b=_.debounce(function(){var k=Date.now();if(!$(".page-item").length){return}var n=$(".page-item.imaged");n.addClass("checking");var m=$();var c=$(".page-item");var e=false;for(var h=0;h<c.length;h++){var j=c.slice(h,h+1);var l=j.fracs();if(l.visible){m=m.add(j);e=true}else{if(e){break}}}a.loadPage(m);var d=m.slice(0,1).prevAll().slice(0,6);var g=m.slice(-1).nextAll().slice(0,6);a.loadPage(d);a.loadPage(g);$(".page-item.checking").removeClass("imaged checking loaded loading").find("img").remove();a.checkPageStatus()},250);$(window).on("scroll.viewer.thumb",b);console.log("DEFINED SCROLL EVENT")},gotoPage:function(a){var b=$("#page"+a);if(!b.length){return}$("html,body").animate({scrollTop:b.offset().top-100},"fast")},loadPage:function(b){var a=this;b.removeClass("checking");a._processLoadQueue(b.toArray())},_processLoadQueue:function(b){var c=this;var a=[];var e=0;while(e<b.length){var d=b.slice(e,e+4);if(d.length){a.push(d)}e+=4}if(!a.length){return}var g;var f=function(){var i=$(".loading");if(i.length>2){return}var h=a.shift();if(a.length==0){clearInterval(g)}_.each(h,function(o){var k=$(o);if(!k.is(".imaged")){k.addClass("imaged").addClass("loading");var j=k.data("seq");var n=k.find("a.page-link");var m=k.data("h");var l=c.options.manager.get_image({seq:j,width:c.w,height:m,action:"thumbnail"});l.attr("alt","image of "+c.options.manager.getAltTextForSeq(j));n.append(l)}else{k.removeClass("checking")}})};g=setInterval(f,500)},calculate:function(){var j=this;var b={};for(var k=1;k<=j.options.manager.num_pages;k++){var g=j.options.manager.get_page_meta({seq:k,width:680});b[g.height]=(b[g.height]||0)+1}var a=-1;var f;var e=_.keys(b);j.h=e[0];for(var c=0;c<e.length;c++){var d=e[c];if(b[d]>a){a=b[d];j.h=d}}},drawPages:function(){var l=this;$("#content").empty();l.$container=$('<div class="thumbnails"></div>');var j=$("#content").width();if(l.w<0){var i=l.options.min_w;var b=i;var g=1.25;while(i*4<j){b=i;i*=g}if(b>l.options.max_w){b=l.options.max_w}l.w=b}if(l.options.manager.reading_order=="right-to-left"){l.$container.addClass("rtl")}var f=document.createDocumentFragment();for(var m=1;m<=l.options.manager.num_pages;m++){var k=l.options.manager.get_page_meta({seq:m,width:680});var a=l.w/k.width;var c=l.h*a;var d=$('<div class="page-item"><div class="page-num">{SEQ}</div><a class="page-link" href="#{SEQ}"></a></div>'.replace(/\{SEQ\}/g,m)).appendTo($(f));d.attr("id","page"+m);d.css({height:c,width:l.w});d.data("seq",m);d.data("h",c)}l.$container.append(f);$("#content").append(l.$container);l.$container.show();$(window).scroll();var e=l.options.reader.getCurrentSeq();if(e&&e>1){l.gotoPage(e)}$.publish("view.ready")},checkPageStatus:function(){var a=this;var g=$("#page1").fracs();var e=$("#page"+a.options.manager.num_pages).fracs();if(g.visible>=0.9){$.publish("disable.go.first")}else{$.publish("enable.go.first")}if(e.visible>=0.9){$.publish("disable.go.last")}else{$.publish("enable.go.last")}var d=$(".page-item:in-viewport");for(var b=0;b<d.length;b++){var c=d.slice(b,b+1);var f=c.fracs();if(f&&f.visible>=0.75){$.publish("update.go.page",(c.data("seq")));break}}},EOT:true};
/* /htapps/roger.babel/pt/web/js/thumb-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Flip={init:function(b){var a=this;this.options=$.extend({},this.options,b);this.w=-1;this.zoom=-1;this.zoom_levels=[0.25,0.5,0.75,1,1.25,1.5,1.75,2,3,4];this.orient_cache={};this.rotate=0;return this},options:{default_w:680,zoom:1,is_dynamic:true},start:function(){$("body").addClass("view-2up");$.publish("enable.download.page");this.is_rtl=this.options.manager.reading_order=="right-to-left";this.options.seq=this.options.reader.getCurrentSeq();this.bindEvents();this.drawPages()},end:function(){$.unsubscribe(".flip");$.publish("view.end");$(window).unbind(".flip");$("body").unbind(".flip");$("#content").empty();$("body").removeClass("view-2up")},bindEvents:function(){var a=this;$.subscribe("action.go.next.flip",function(d){a.gotoPage(null,1)});$.subscribe("action.go.prev.flip",function(d){a.gotoPage(null,-1)});$.subscribe("action.go.first.flip",function(d){a.gotoPage(a.is_rtl?a.options.manager.num_pages:1)});$.subscribe("action.go.last.flip",function(d){a.gotoPage(a.is_rtl?1:a.options.manager.num_pages)});$.subscribe("action.go.page.flip",function(f,d){a.gotoPage(d)});$.subscribe("action.zoom.in.flip",function(d){a.updateZoom(1)});$.subscribe("action.zoom.out.flip",function(d){a.updateZoom(-1)});$.subscribe("action.rotate.clockwise.flip",function(d){a.rotateBook(1)});$.subscribe("action.rotate.counterclockwise.flip",function(d){a.rotateBook(-1)});$.subscribe("action.toggle.fullscreen.flip",function(d){a.w=-1;a.drawPages()});var c=_.debounce(function(){if(a._resizing){return}a._resizing=true;a.w=-1;a.drawPages();a._resizing=false},250);var b=get_resize_root();b.on("resize.viewer.flip",c);$("body").on("image.fudge.flip","img",function(){var j=$(this);var f=$(this).data("seq");var i=$(this).data("natural-height");var g=$(this).parent().height();var e=$(this).data("natural-width");var d=$(this).parent().parent().width()/2;var h=100;$(this).parent().addClass("loaded");if(e-a.w>h){var k=$(this).parent();$(this).parent().addClass("untypical-page");if(!k.find("button").length){$('<button href="{SRC}" class="btn btn-mini">View Larger</button>'.replace("{SRC}",j.attr("src"))).appendTo($(this).parent()).click(function(l){l.preventDefault();$.fancybox.open([{href:j.attr("src"),type:"image"}]);return false})}}})},updateZoom:function(d){var b=this;var c=b.zoom_levels.indexOf(b.zoom);var a=c+d;if(a+d<0){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}if(a+d>=b.zoom_levels.length){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}b.zoom=b.zoom_levels[a];b.w=b.options.default_w*b.zoom;b.drawPages()},rotateBook:function(b){var a=this;a.$wrapper.addClass("flip-rotating");if(a.rotate>0){a.$wrapper.removeClass("flip-rotated-"+a.rotate)}a.rotate+=(90*b);if(a.rotate<0){a.rotate+=360}if(a.rotate==360||a.rotate==0){a.rotate=0}else{a.$wrapper.addClass("flip-rotated-"+a.rotate)}},getPageOrient:function(a){return this.orient_cache[a]||0},gotoPage:function(b,d){var a=this;if(b!=null){var c=a._seq2page(b);a.loadPage(c);a.book.jump(c+1)}else{if(d>0){a.book.next()}else{a.book.prev()}}a.checkPageStatus()},loadPage:function(b){var a=this;_.each(a._page2seq(b),function(c){if(c!=null){var d=$("#page"+c);if(!d.size()){return}if(d.find("img").size()){return}var e=a.options.manager.get_image({seq:c,height:Math.ceil(a.h/2)});e.attr("alt","image of "+a.options.manager.getAltTextForSeq(c));e.appendTo(d)}})},unloadPage:function(b){var a=this;_.each(a._page2seq(b),function(c){if(c==null){return}var d=$("#page"+c);if(!d.size()){return}d.find("img").remove()})},removeImage:function(a){var b=$("#page"+a);if(!b.size()){return}b.find("img").remove();b=$("#page"+(a+1));b.find("img").remove()},getCurrentSeq:function(){var b=this.book.current;var a=this._page2seq(b);return a[0]||a[1]},drawPages:function(){var s=this;var j=s.is_rtl?-1:0;if(s.book){j=s.book.current;delete s.book}$("#content").empty();var m=$("#content").width();$("#content").append('<div class="bb-custom-wrapper"><div class="bb-bookblock"></div></div>');var q=$(".bb-bookblock");s.$container=q;s.$wrapper=$("#content").find(".bb-custom-wrapper");if(s.w<0){var d=-1;var n=0;for(var e=0;e<s.zoom_levels.length;e++){var r=s.zoom_levels[e];if((s.options.default_w*r)*2>(m*2)){break}s.w=(s.options.default_w*r)/2;s.zoom=r}}var p=s.options.manager.get_page_meta({seq:1,width:680});s.h=p.height*s.zoom;var f=s.h/2;console.log("META: ",p,s.zoom,s.w,s.h);s.$wrapper.css({"min-width":s.w+25});s.$wrapper.height(f);q.height(f);var c=[];var k=[];var l=1;var a=s.options.manager.num_pages;if(s.options.manager.has_feature(1,"FRONT_COVER")){if(s.options.manager.reading_order=="right-to-left"){c.push([1,null])}else{c.push([null,1])}l=2}var g;if(s.options.manager.has_feature(a,"BACK_COVER")){if(s.options.manager.reading_order=="right-to-left"){g=[null,a]}else{g=[a,null]}a-=1}for(var o=l;o<=a;o+=2){if(s.options.manager.reading_order=="right-to-left"){c.push([o+1,o])}else{c.push([o,o+1])}}if(g){c.push(g)}if(s.options.manager.reading_order=="right-to-left"){c.reverse()}s._seq2page_map={};s._page2seq_map={};_.each(c,function(w,u){if(!w){return}var v=w[0];var h=w[1];var t='<div class="bb-item" aria-hidden="true">';s._page2seq_map[u]=[null,null];if(v){t+='<div id="page{SEQ}" class="page-item page-left"><div class="page-num">{SEQ}</div></div>'.replace(/{SEQ}/g,v);s._seq2page_map[v]=u;s._page2seq_map[u][0]=v}else{t+='<div class="page-item page-left empty"></div>'}if(h){t+='<div id="page{SEQ}" class="page-item page-right"><div class="page-num">{SEQ}</div></div>'.replace(/{SEQ}/g,h);s._seq2page_map[h]=u;s._page2seq_map[u][1]=h}else{t+='<div class="page-item page-right empty"></div>'}t+="</div>";s._attachPageHTML(t);$.each([v,h],function(){if(this){var i=s.options.manager.get_page_meta({seq:this});if(s.options.manager.has_feature(i,"UNTYPICAL_PAGE")){$("#page"+this).addClass("untypical-page")}}})});this.$leafs=q.find(".bb-item");this.book=q.bookblock({speed:600,shadowSides:0.8,shadowFlip:0.7,perspective:1300,n:c.length,onBeforeFlip:function(i,h){q.addClass("flipping");console.log("PRE FLIP:",i,h);s.$leafs.slice(i,i+1).attr("aria-hidden","true")},onEndFlip:function(i,h){console.log("FLIPPED:",i,h);q.removeClass("flipping");s.$leafs.slice(i,i+1).attr("aria-hidden","false");s.loadPage(i-1);s.loadPage(i-2);s.loadPage(i+1);s.loadPage(i+2);s.unloadPage(i-8);s.unloadPage(i+8)}});this.book.n=c.length;s.pages=c;if(s.options.seq){j=s._seq2page(s.options.seq);delete s.options.seq}else{if(j<0){j=c.length}}var b=s.options.manager.getPageNumForSeq(a);if(!b){b="n"+a}s.options.last_num=b;s.loadPage(j);s.loadPage(j+1);s.loadPage(j-1);s.book.toggleLayoutSupport();s.book.jump(j+1);s.book.toggleLayoutSupport();$(window).scroll();setTimeout(function(){s.buildSlider(c,j);s.checkPageStatus()},100);q.on("click",".page-right img",function(){s.gotoPage(null,1)}).on("click",".page-left img",function(){s.gotoPage(null,-1)});$.publish("view.ready")},buildSlider:function(a,e){var b=this;var c=$('<input type="text" class="nob" value="1" />').appendTo($("#content"));var d=b.options.last_num;b.$slider=c.slider({min:0,max:a.length-1,value:e,selection:"none",tooltip:"show",label:function(i,h){var f=b._page2seq(i);if(f[0]==null){f=f[1]}else{f=f[0]}var g=b.options.manager.getPageNumForSeq(f);var j=" / "+d;if(g){j=g+j}else{j="n"+f+j}return j},handle:"square"}).on("slideStop",function(g){var h=g.value;var f=b._page2seq(h);console.log("JUMPING TO",h,f);b.gotoPage(f[0])})},checkPageStatus:function(){var b=this;var c=b.book.current;if(c==0){$.publish("disable.go.first")}else{$.publish("enable.go.first")}if(b.book.end){$.publish("disable.go.last")}else{$.publish("enable.go.last")}b.$slider.slider("setValue",c);var a=b._page2seq(c);$.publish("update.go.page",[a])},_page2seq:function(a){return this._page2seq_map[a]},_seq2page:function(a){return this._seq2page_map[a]},_attachPageHTML:function(a){if(false&&self.options.manager.do_ltr){$(a).prependTo(this.$container)}else{$(a).appendTo(this.$container)}},isRTL:function(){return self.options.manager.reading_order=="right-to-left"},EOT:true};
/* /htapps/roger.babel/pt/web/js/flip-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.PlainText={init:function(b){var a=this;return this},options:{},start:function(){$body.addClass("view-plaintext");this.bindEvents()},bindEvents:function(){var a=this;$.publish("disable.toggle.fullscreen");$.publish("disable.zoom.in");$.publish("disable.zoom.out");$.publish("disable.rotate.clockwise");$.publish("disable.rotate.counterclockwise")},_gotoLink:function(a){window.location.href=$(a).attr("href")},EOT:true};
/* /htapps/roger.babel/pt/web/js/plaintext-min.js */
