/* nanoScrollerJS - v0.7.2
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2013 James Florentino; Licensed MIT */
(function(g,k,t){var c,l,h,v,d,e,a,n,s,j,w,x,b,m,r,u,i,f,p,o,q;o={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:false,preventPageScrolling:false,disableResize:false,alwaysVisible:false,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null};u="scrollbar";r="scroll";n="mousedown";s="mousemove";w="mousewheel";j="mouseup";m="resize";d="drag";f="up";b="panedown";h="DOMMouseScroll";v="down";p="wheel";e="keydown";a="keyup";i="touchmove";c=k.navigator.appName==="Microsoft Internet Explorer"&&/msie 7./i.test(k.navigator.appVersion)&&k.ActiveXObject;l=null;q=function(){var y,A,z;y=t.createElement("div");A=y.style;A.position="absolute";A.width="100px";A.height="100px";A.overflow=r;A.top="-9999px";t.body.appendChild(y);z=y.offsetWidth-y.clientWidth;t.body.removeChild(y);return z};x=(function(){function y(A,z){this.el=A;this.options=z;l||(l=q());this.$el=g(this.el);this.doc=g(t);this.win=g(k);this.$content=this.$el.children("."+z.contentClass);this.$content.attr("tabindex",0);this.content=this.$content[0];if(this.options.iOSNativeScrolling&&(this.el.style.WebkitOverflowScrolling!=null)){this.nativeScrolling()}else{this.generate()}this.createEvents();this.addEvents();this.reset()}y.prototype.preventScrolling=function(A,z){if(!this.isActive){return}if(A.type===h){if(z===v&&A.originalEvent.detail>0||z===f&&A.originalEvent.detail<0){A.preventDefault()}}else{if(A.type===w){if(!A.originalEvent||!A.originalEvent.wheelDelta){return}if(z===v&&A.originalEvent.wheelDelta<0||z===f&&A.originalEvent.wheelDelta>0){A.preventDefault()}}}};y.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"});this.iOSNativeScrolling=true;this.isActive=true};y.prototype.updateScrollValues=function(){var z;z=this.content;this.maxScrollTop=z.scrollHeight-z.clientHeight;this.contentScrollTop=z.scrollTop;if(!this.iOSNativeScrolling){this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop}};y.prototype.createEvents=function(){var z=this;this.events={down:function(A){z.isBeingDragged=true;z.offsetY=A.pageY-z.slider.offset().top;z.pane.addClass("active");z.doc.bind(s,z.events[d]).bind(j,z.events[f]);return false},drag:function(A){z.sliderY=A.pageY-z.$el.offset().top-z.offsetY;z.scroll();z.updateScrollValues();if(z.contentScrollTop>=z.maxScrollTop){z.$el.trigger("scrollend")}else{if(z.contentScrollTop===0){z.$el.trigger("scrolltop")}}return false},up:function(A){z.isBeingDragged=false;z.pane.removeClass("active");z.doc.unbind(s,z.events[d]).unbind(j,z.events[f]);return false},resize:function(A){z.reset()},panedown:function(A){z.sliderY=(A.offsetY||A.originalEvent.layerY)-(z.sliderHeight*0.5);z.scroll();z.events.down(A);return false},scroll:function(A){if(z.isBeingDragged){return}z.updateScrollValues();if(!z.iOSNativeScrolling){z.sliderY=z.sliderTop;z.slider.css({top:z.sliderTop})}if(A==null){return}if(z.contentScrollTop>=z.maxScrollTop){if(z.options.preventPageScrolling){z.preventScrolling(A,v)}z.$el.trigger("scrollend")}else{if(z.contentScrollTop===0){if(z.options.preventPageScrolling){z.preventScrolling(A,f)}z.$el.trigger("scrolltop")}}},wheel:function(A){if(A==null){return}z.sliderY+=-A.wheelDeltaY||-A.delta;z.scroll();return false}}};y.prototype.addEvents=function(){var z;this.removeEvents();z=this.events;if(!this.options.disableResize){this.win.bind(m,z[m])}if(!this.iOSNativeScrolling){this.slider.bind(n,z[v]);this.pane.bind(n,z[b]).bind(""+w+" "+h,z[p])}this.$content.bind(""+r+" "+w+" "+h+" "+i,z[r])};y.prototype.removeEvents=function(){var z;z=this.events;this.win.unbind(m,z[m]);if(!this.iOSNativeScrolling){this.slider.unbind();this.pane.unbind()}this.$content.unbind(""+r+" "+w+" "+h+" "+i,z[r])};y.prototype.generate=function(){var B,C,A,z,D;A=this.options;z=A.paneClass,D=A.sliderClass,B=A.contentClass;if(!this.$el.find(""+z).length&&!this.$el.find(""+D).length){this.$el.append('<div class="'+z+'"><div class="'+D+'" /></div>')}this.pane=this.$el.children("."+z);this.slider=this.pane.find("."+D);if(l){C=this.$el.css("direction")==="rtl"?{left:-l}:{right:-l};this.$el.addClass("has-scrollbar")}if(C!=null){this.$content.css(C)}return this};y.prototype.restore=function(){this.stopped=false;this.pane.show();this.addEvents()};y.prototype.reset=function(){var F,G,H,A,B,z,D,C,E;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight;return}if(!this.$el.find("."+this.options.paneClass).length){this.generate().stop()}if(this.stopped){this.restore()}F=this.content;H=F.style;A=H.overflowY;if(c){this.$content.css({height:this.$content.height()})}G=F.scrollHeight+l;z=this.pane.outerHeight();C=parseInt(this.pane.css("top"),10);B=parseInt(this.pane.css("bottom"),10);D=z+C+B;E=Math.round(D/G*D);if(E<this.options.sliderMinHeight){E=this.options.sliderMinHeight}else{if((this.options.sliderMaxHeight!=null)&&E>this.options.sliderMaxHeight){E=this.options.sliderMaxHeight}}if(A===r&&H.overflowX!==r){E+=l}this.maxSliderTop=D-E;this.contentHeight=G;this.paneHeight=z;this.paneOuterHeight=D;this.sliderHeight=E;this.slider.height(E);this.events.scroll();this.pane.show();this.isActive=true;if((F.scrollHeight===F.clientHeight)||(this.pane.outerHeight(true)>=F.scrollHeight&&A!==r)){this.pane.hide();this.isActive=false}else{if(this.el.clientHeight===F.scrollHeight&&A===r){this.slider.hide()}else{this.slider.show()}}this.pane.css({visibility:(this.options.alwaysVisible?"visible":"")});return this};y.prototype.scroll=function(){if(!this.isActive){return}this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.$content.scrollTop((this.paneHeight-this.contentHeight+l)*this.sliderY/this.maxSliderTop*-1);if(!this.iOSNativeScrolling){this.slider.css({top:this.sliderY})}return this};y.prototype.scrollBottom=function(z){if(!this.isActive){return}this.reset();this.$content.scrollTop(this.contentHeight-this.$content.height()-z).trigger(w);return this};y.prototype.scrollTop=function(z){if(!this.isActive){return}this.reset();this.$content.scrollTop(+z).trigger(w);return this};y.prototype.scrollTo=function(z){if(!this.isActive){return}this.reset();this.scrollTop(g(z).get(0).offsetTop);return this};y.prototype.stop=function(){this.stopped=true;this.removeEvents();this.pane.hide();return this};y.prototype.flash=function(){var z=this;if(!this.isActive){return}this.reset();this.pane.addClass("flashed");setTimeout(function(){z.pane.removeClass("flashed")},this.options.flashDelay);return this};return y})();g.fn.nanoScroller=function(y){return this.each(function(){var z,A;if(!(A=this.nanoscroller)){z=g.extend({},o,y);this.nanoscroller=A=new x(this,z)}if(y&&typeof y==="object"){g.extend(A.options,y);if(y.scrollBottom){return A.scrollBottom(y.scrollBottom)}if(y.scrollTop){return A.scrollTop(y.scrollTop)}if(y.scrollTo){return A.scrollTo(y.scrollTo)}if(y.scroll==="bottom"){return A.scrollBottom(0)}if(y.scroll==="top"){return A.scrollTop(0)}if(y.scroll&&y.scroll instanceof g){return A.scrollTo(y.scroll)}if(y.stop){return A.stop()}if(y.flash){return A.flash()}}return A.reset()})}})(jQuery,window,document);
/* /htapps/roger.babel/pt/web/js/jquery.nanoscroller-min.js */
/* jQuery.fracs %BUILD_VERSION% - //larsjung.de/fracs - MIT License */
(function(m,w,h){var s=h(m),H=h(w),E=h.extend,B=h.isFunction,z=[].slice,n=Math.max,l=Math.min,C=Math.round,x=function(J,I){return typeof J===I},k=function(J,I){return J instanceof I},c=function(I){return I&&I.nodeType},g=function(I){return c(I)?I:(k(I,h)?I[0]:undefined)},o=function(J,I,K){h.each(J,function(L,M){K=I.call(M,K,L,M)});return K},p=(function(){var J={},I=1;return function(K){if(!K){return 0}if(!J[K]){J[K]=I;I+=1}return J[K]}}()),u=function(M,L,K){var J,I,N;if(M===L){return true}if(!M||!L||M.constructor!==L.constructor){return false}for(J=0,I=K.length;J<I;J+=1){N=K[J];if(M[N]&&B(M[N].equals)&&!M[N].equals(L[N])){return false}if(M[N]!==L[N]){return false}}return true};var j=function(L,K,J,I){this.left=C(L);this.top=C(K);this.width=C(J);this.height=C(I);this.right=this.left+this.width;this.bottom=this.top+this.height};E(j.prototype,{equals:function(I){return u(this,I,["left","top","width","height"])},area:function(){return this.width*this.height},relativeTo:function(I){return new j(this.left-I.left,this.top-I.top,this.width,this.height)},intersection:function(M){if(!k(M,j)){return null}var O=n(this.left,M.left),K=l(this.right,M.right),N=n(this.top,M.top),J=l(this.bottom,M.bottom),L=K-O,I=J-N;return(L>=0&&I>=0)?new j(O,N,L,I):null},envelope:function(M){if(!k(M,j)){return this}var O=l(this.left,M.left),K=n(this.right,M.right),N=l(this.top,M.top),J=n(this.bottom,M.bottom),L=K-O,I=J-N;return new j(O,N,L,I)}});E(j,{ofContent:function(J,I){if(!J||J===w||J===m){return new j(0,0,H.width(),H.height())}if(I){return new j(0,0,J.scrollWidth,J.scrollHeight)}else{return new j(J.offsetLeft-J.scrollLeft,J.offsetTop-J.scrollTop,J.scrollWidth,J.scrollHeight)}},ofViewport:function(J,I){if(!J||J===w||J===m){return new j(s.scrollLeft(),s.scrollTop(),s.width(),s.height())}if(I){return new j(J.scrollLeft,J.scrollTop,J.clientWidth,J.clientHeight)}else{return new j(J.offsetLeft,J.offsetTop,J.clientWidth,J.clientHeight)}},ofElement:function(J){var I=h(J);if(!I.is(":visible")){return null}var K=I.offset();return new j(K.left,K.top,I.outerWidth(),I.outerHeight())}});var b=function(L,I,K,J){this.visible=L||0;this.viewport=I||0;this.possible=K||0;this.rects=(J&&E({},J))||null};E(b.prototype,{equals:function(I){return this.fracsEqual(I)&&this.rectsEqual(I)},fracsEqual:function(I){return u(this,I,["visible","viewport","possible"])},rectsEqual:function(I){return u(this.rects,I.rects,["document","element","viewport"])}});E(b,{of:function(L,J){var M,I,K;L=(c(L)&&j.ofElement(L))||L;J=(c(J)&&j.ofViewport(J))||J||j.ofViewport();M=L.intersection(J);if(!M){return new b()}I=M.area();K=l(L.width,J.width)*l(L.height,J.height);return new b(I/L.area(),I/J.area(),I/K,{document:M,element:M.relativeTo(L),viewport:M.relativeTo(J)})}});var v=function(J,I){this.els=J;this.viewport=I};var r=["width","height","left","right","top","bottom"],y=["possible","visible","viewport"],e=function(J,I,K){var L;if(h.inArray(K,r)>=0){L=j.ofElement(J)}else{if(h.inArray(K,y)>=0){L=b.of(J,I)}}return L?L[K]:0},a=function(J,I){return J.val-I.val},t=function(J,I){return I.val-J.val};E(v.prototype,{sorted:function(J,K){var I=this.viewport;return h.map(this.els,function(L){return{el:L,val:e(L,I,J)}}).sort(K?t:a)},best:function(I,J){return this.els.length?this.sorted(I,J)[0]:null}});var A=function(K){var M=j.ofContent(K,true),I=j.ofViewport(K,true),J=M.width-I.width,L=M.height-I.height;this.content=M;this.viewport=I;this.width=J<=0?null:I.left/J;this.height=L<=0?null:I.top/L;this.left=I.left;this.top=I.top;this.right=M.right-I.right;this.bottom=M.bottom-I.bottom};E(A.prototype,{equals:function(I){return u(this,I,["width","height","left","top","right","bottom","content","viewport"])}});var F=function(I){this.el=I||m};E(F.prototype,{equals:function(I){return u(this,I,["el"])},scrollState:function(){return new A(this.el)},scrollTo:function(L,K,J){var I=this.el===m?h("html,body"):h(this.el);L=L||0;K=K||0;J=isNaN(J)?1000:J;I.stop(true).animate({scrollLeft:L,scrollTop:K},J)},scroll:function(L,K,J){var I=this.el===m?s:h(this.el);L=L||0;K=K||0;this.scrollTo(I.scrollLeft()+L,I.scrollTop()+K,J)},scrollToRect:function(K,I,J,L){I=I||0;J=J||0;this.scrollTo(K.left-I,K.top-J,L)},scrollToElement:function(J,I,L,M){var K=j.ofElement(J).relativeTo(j.ofContent(this.el));this.scrollToRect(K,I,L,M)}});var d={init:function(){this.callbacks=h.Callbacks("memory unique");this.currVal=null;this.prevVal=null;this.checkProxy=h.proxy(this.check,this);this.autoCheck()},bind:function(I){this.callbacks.add(I)},unbind:function(I){if(I){this.callbacks.remove(I)}else{this.callbacks.empty()}},trigger:function(){this.callbacks.fireWith(this.context,[this.currVal,this.prevVal])},check:function(I){var J=this.updatedValue(I);if(J===undefined){return false}this.prevVal=this.currVal;this.currVal=J;this.trigger();return true},$autoTarget:s,autoEvents:"load resize scroll",autoCheck:function(I){this.$autoTarget[I===false?"off":"on"](this.autoEvents,this.checkProxy)}};var i=function(J,I){this.context=J;this.viewport=I;this.init()};E(i.prototype,d,{updatedValue:function(){var I=b.of(this.context,this.viewport);if(!this.currVal||!this.currVal.equals(I)){return I}}});var f=function(K,I,J,L){this.context=new v(K,I);this.property=J;this.descending=L;this.init()};E(f.prototype,d,{updatedValue:function(){var I=this.context.best(this.property,this.descending);if(I){I=I.val>0?I.el:null;if(this.currVal!==I){return I}}}});var G=function(I){if(!I||I===m||I===w){this.context=m}else{this.context=I;this.$autoTarget=h(I)}this.init()};E(G.prototype,d,{updatedValue:function(){var I=new A(this.context);if(!this.currVal||!this.currVal.equals(I)){return I}}});var D=function(M,K){var L=E({},K),O=function(S,R,Q,P){Q=B(Q)?Q.apply(S,R):Q;if(B(P[Q])){return P[Q].apply(S,R)}h.error('Method "'+Q+'" does not exist on jQuery.'+M)},N=function(){return O(this,z.call(arguments),L.defaultStatic,N)},J=function(P){if(B(J[P])){return J[P].apply(this,z.call(arguments,1))}return O(this,z.call(arguments),L.defaultMethod,J)},I=function(P){if(P){E(N,P.statics);E(J,P.methods)}N.modplug=I};I.prev={statics:h[M],methods:h.fn[M]};I(K);h[M]=N;h.fn[M]=J};var q="fracs";D(q,{statics:{version:"%BUILD_VERSION%",Rect:j,Fractions:b,Group:v,ScrollState:A,Viewport:F,FracsCallbacks:i,GroupCallbacks:f,ScrollStateCallbacks:G,fracs:function(J,I){return b.of(J,I)}},methods:{content:function(I){return this.length?j.ofContent(this[0],I):null},envelope:function(){return o(this,function(J){var I=j.ofElement(this);return J?J.envelope(I):I})},fracs:function(K,L,I){if(!x(K,"string")){I=L;L=K;K=null}if(!B(L)){I=L;L=null}I=g(I);var J=q+".fracs."+p(I);if(K==="unbind"){return this.each(function(){var M=h(this).data(J);if(M){M.unbind(L)}})}else{if(K==="check"){return this.each(function(){var M=h(this).data(J);if(M){M.check()}})}else{if(B(L)){return this.each(function(){var N=h(this),M=N.data(J);if(!M){M=new i(this,I);N.data(J,M)}M.bind(L)})}}}return this.length?b.of(this[0],I):null},intersection:function(){return o(this,function(J){var I=j.ofElement(this);return J?J.intersection(I):I})},max:function(J,K,I){if(!B(K)){I=K;K=null}I=g(I);if(K){new f(this,I,J,true).bind(K);return this}return this.pushStack(new v(this,I).best(J,true).el)},min:function(J,K,I){if(!B(K)){I=K;K=null}I=g(I);if(K){new f(this,I,J).bind(K);return this}return this.pushStack(new v(this,I).best(J).el)},rect:function(){return this.length?j.ofElement(this[0]):null},scrollState:function(J,K){var I=q+".scrollState";if(!x(J,"string")){K=J;J=null}if(J==="unbind"){return this.each(function(){var L=h(this).data(I);if(L){L.unbind(K)}})}else{if(J==="check"){return this.each(function(){var L=h(this).data(I);if(L){L.check()}})}else{if(B(K)){return this.each(function(){var M=h(this),L=M.data(I);if(!L){L=new G(this);M.data(I,L)}L.bind(K)})}}}return this.length?new A(this[0]):null},scroll:function(K,J,I){return this.each(function(){new F(this).scroll(K,J,I)})},scrollTo:function(J,I,K,L){if(h.isNumeric(J)){L=K;K=I;I=J;J=null}J=g(J);return this.each(function(){if(J){new F(this).scrollToElement(J,I,K,L)}else{new F(this).scrollTo(I,K,L)}})},scrollToThis:function(J,K,L,I){I=new F(g(I));I.scrollToElement(this[0],J,K,L);return this},softLink:function(J,K,L,I){I=new F(g(I));return this.filter("a[href^=#]").each(function(){var M=h(this);M.on("click",function(){I.scrollToElement(h(M.attr("href"))[0],J,K,L)})})},sort:function(K,J,I){if(!x(J,"boolean")){I=J;J=null}I=g(I);return this.pushStack(h.map(new v(this,I).sorted(K,!J),function(L){return L.el}))},viewport:function(I){return this.length?j.ofViewport(this[0],I):null}},defaultStatic:"fracs",defaultMethod:"fracs"})}(window,document,jQuery));
/* /htapps/roger.babel/pt/web/js/jquery.fracs-min.js */
(function(a){a.belowthefold=function(c,d){var b=a(window).height()+a(window).scrollTop();return b<=a(c).offset().top-d.threshold};a.abovethetop=function(b,c){var d=a(window).scrollTop();return d>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(c,d){var b=a(window).width()+a(window).scrollLeft();return b<=a(c).offset().left-d.threshold};a.leftofscreen=function(b,c){var d=a(window).scrollLeft();return d>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return !a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(c,d,b){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c,d,b){return a.abovethetop(c,{threshold:0})},"left-of-screen":function(c,d,b){return a.leftofscreen(c,{threshold:0})},"right-of-screen":function(c,d,b){return a.rightofscreen(c,{threshold:0})},"in-viewport":function(c,d,b){return a.inviewport(c,{threshold:0})}})})(jQuery);
/* /htapps/roger.babel/pt/web/js/jquery.viewport-min.js */
(function(){var a,b;a=this.jQuery||window.jQuery;b=a(window);a.fn.stick_in_parent=function(d){var l,m,j,f,k,e,c,i,h,g,n;if(d==null){d={}}i=d.sticky_class,j=d.inner_scrolling,c=d.recalc_every,e=d.parent,k=d.offset_top,f=d.spacer,m=d.bottoming;if(k==null){k=0}if(e==null){e=void 0}if(j==null){j=true}if(i==null){i="is_stuck"}if(m==null){m=true}h=function(s,F,p,o,z,B,x,y){var C,G,q,E,r,v,t,w,A,u,D;if(s.data("sticky_kit")){return}s.data("sticky_kit",true);v=s.parent();if(e!=null){v=v.closest(e)}if(!v.length){throw"failed to find stick parent"}q=false;C=false;u=f!=null?f&&s.closest(f):a("<div />");if(u){u.css("position",s.css("position"))}t=function(){var H,J,I;if(y){return}H=parseInt(v.css("border-top-width"),10);J=parseInt(v.css("padding-top"),10);F=parseInt(v.css("padding-bottom"),10);p=v.offset().top+H+J;o=v.height();if(q){q=false;C=false;if(f==null){s.insertAfter(u);u.detach()}s.css({position:"",top:"",width:"",bottom:""}).removeClass(i);I=true}z=s.offset().top-parseInt(s.css("margin-top"),10)-k;B=s.outerHeight(true);x=s.css("float");if(u){u.css({width:s.outerWidth(true),height:B,display:s.css("display"),"vertical-align":s.css("vertical-align"),"float":x})}if(I){return D()}};t();if(B===o){return}E=void 0;r=k;A=c;D=function(){var J,L,I,H,K;if(y){return}if(A!=null){A-=1;if(A<=0){A=c;t()}}I=b.scrollTop();if(E!=null){L=I-E}E=I;if(q){if(m){H=I+B+r>o+p;if(C&&!H){C=false;s.css({position:"fixed",bottom:"",top:r}).trigger("sticky_kit:unbottom")}}if(I<z){q=false;r=k;if(f==null){if(x==="left"||x==="right"){s.insertAfter(u)}u.detach()}J={position:"",width:"",top:""};s.css(J).removeClass(i).trigger("sticky_kit:unstick")}if(j){K=b.height();if(B+k>K){if(!C){r-=L;r=Math.max(K-B,r);r=Math.min(k,r);if(q){s.css({top:r+"px"})}}}}}else{if(I>z){q=true;J={position:"fixed",top:r};J.width=s.css("box-sizing")==="border-box"?s.outerWidth()+"px":s.width()+"px";s.css(J).addClass(i);if(f==null){s.after(u);if(x==="left"||x==="right"){u.append(s)}}s.trigger("sticky_kit:stick")}}if(q&&m){if(H==null){H=I+B+r>o+p}if(!C&&H){C=true;if(v.css("position")==="static"){v.css({position:"relative"})}return s.css({position:"absolute",bottom:F,top:"auto"}).trigger("sticky_kit:bottom")}}};w=function(){t();return D()};G=function(){y=true;b.off("touchmove",D);b.off("scroll",D);b.off("resize",w);a(document.body).off("sticky_kit:recalc",w);s.off("sticky_kit:detach",G);s.removeData("sticky_kit");s.css({position:"",bottom:"",top:"",width:""});v.position("position","");if(q){if(f==null){if(x==="left"||x==="right"){s.insertAfter(u)}u.remove()}return s.removeClass(i)}};b.on("touchmove",D);b.on("scroll",D);b.on("resize",w);a(document.body).on("sticky_kit:recalc",w);s.on("sticky_kit:detach",G);return setTimeout(D,0)};for(g=0,n=this.length;g<n;g++){l=this[g];h(a(l))}return this}}).call(this);
/* /htapps/roger.babel/pt/web/js/jquery.sticky-kit-min.js */
(function(e,g,i,j,b){var h={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(o){for(var l=0;l<o.length;l++){var m=o[l].string;var n=o[l].prop;this.versionSearchString=o[l].versionSearch||o[l].identity;if(m){if(m.indexOf(o[l].subString)!=-1){return o[l].identity}}else{if(n){return o[l].identity}}}},searchVersion:function(m){var l=m.indexOf(this.versionSearchString);if(l==-1){return}return parseFloat(m.substring(l+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:g.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};h.init();var k={MSIE:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"}},Explorer:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"}},Firefox:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Chrome:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Safari:{Mac:{ctrlKey:true,altKey:false,metaKey:false,shiftKey:true,which:70,string:"^&#x2318;F",alt:"Control+Command+F"}},Opera:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},};var f=function(){return(i.clientHeight==j&&i.clientWidth==b)||g.fullScreen||(g.outerHeight==j&&g.outerWidth==b)||(h.browser=="Safari"&&g.outerHeight==(j-40)&&g.outerWidth==b)},c=e(g);if(k[h.browser]==null){return}var a=k[h.browser][h.OS];var d=a?{shortcut:a.string,longform:a.alt}:{};c.data("fullscreen-state",f()).data("fullscreen-key",d).resize(function(){var l=f();if(c.data("fullscreen-state")&&!l){c.data("fullscreen-state",l).trigger("fullscreen-toggle",[false]).trigger("fullscreen-off")}else{if(!c.data("fullscreen-state")&&l){c.data("fullscreen-state",l).trigger("fullscreen-toggle",[true]).trigger("fullscreen-on")}}}).keydown(function(l){if(a&&l.ctrlKey==a.ctrlKey&&l.altKey==a.altKey&&l.metaKey==a.metaKey&&l.shiftKey==a.shiftKey&&l.which==a.which){c.trigger("fullscreen-key",[a.string,a.alt])}})})(jQuery,this,document.documentElement,screen.height,screen.width);
/* /htapps/roger.babel/pt/web/js/jquery.fullscreen-min.js */
(function(b){function a(e,d){return(e.currentStyle&&e.currentStyle[d])||e.style[d]}function c(f){var d=$(f).css("clip")||"";if(!d){var e={top:a(f,"clipTop"),right:a(f,"clipRight"),bottom:a(f,"clipBottom"),left:a(f,"clipLeft")};if(e.top&&e.right&&e.bottom&&e.left){d="rect("+e.top+" "+e.right+" "+e.bottom+" "+e.left+")"}}return d.replace(/,/g," ")}b.fx.step.clip=function(e){if(e.pos===0){var k=/rect\(([0-9\.]{1,})(px|em)[,]?\s+([0-9\.]{1,})(px|em)[,]?\s+([0-9\.]{1,})(px|em)[,]?\s+([0-9\.]{1,})(px|em)\)/;e.start=k.exec(c(e.elem));if(typeof e.end==="string"){e.end=k.exec(e.end.replace(/,/g," "))}}if(e.start&&e.end){var g=new Array(),d=new Array(),i=e.start.length,f=e.end.length,h=e.start[l+1]=="em"?(parseInt($(e.elem).css("fontSize"))*1.333*parseInt(e.start[l])):1;for(var l=1;l<i;l+=2){g.push(parseInt(h*e.start[l]))}for(var j=1;j<f;j+=2){d.push(parseInt(h*e.end[j]))}e.elem.style.clip="rect("+parseInt((e.pos*(d[0]-g[0]))+g[0])+"px "+parseInt((e.pos*(d[1]-g[1]))+g[1])+"px "+parseInt((e.pos*(d[2]-g[2]))+g[2])+"px "+parseInt((e.pos*(d[3]-g[3]))+g[3])+"px)"}}})(jQuery);
/* /htapps/roger.babel/pt/web/js/jquery.animate.clip-min.js */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}})(function(s,j){var c=6,e=s.event.add,v=s.event.remove,y=function(R,Q,S){s.event.trigger(Q,S,R)},C=(function(){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(R,Q){return window.setTimeout(function(){R()},25)})})(),g={textarea:true,input:true,select:true,button:true},i={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},d={move:"touchmove",cancel:"touchend",end:"touchend"};function n(S){var U=S,T=false,Q=false;function R(V){if(T){U();C(R);Q=true;T=false}else{Q=false}}this.kick=function(V){T=true;if(!Q){R()}};this.end=function(W){var V=U;if(!W){return}if(!Q){W()}else{U=T?function(){V();W()}:W;T=true}}}function K(){return true}function P(){return false}function B(Q){Q.preventDefault()}function N(Q){if(g[Q.target.tagName.toLowerCase()]){return}Q.preventDefault()}function F(Q){return(Q.which===1&&!Q.ctrlKey&&!Q.altKey)}function L(S,T){var R,Q;if(S.identifiedTouch){return S.identifiedTouch(T)}R=-1;Q=S.length;while(++R<Q){if(S[R].identifier===T){return S[R]}}}function l(R,Q){var S=L(R.changedTouches,Q.identifier);if(!S){return}if(S.pageX===Q.pageX&&S.pageY===Q.pageY){return}return S}function o(R){var Q;if(!F(R)){return}Q={target:R.target,startX:R.pageX,startY:R.pageY,timeStamp:R.timeStamp};e(document,i.move,u,Q);e(document,i.cancel,x,Q)}function u(R){var Q=R.data;r(R,Q,R,z)}function x(Q){z()}function z(){v(document,i.move,u);v(document,i.cancel,x)}function O(R){var S,Q;if(g[R.target.tagName.toLowerCase()]){return}S=R.changedTouches[0];Q={target:S.target,startX:S.pageX,startY:S.pageY,timeStamp:R.timeStamp,identifier:S.identifier};e(document,d.move+"."+S.identifier,p,Q);e(document,d.cancel+"."+S.identifier,D,Q)}function p(R){var Q=R.data,S=l(R,Q);if(!S){return}r(R,Q,S,M)}function D(R){var Q=R.data,S=L(R.changedTouches,Q.identifier);if(!S){return}M(Q.identifier)}function M(Q){v(document,"."+Q,p);v(document,"."+Q,D)}function r(U,T,V,S){var R=V.pageX-T.startX,Q=V.pageY-T.startY;if((R*R)+(Q*Q)<(c*c)){return}q(U,T,V,R,Q,S)}function H(){this._handled=K;return false}function J(Q){Q._handled()}function q(U,Y,S,X,V,W){var R=Y.target,T,Q;T=U.targetTouches;Q=U.timeStamp-Y.timeStamp;Y.type="movestart";Y.distX=X;Y.distY=V;Y.deltaX=X;Y.deltaY=V;Y.pageX=S.pageX;Y.pageY=S.pageY;Y.velocityX=X/Q;Y.velocityY=V/Q;Y.targetTouches=T;Y.finger=T?T.length:1;Y._handled=H;Y._preventTouchmoveDefault=function(){U.preventDefault()};y(Y.target,Y);W(Y.identifier)}function G(Q){var R=Q.data.timer;Q.data.touch=Q;Q.data.timeStamp=Q.timeStamp;R.kick()}function b(R){var Q=R.data.event,S=R.data.timer;a();w(Q,S,function(){setTimeout(function(){v(Q.target,"click",P)},0)})}function a(Q){v(document,i.move,G);v(document,i.end,b)}function A(R){var Q=R.data.event,T=R.data.timer,S=l(R,Q);if(!S){return}R.preventDefault();Q.targetTouches=R.targetTouches;R.data.touch=S;R.data.timeStamp=R.timeStamp;T.kick()}function h(R){var Q=R.data.event,T=R.data.timer,S=L(R.changedTouches,Q.identifier);if(!S){return}k(Q);w(Q,T)}function k(Q){v(document,"."+Q.identifier,A);v(document,"."+Q.identifier,h)}function E(R,U,Q,T){var S=Q-R.timeStamp;R.type="move";R.distX=U.pageX-R.startX;R.distY=U.pageY-R.startY;R.deltaX=U.pageX-R.pageX;R.deltaY=U.pageY-R.pageY;R.velocityX=0.3*R.velocityX+0.7*R.deltaX/S;R.velocityY=0.3*R.velocityY+0.7*R.deltaY/S;R.pageX=U.pageX;R.pageY=U.pageY}function w(R,S,Q){S.end(function(){R.type="moveend";y(R.target,R);return Q&&Q()})}function f(S,R,Q){e(this,"movestart.move",J);return true}function t(Q){v(this,"dragstart drag",B);v(this,"mousedown touchstart",N);v(this,"movestart",J);return true}function I(Q){if(Q.namespace==="move"||Q.namespace==="moveend"){return}e(this,"dragstart."+Q.guid+" drag."+Q.guid,B,j,Q.selector);e(this,"mousedown."+Q.guid,N,j,Q.selector)}function m(Q){if(Q.namespace==="move"||Q.namespace==="moveend"){return}v(this,"dragstart."+Q.guid+" drag."+Q.guid);v(this,"mousedown."+Q.guid)}s.event.special.movestart={setup:f,teardown:t,add:I,remove:m,_default:function(S){var Q,R;if(!S._handled()){return}function T(U){E(Q,R.touch,R.timeStamp);y(S.target,Q)}Q={target:S.target,startX:S.startX,startY:S.startY,pageX:S.pageX,pageY:S.pageY,distX:S.distX,distY:S.distY,deltaX:S.deltaX,deltaY:S.deltaY,velocityX:S.velocityX,velocityY:S.velocityY,timeStamp:S.timeStamp,identifier:S.identifier,targetTouches:S.targetTouches,finger:S.finger};R={event:Q,timer:new n(T),touch:j,timeStamp:j};if(S.identifier===j){e(S.target,"click",P);e(document,i.move,G,R);e(document,i.end,b,R)}else{S._preventTouchmoveDefault();e(document,d.move+"."+S.identifier,A,R);e(document,d.end+"."+S.identifier,h,R)}}};s.event.special.move={setup:function(){e(this,"movestart.move",s.noop)},teardown:function(){v(this,"movestart.move",s.noop)}};s.event.special.moveend={setup:function(){e(this,"movestart.moveend",s.noop)},teardown:function(){v(this,"movestart.moveend",s.noop)}};e(document,"mousedown.move",o);e(document,"touchstart.move",O);if(typeof Array.prototype.indexOf==="function"){(function(S,T){var R=["changedTouches","targetTouches"],Q=R.length;while(Q--){if(S.event.props.indexOf(R[Q])===-1){S.event.props.push(R[Q])}}})(s)}});
/* /htapps/roger.babel/pt/web/js/jquery.event.move-min.js */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if((typeof module!=="undefined"&&module!==null)&&module.exports){module.exports=a}else{a(jQuery)}}})(function(g,h){var f=g.event.add,c=g.event.remove,d=function(j,i,k){g.event.trigger(i,k,j)},e={threshold:0.4,sensitivity:6};function b(l){var i,j,k;i=l.currentTarget.offsetWidth;j=l.currentTarget.offsetHeight;k={distX:l.distX,distY:l.distY,velocityX:l.velocityX,velocityY:l.velocityY,finger:l.finger};if(l.distX>l.distY){if(l.distX>-l.distY){if(l.distX/i>e.threshold||l.velocityX*l.distX/i*e.sensitivity>1){k.type="swiperight";d(l.currentTarget,k)}}else{if(-l.distY/j>e.threshold||l.velocityY*l.distY/i*e.sensitivity>1){k.type="swipeup";d(l.currentTarget,k)}}}else{if(l.distX>-l.distY){if(l.distY/j>e.threshold||l.velocityY*l.distY/i*e.sensitivity>1){k.type="swipedown";d(l.currentTarget,k)}}else{if(-l.distX/i>e.threshold||l.velocityX*l.distX/i*e.sensitivity>1){k.type="swipeleft";d(l.currentTarget,k)}}}}function a(i){var j=g.data(i,"event_swipe");if(!j){j={count:0};g.data(i,"event_swipe",j)}return j}g.event.special.swipe=g.event.special.swipeleft=g.event.special.swiperight=g.event.special.swipeup=g.event.special.swipedown={setup:function(k,j,i){var k=a(this);if(k.count++>0){return}f(this,"moveend",b);return true},teardown:function(){var i=a(this);if(--i.count>0){return}c(this,"moveend",b);return true},settings:e}});
/* /htapps/roger.babel/pt/web/js/jquery.event.swipe-min.js */
(function(f,g,d){var c=f(g),e=g.Modernizr;e.addTest("csstransformspreserve3d",function(){var l=e.prefixed("transformStyle");var k="preserve-3d";var j;if(!l){return false}l=l.replace(/([A-Z])/g,function(n,m){return"-"+m.toLowerCase()}).replace(/^ms-/,"-ms-");e.testStyles("#modernizr{"+l+":"+k+";}",function(m,n){j=g.getComputedStyle?getComputedStyle(m,null).getPropertyValue(l):""});return(j===k)});var a=f.event,b,i;b=a.special.debouncedresize={setup:function(){f(this).on("resize",b.handler)},teardown:function(){f(this).off("resize",b.handler)},handler:function(n,j){var m=this,l=arguments,k=function(){n.type="debouncedresize";a.dispatch.apply(m,l)};if(i){clearTimeout(i)}j?k():i=setTimeout(k,b.threshold)},threshold:150};f.BookBlock=function(j,k){this.$el=f(k);this._init(j)};f.BookBlock.defaults={orientation:"vertical",direction:"ltr",speed:1000,easing:"ease-in-out",shadows:true,shadowSides:0.2,shadowFlip:0.1,edges:null,doublePages:true,circular:false,nextEl:"",prevEl:"",autoplay:false,interval:3000,onEndFlip:function(j,l,k){return false},onEdgeClick:function(j,l,k){return false},onBeforeFlip:function(j){return false}};f.BookBlock.prototype={_init:function(k){this.options=f.extend(true,{},f.BookBlock.defaults,k);this.$el.addClass("bb-"+this.options.orientation);this.$items=this.$el.children(".bb-item").hide();this.itemsCount=this.$items.length;this.current=0;this.previous=-1;this.$current=this.$items.eq(this.current).show();this.elWidth=this.$el.width();var m={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.transEndEventName=m[e.prefixed("transition")]+".bookblock";this.support=e.csstransitions&&e.csstransforms3d&&e.csstransformspreserve3d;if(e.no_ie&&e.js&&e.desktop){this.support=true}this.clipflip_support=(!this.support&&e.canvas);this._initEvents();this._setupEdges();if(this.clipflip_support){var l=this.$items.length;this._clipReset="rect(0px "+this.$el.width()+"px "+this.$el.height()+"px 0px)";this._clipLeft="rect(0px 0px "+this.$el.height()+"px 0px)";var j=this;setTimeout(function(){j.$items.each(function(n,o){f(o).css({"z-index":l-n});f(o).attr("id","p"+n)})},0)}if(this.options.autoplay){this.options.circular=true;this._startSlideshow()}g.book=this},_initEvents:function(){var j=this;if(this.options.nextEl!==""){f(this.options.nextEl).on("click.bookblock touchstart.bookblock",function(){j._action("next");return false})}if(this.options.prevEl!==""){f(this.options.prevEl).on("click.bookblock touchstart.bookblock",function(){j._action("prev");return false})}c.on("debouncedresize",function(){j.elWidth=j.$el.width()})},_action:function(j,k){this._stopSlideshow();this._navigate(j,k)},_navigate:function(j,k){if(this.isAnimating){return false}this.options.onBeforeFlip(this.current);this.isAnimating=true;this.$current=this.$items.eq(this.current);if(k!==d){this.current=k}else{if(j==="next"&&this.options.direction==="ltr"||j==="prev"&&this.options.direction==="rtl"){if(!this.options.circular&&this.current===this.itemsCount-1){this.end=true}else{this.previous=this.current;this.current=this.current<this.itemsCount-1?this.current+1:0}}else{if(j==="prev"&&this.options.direction==="ltr"||j==="next"&&this.options.direction==="rtl"){if(!this.options.circular&&this.current===0){this.end=true}else{this.previous=this.current;this.current=this.current>0?this.current-1:this.itemsCount-1}}}}this.$nextItem=!this.options.circular&&this.end?this.$current:this.$items.eq(this.current);if(this.clipflip_support){this._layoutClipFlipSupport(j)}else{if(!this.support){this._layoutNoSupport(j)}else{this._layout(j)}}},_layoutNoSupport:function(k){this.$items.fadeOut("fast");this.$nextItem.fadeIn("fast");this.end=false;this.isAnimating=false;this.$current.hide();var j=k==="next"&&this.current===this.itemsCount-1||k==="prev"&&this.current===0;this._updateEdges();this.options.onEndFlip(this.previous,this.current,j)},_layoutClipFlipSupport:function(m){var l=this;var j=function(){l.end=false;l.isAnimating=false;l.$current.hide();var p=m==="next"&&l.current===l.itemsCount-1||m==="prev"&&l.current===0;l._updateEdges();l.options.onEndFlip(l.previous,l.current,p)};l.isAnimating=true;var k=this.$items.index(this.$current);var o=this.$items.index(this.$nextItem);if(m==="next"){var n=this.$current;this.$current.css("clip",this._clipReset);this.$nextItem.show();setTimeout(function(){n.animate({clip:l._clipLeft},400,function(){l.$current.css("clip","");j()})},0)}else{if(m==="prev"){var n=this.$nextItem;this.$nextItem.css("clip",this._clipLeft);this.$nextItem.show();setTimeout(function(){l.$nextItem.animate({clip:l._clipReset},400,function(){l.$nextItem.css("clip","");j()})},0)}}},_layout:function(l){var v=this,u=this._addSide("left",l),o=this._addSide("middle",l),j=this._addSide("right",l),r=u.find("div.bb-overlay"),t=o.find("div.bb-flipoverlay:first"),w=o.find("div.bb-flipoverlay:last"),s=j.find("div.bb-overlay"),k=this.end?400:this.options.speed;this.$items.hide();this.$el.prepend(u,o,j);o.css({transitionDuration:k+"ms",transitionTimingFunction:this.options.easing}).on(this.transEndEventName,function(y){if(f(y.target).hasClass("bb-page")){v.$el.children(".bb-page").remove();v.$nextItem.show();v.end=false;v.isAnimating=false;var x=l==="next"&&v.current===v.itemsCount-1||l==="prev"&&v.current===0;v._updateEdges();v.options.onEndFlip(v.previous,v.current,x)}});if(l==="prev"){o.addClass("bb-flip-initial")}if(this.options.shadows&&!this.end){var n=(l==="next")?{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms"}:{transition:"opacity "+this.options.speed/2+"ms linear",opacity:this.options.shadowSides},q=(l==="next")?{transition:"opacity "+this.options.speed/2+"ms linear"}:{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms",opacity:this.options.shadowFlip},m=(l==="next")?{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms",opacity:this.options.shadowFlip}:{transition:"opacity "+this.options.speed/2+"ms linear"},p=(l==="next")?{transition:"opacity "+this.options.speed/2+"ms linear",opacity:this.options.shadowSides}:{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms"};t.css(q);w.css(m);r.css(n);s.css(p)}setTimeout(function(){o.addClass(v.end?"bb-flip-"+l+"-end":"bb-flip-"+l);if(v.options.shadows&&!v.end){t.css({opacity:l==="next"?v.options.shadowFlip:0});w.css({opacity:l==="next"?0:v.options.shadowFlip});r.css({opacity:l==="next"?v.options.shadowSides:0});s.css({opacity:l==="next"?0:v.options.shadowSides})}},25)},_addSide:function(l,k){var j;switch(l){case"left":j=f('<div class="bb-page"><div class="bb-back"><div class="bb-outer"><div class="bb-content"><div class="bb-inner">'+(k==="next"?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",102);break;case"middle":j=f('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content"><div class="bb-inner">'+(k==="next"?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-flipoverlay"></div></div></div><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+(k==="next"?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-flipoverlay"></div></div></div></div>').css("z-index",103);break;case"right":j=f('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content"><div class="bb-inner">'+(k==="next"?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",101);break}return j},_startSlideshow:function(){var j=this;this.slideshow=setTimeout(function(){j._navigate("next");if(j.options.autoplay){j._startSlideshow()}},this.options.interval)},_stopSlideshow:function(){if(this.options.autoplay){clearTimeout(this.slideshow);this.options.autoplay=false}},next:function(){this._action(this.options.direction==="ltr"?"next":"prev")},prev:function(){this._action(this.options.direction==="ltr"?"prev":"next")},jump:function(k){k-=1;if(k===this.current||k>=this.itemsCount||k<0){return false}var j;if(this.options.direction==="ltr"){j=k>this.current?"next":"prev"}else{j=k>this.current?"prev":"next"}this._action(j,k)},last:function(){this.jump(this.itemsCount)},first:function(){this.jump(1)},status:function(){return{current:this.current,end:this.end}},_updateEdges:function(){var j=this;if(this.options.edges==null||this.options.edges.$edge.length==0){return}this._calculate_edges();setTimeout(function(){j._draw_edges()},100)},_setupEdges:function(){var j=this;if(this.options.edges==null||this.options.edges.$edge.length==0){return}this.edges=this.options.edges;this.edges.right_w=0;this.edges.left_w=0;this.edges.page_factor=10;this.edges.num=this.$items.length*2;this.edges.width=this.$el.width();this.edges.max_w=this.edges.max_edge_width;console.log(this.$el,this.$el.parent(),this.$el.parent().outerWidth(true),this.$el.parent().outerWidth());this.edges.page_w=3*Math.ceil(this.edges.num/this.edges.page_factor);if(this.edges.page_w>this.edges.max_w){this.edges.page_w=this.edges.max_w;this.edges.page_factor=Math.ceil((3*this.edges.num)/this.edges.page_w)}this.edges.$edge.on("click",function(k){j._click_edge(k)});this._calculate_edges();this._draw_edges()},_calculate_edges:function(){var k=((this.current*2)-1)/this.edges.num;var j=(this.edges.num-(this.current*2)+1)/this.edges.num;this.edges.left_w=this.edges.page_w*k;this.edges.right_w=this.edges.page_w*j;if(this.edges.left_w<2){this.edges.left_w=2}if(this.edges.right_w<2){this.edges.right_w=2}},_draw_edges:function(){this.edges.$edge.css({left:-(this.edges.left_w),right:-(this.edges.right_w)})},_click_edge:function(o){var k=f(o.target);var p=o.pageX-k.offset().left;p=(o.pageX-k.offset().left);var l;var n;var m;var q;var j="LEFT";if(p>(k.width()/2)){j="RIGHT";l=(this.edges.right_w-(k.width()-p))/this.edges.right_w;m=(this.edges.num-(this.current*2));q=this.current*2}else{l=p/this.edges.left_w;m=(this.current-1)*2;q=0}if(l>1){l=1}var n=q+(m*l);this.options.onEdgeClick(-1,Math.ceil(n/2),false)},isActive:function(){return this.isAnimating},update:function(){var j=this.$items.eq(this.current);this.$items=this.$el.children(".bb-item");this.itemsCount=this.$items.length;this.current=j.index()},toggleLayoutSupport:function(){if(!this._master_support){this._master_support=this.support}if(this._master_support){this.support=!this.support}},destroy:function(){if(this.options.autoplay){this._stopSlideshow()}this.$el.removeClass("bb-"+this.options.orientation);this.$items.show();if(this.options.nextEl!==""){f(this.options.nextEl).off(".bookblock")}if(this.options.prevEl!==""){f(this.options.prevEl).off(".bookblock")}c.off("debouncedresize")}};var h=function(j){if(g.console){g.console.error(j)}};f.fn.bookblock=function(k){if(typeof k==="string"){var j=Array.prototype.slice.call(arguments,1);this.each(function(){var l=f.data(this,"bookblock");if(!l){h("cannot call methods on bookblock prior to initialization; attempted to call method '"+k+"'");return}if(!f.isFunction(l[k])||k.charAt(0)==="_"){h("no such method '"+k+"' for bookblock instance");return}l[k].apply(l,j)})}else{this.each(function(){var l=f.data(this,"bookblock");if(l){l._init()}else{l=f.data(this,"bookblock",new f.BookBlock(k,this))}})}return this}})(jQuery,window);
/* /htapps/roger.babel/pt/web/js/jquery.bookblock-min.js */
!function(b){var a=function(d,c){this.element=b(d);this.picker=b('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element);this.id=this.element.data("slider-id")||c.id;if(this.id){this.picker[0].id=this.id}if(typeof Modernizr!=="undefined"&&Modernizr.touch){this.touchCapable=true}var f=this.element.data("slider-tooltip")||c.tooltip;this.tooltip=this.picker.find(".tooltip");this.tooltipInner=this.tooltip.find("div.tooltip-inner");this.orientation=this.element.data("slider-orientation")||c.orientation;switch(this.orientation){case"vertical":this.picker.addClass("slider-vertical");this.stylePos="top";this.mousePos="pageY";this.sizePos="offsetHeight";this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",this.element.outerWidth());this.orientation="horizontal";this.stylePos="left";this.mousePos="pageX";this.sizePos="offsetWidth";if(this.touchCapable){this.tooltip.addClass("right")[0].style.left="100%"}else{this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px"}break}this.min=this.element.data("slider-min")||c.min;this.max=this.element.data("slider-max")||c.max;this.step=this.element.data("slider-step")||c.step;this.value=this.element.data("slider-value")||c.value;if(this.value[1]){this.range=true}this.selection=this.element.data("slider-selection")||c.selection;this.selectionEl=this.picker.find(".slider-selection");if(this.selection==="none"){this.selectionEl.addClass("hide")}this.selectionElStyle=this.selectionEl[0].style;this.handle1=this.picker.find(".slider-handle:first");this.handle1Stype=this.handle1[0].style;this.handle2=this.picker.find(".slider-handle:last");this.handle2Stype=this.handle2[0].style;var e=this.element.data("slider-handle")||c.handle;switch(e){case"round":this.handle1.addClass("round");this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle");this.handle2.addClass("triangle");break}if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection=="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];this.formater=c.formater;this.layout();if(this.touchCapable){this.picker.on({touchstart:b.proxy(this.mousedown,this)})}else{this.picker.on({mousedown:b.proxy(this.mousedown,this)})}if(f==="show"){this.picker.on({mouseenter:b.proxy(this.showTooltip,this),mouseleave:b.proxy(this.hideTooltip,this),})}else{this.tooltip.addClass("hide")}};a.prototype={constructor:a,over:false,inDrag:false,showTooltip:function(){this.tooltip.addClass("in");console.log(this.tooltip);this.over=true},hideTooltip:function(){console.log("HIDE TOOLTIP",this.inDrag,this.over);if(this.inDrag===false){this.tooltip.removeClass("in")}this.over=false},layout:function(){this.handle1Stype[this.stylePos]=this.percentage[0]+"%";this.handle2Stype[this.stylePos]=this.percentage[1]+"%";if(this.orientation=="vertical"){this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%";this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"}else{this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%";this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%"}if(this.range){this.tooltipInner.text(this.formater(this.value[0])+" : "+this.formater(this.value[1]));this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}else{this.tooltipInner.text(this.formater(this.value[0]));if(this.touchCapable&&this.orientation==="horizontal"){this.tooltip[0].style[this.stylePos]=(this.size*this.percentage[0]/100+this.tooltip.outerWidth()/4)+"px"}else{this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-(this.orientation==="vertical"?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"}}},mousedown:function(d){if(this.touchCapable&&d.type==="touchstart"){d=d.originalEvent;if(!this.tooltip.hasClass("hide")){this.showTooltip()}}this.offset=this.picker.offset();this.size=this.picker[0][this.sizePos];var c=this.getPercentage(d);if(this.range){var g=Math.abs(this.percentage[0]-c);var e=Math.abs(this.percentage[1]-c);this.dragged=(g<e)?0:1}else{this.dragged=0}this.percentage[this.dragged]=c;this.layout();if(this.touchCapable){b(document).on({touchmove:b.proxy(this.mousemove,this),touchend:b.proxy(this.mouseup,this)})}else{b(document).on({mousemove:b.proxy(this.mousemove,this),mouseup:b.proxy(this.mouseup,this)})}this.inDrag=true;var f=this.calculateValue();this.element.trigger({type:"slideStart",value:f}).trigger({type:"slide",value:f});return false},mousemove:function(d){if(this.touchCapable&&d.type==="touchmove"){d=d.originalEvent}var c=this.getPercentage(d);if(this.range){if(this.dragged===0&&this.percentage[1]<c){this.percentage[0]=this.percentage[1];this.dragged=1}else{if(this.dragged===1&&this.percentage[0]>c){this.percentage[1]=this.percentage[0];this.dragged=0}}}this.percentage[this.dragged]=c;this.layout();var e=this.calculateValue();this.element.trigger({type:"slide",value:e}).data("value",e).prop("value",e);return false},mouseup:function(c){if(this.touchCapable){b(document).off({touchmove:this.mousemove,touchend:this.mouseup});this.hideTooltip()}else{b(document).off({mousemove:this.mousemove,mouseup:this.mouseup})}console.log("MOUSEUP",this.over);this.inDrag=false;if(this.over==false){this.hideTooltip()}this.element;var d=this.calculateValue();this.element.trigger({type:"slideStop",value:d}).data("value",d).prop("value",d);return false},calculateValue:function(){var c;if(this.range){c=[(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step),(this.min+Math.round((this.diff*this.percentage[1]/100)/this.step)*this.step)];this.value=c}else{c=(this.min+Math.round((this.diff*this.percentage[0]/100)/this.step)*this.step);this.value=[c,this.value[1]]}return c},getPercentage:function(d){if(this.touchCapable){d=d.touches[0]}var c=(d[this.mousePos]-this.offset[this.stylePos])*100/this.size;c=Math.round(c/this.percentage[2])*this.percentage[2];return Math.max(0,Math.min(100,c))},getValue:function(){if(this.range){return this.value}return this.value[0]},setValue:function(c){this.value=c;if(this.range){this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0]));this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))}else{this.value=[Math.max(this.min,Math.min(this.max,this.value))];this.handle2.addClass("hide");if(this.selection=="after"){this.value[1]=this.max}else{this.value[1]=this.min}}this.diff=this.max-this.min;this.percentage=[(this.value[0]-this.min)*100/this.diff,(this.value[1]-this.min)*100/this.diff,this.step*100/this.diff];this.layout()}};b.fn.slider=function(c,d){return this.each(function(){var g=b(this),f=g.data("slider"),e=typeof c==="object"&&c;if(!f){g.data("slider",(f=new a(this,b.extend({},b.fn.slider.defaults,e))))}if(typeof c=="string"){f[c](d)}})};b.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round",formater:function(c){return c}};b.fn.slider.Constructor=a}(window.jQuery);
/* /htapps/roger.babel/pt/web/js/bootstrap-slider-min.js */
head.ready(function(){var g;var e;var i;var d;var f;g=$(window);e=$(".sidebar-wrap");i=e.find(".scrollable");if(!e.length){return}HT.x=10;f=$(".navbar-static-top");var c=g.height()-f.height();var a=c-$(".bibLinks").height()-HT.x;$.subscribe("action.toggle.fullscreen.sidebar",function(){if(e.parent().is(":visible")){console.log("SIDEBAR PARENT IS VISIBLE");e.trigger("sticky_kit:detach");e.stick_in_parent({inner_scrolling:false,offset_top:f.height()+10,recalc_every:500})}else{console.log("SIDEBAR PARENT IS HIDDEN");e.trigger("sticky_kit:detach");e.css("left","auto")}});var b=e.position().left;e.data("original-left",e.position().left);e.on("sticky_kit:stick",function(h){e.css("left","auto")}).on("sticky_kit:unstick",function(h){e.css("left","auto")}).on("sticky_kit:bottom",function(h){e.css("left","auto")}).on("sticky_kit:unbottom",function(h){});g.scroll(function(){var h=e.css("left");if(e.css("position")=="fixed"){if(h=="auto"){h=e.position().left}e.css("left",(-g.scrollLeft()+b)+"px")}else{e.css("left","auto")}});$.subscribe("view.ready.sidebar",function(){e.trigger("sticky_kit:detach");i.height(a);e.stick_in_parent({inner_scrolling:false,offset_top:f.height()+10,recalc_every:500})})});
/* /htapps/roger.babel/pt/web/js/sidebar-min.js */
var HT=HT||{};var $body=$("body");HT.Reader={init:function(a){this.options=$.extend({},this.options,a);this.id=this.options.params.id;HT.engines.imgsrv=Object.create(HT.ImgSrv).init({base:window.location.pathname.replace("/pt","/imgsrv")});this._tracking=false;return this},options:{},start:function(){var b=this;this._handleView(this.getView(),"start");this.bindEvents();var a={};if(HT.params.size&&HT.params.size!="100"){var c=parseInt(HT.params.size);a[this.getView()]=c}HT.engines.manager=Object.create(HT.Manager).init({id:b.id,seq:b.options.params.seq,zooms:a});HT.engines.manager.start();if(this.options.params.ui=="fullscreen"){var d=$("#action-toggle-fullscreen");if(!d.is(":disabled")){setTimeout(function(){b._manageFullScreen(true)},250)}}},updateView:function(a){if(a==this.getView()){return}HT.prefs.set({pt:{view:a}});if(a=="image"||a=="plaintext"){window.location.href=this.$views.find("a[data-target="+a+"]").attr("href");return}this.$views.find("a.active").removeClass("active");this.$views.find("a[data-target="+a+"]").addClass("active");this._tracking=false;this._handleView(this.getView(),"exit");this._handleView(a,"start");this._updateViews(a);this.setView(a);HT.engines.manager.restart()},bindEvents:function(){var b=this;$("body").on("click","a",function(f){if($(this).attr("disabled")){f.preventDefault();return false}});var e=$("#action-toggle-fullscreen");this._bindAction("toggle.fullscreen",this._toggleFullScreen);$(window).bind("fullscreen-toggle",function(g,f){b._manageFullScreen(f)}).bind("fullscreen-on",function(f){b._manageFullScreen(true)}).bind("fullscreen-off",function(f){b._manageFullScreen(false)}).bind("fullscreen-key",function(h,g,f){b._manageFullScreen()});if(this.getView()=="image"||this.getView()=="plaintext"){$(".toolbar").find("a[href='']").attr("disabled","disabled").attr("tabindex","-1");$(".action-views").on("click","a",function(){var f=$(this).data("target");HT.prefs.set({pt:{view:f}})});return}b.$views=$(".action-views");b.$views.on("click","a",function(h){h.preventDefault();var g=$(this);var f=g.data("target");b.updateView(f)});b.$views.find("a.active").removeClass("active").end().find("a[data-target='"+b.getView()+"']").addClass("active");$(".toolbar .btn[data-toggle*=tracking]").each(function(){if($(this).data("target")=="image"||$(this).data("target")=="plaintext"){return}var f=$(this).data("toggle");if(f.indexOf("tracking-action")<0){$(this).data("toggle",f.replace("tracking","tracking-action"))}});this._bindAction("go.first");this._bindAction("go.prev");this._bindAction("go.next");this._bindAction("go.last");this._bindAction("zoom.in");this._bindAction("zoom.out");this._bindAction("rotate.clockwise");this._bindAction("rotate.counterclockwise");$(".table-of-contents").on("click","a",function(g){g.preventDefault();var f=$(this).data("seq");$.publish("action.go.page",(f));$(".bb-bookblock").removeClass("lowered")});$("#action-go-page").click(function(h){h.preventDefault();var g=$.trim($("#input-go-page").val());var f;if(!g){return}if(g.match(/^\d+/)){f=HT.engines.manager.getSeqForPageNum(g);if(!f){f=g}}else{if(g.substr(0,1)=="n"){f=g.substr(1)}}if(f){$.publish("action.go.page",(f))}});$.subscribe("update.go.page",function(h,f){var i=f;if($.isArray(f)){f=f[0]!=null?f[0]:f[1]}var g=HT.engines.manager.getPageNumForSeq(f);if(!g){g=""}$("#input-go-page").val(g);b.setCurrentSeq(f,i);if(b.$slider&&HT.engines.view){b.$slider.slider("setValue",b.getView()=="2up"?HT.engines.view._seq2page(f):f)}});$.subscribe("update.zoom.size",function(h,g){if(b._animating){return}var f=Math.ceil(g*100);HT.params.size=f;HT.engines.manager.update_zoom(b.getView(),f)});$.subscribe("update.rotate.orient",function(g,f){HT.params.orient=f});$.subscribe("update.focus.page",function(g,f){b.setCurrentSeq(f);b.updateView("1up")});$.subscribe("view.ready.reader",function(){b._tracking=true;if(b.getView()=="2up"){setTimeout(function(){b.buildSlider()},250)}b._centerContentDisplay();$(window).trigger("reset")});$.subscribe("disable.download.page.pdf",function(){$(".page-pdf-link").attr("disabled","disabled").addClass("disabled").attr("tabindex",-1)});$.subscribe("enable.download.page.pdf",function(){$(".page-pdf-link").attr("disabled",null).removeClass("disabled").attr("tabindex",null)});$.subscribe("enable.download.page.pdf",function(){$(".page-pdf-link").attr("disabled",null).removeClass("disabled")});$.subscribe("view.end.reader",function(){$.publish("enable.zoom");$.publish("enable.rotate");$.publish("enable.download.page");$.publish("enable.toggle.fullscreen")});var d=get_resize_root();var c={width:d.width(),height:d.height()};var a=_.debounce(function(f){console.log("POSTING RESIZE EVENT",d.width(),"x",d.height());$.publish("action.resize")},500);d.on("resize.reader",a)},getCurrentSeq:function(){return this._current_seq||this.options.params.seq||1},setCurrentSeq:function(b){var a=this;this._current_seq=b;HT.params.seq=b;this._updateState();this._updateLinks.apply(this,arguments);$(".action-views").find("a").each(function(){a._updateLinkSeq($(this),b)})},_centerContentDisplay:function(){var b=$("#content");var c=$(window);var a=b.position().left+b.width();if(a>c.width()&&c.scrollLeft()==0){c.scrollLeft(a-c.width()-($("#sidebar").width()*0.4))}},_toggleFullScreen:function(b){var a=this;var c=$(b);if(c.hasClass("active")){a._manageFullScreen(false)}else{console.log("LAUNCHING FULL SCREEN");a._manageFullScreen(true)}},_manageFullScreen:function(d){var a=this;var c=$("#action-toggle-fullscreen");var b=$(".sidebar");if(d==null){d=!c.hasClass("active")}a._full_screen_state=d;a._animating=true;if(!d){b.show("fast",function(){$(window).scroll();c.removeClass("active");c.find(".icomoon-fullscreen-exit").removeClass("icomoon-fullscreen-exit").addClass("icomoon-fullscreen");$.publish("action.toggle.fullscreen");setTimeout(function(){a._animating=false},500)})}else{b.hide("fast",function(){$(window).scroll();c.addClass("active");c.find(".icomoon-fullscreen").removeClass("icomoon-fullscreen").addClass("icomoon-fullscreen-exit");$.publish("action.toggle.fullscreen");a._animating=false})}},_bindAction:function(d,b){var a=this;var e="#action-"+d.replace(".","-");var c=$(e);c.click(function(f){f.preventDefault();if(b==null){$.publish("action."+d,(this))}else{b.apply(a,[c])}}).subscribe("disable."+d,function(){$(this).attr("disabled","disabled").attr("tabindex",-1)}).subscribe("enable."+d,function(){$(this).attr("disabled",null).attr("tabindex",null)})},getView:function(){return this._current_view||this.options.params.view},setView:function(b){var a={Scroll:"1up",Flip:"2up",Thumbnail:"thumb",Image:"image",PlainText:"plaintext"};this._current_view=b;this.options.params.view=b;this._updateState({view:b,size:HT.engines.manager.get_zoom(b)})},getViewModule:function(){var a={"1up":"Scroll","2up":"Flip",thumb:"Thumbnail",image:"Image",plaintext:"PlainText"};return HT.Viewer[a[this.getView()]]},_updateState:function(d){var c=window.location.pathname;c+="?id="+HT.params.id;c+=";view="+this.getView();c+=";seq="+this.getCurrentSeq();var b=HT.engines.manager.get_zoom(this.getView());if(b&&b!=100){c+=";size="+b}if(HT.params.debug){c+=";debug="+HT.params.debug}if(HT.params.skin){c+=";skin="+HT.params.skin}if(window.history&&window.history.replaceState!=null){window.history.replaceState(null,document.title,c)}else{var a="#view="+this.getView();a+=";seq="+this.getCurrentSeq();if(b&&b!=100){a+=";size="+b}window.location.replace(a)}this._trackPageview(c);$.publish("update.reader.state")},_trackPageview:function(a){if(this._tracking&&HT.analytics&&HT.analytics.enabled){HT.analytics.trackPageview(HT.analytics._simplifyPageHref(a))}},_updateLinks:function(c,d){var b=this;if(!c){c=this.getCurrentSeq()}if(this.getView()=="2up"){_.each(d,function(f,g){var e=$("#pagePdfLink"+(g+1));b._updateLinkSeq(e,f)})}else{var a=$("#pagePdfLink");b._updateLinkSeq(a,c)}b._updateLinkSeq($("#pageURL"),c);b._updateLinkSeq($("input[name=seq]"),c);b._updateLinkSeq($("#login-button"),c)},_updateLinkSeq:function(c,b){if(!c.length){return}if(b==null){c.attr("disabled","disabled").attr("tabindex",-1)}else{if(!c.hasClass("disabled")){c.attr("disabled",null).attr("tabindex",null)}if(c.is("input")&&c.attr("name")=="seq"){c.val(b)}else{if(c.is("input")){var a=c.val();c.val(a.replace(/seq=\d+/,"seq="+b))}else{this._updateLinkAttribute(c,"seq",b)}}}},_updateViews:function(a){var b=this;if(!a){a=this.getView()}b._updateLinkAttribute($("#login-button"),"view",a);$("input[name=view]").val(a)},_updateLinkAttribute:function(b,g,e){if(!b.length){return}var a=b.attr("href");var d=new RegExp(g+"(=|%3D)");if(!d.test(a)){var h=g+"="+e;var c=a;var f;if((f=c.indexOf("target="))>-1){f+="target=".length;c=decodeURIComponent(a.substr(f))}var i=";";if(c.indexOf("&")>-1){i="&"}c+=i+h;if(f>-1){c=a.substr(0,f)+encodeURIComponent(c)}b.attr("href",c)}else{d=new RegExp(g+"(=|%3D)\\w+(;|&|%3B|%26)?");b.attr("href",a.replace(d,g+"$1"+e+"$2"))}},_handleView:function(a,b){if(a=="2up"){this._handleFlip(b)}},_handleFlip:function(c){var b=this;var a=$("#pagePdfLink").parent();if(c=="start"){var e=a.clone(true).find("a").attr("id","pagePdfLink1").text("Download left page (PDF)").end().insertAfter(a);var d=a.clone(true).find("a").attr("id","pagePdfLink2").text("Download right page (PDF)").end().insertAfter(e);a.hide()}else{$("#pagePdfLink1").parent().remove();$("#pagePdfLink2").parent().remove();a.show()}},_parseParams:function(){},buildSlider:function(){var a=this;if(!HT.engines.manager){return}var c=$(".nob");if(!c.length){c=$('<input type="text" class="nob" value="1" />').appendTo($("#content"))}var b=HT.engines.manager;var d=b.getLastSeq();var e=b.getPageNumForSeq(d);if(e===undefined){e="n"+d}var f=a.getCurrentSeq();var g=a.getView();if(g=="2up"){f=HT.engines.view._seq2page(f)}a.$slider=c.slider({min:0,max:g=="2up"?HT.engines.view.pages.length-1:d-1,value:f,selection:"none",tooltip:"show",formater:function(h){if(g=="2up"){var j=h;h=HT.engines.view._page2seq(h);if(h[0]==null){h=h[1]}else{h=h[0]}}var i=b.getPageNumForSeq(h);var k=" / "+e;if(i){k=i+k}else{k="n"+h+k}return k},handle:"square"}).on("slideStop",function(i){var h=i.value;if(g=="2up"){h=HT.engines.view._page2seq(h);if(h[0]!==null){h=h[0]}else{h=h[1]}}$.publish("action.go.page",(h))})},EOT:true};head.ready(function(){if(window.location.hash){var c=window.location.hash.substr(1).split(";");for(var a=0;a<c.length;a++){var b=c[a].split("=");HT.params[b[0]]=b[1]}}HT.engines={};HT.engines.reader=Object.create(HT.Reader).init({params:HT.params});HT.engines.reader.start();$(".toolbar-vertical .btn").each(function(){var d=$(this);var e=d.text();d.tooltip({title:e,placement:"left",container:"#main",delay:{show:250,hide:50},xtrigger:"hover focus",animation:false})});$(".toolbar-horizontal .btn").each(function(){var d=$(this);var e=d.find(".label").text();if(e){d.tooltip({title:e,placement:"bottom",container:".toolbar-horizontal",delay:{show:250,hide:50},xtrigger:"hover focus",animation:false})}});$("html").on("click.dropdown.reader",".table-of-contents .btn",function(d){$(".bb-bookblock").toggleClass("lowered")});HT.analytics.getTrackingLabel=function(d){var e=HT.params.id+" "+HT.params.seq+" "+HT.params.size+" "+HT.params.orient+" "+HT.params.view;return e}});function launchFullscreen(a){if(a.requestFullscreen){a.requestFullscreen()}else{if(a.mozRequestFullScreen){a.mozRequestFullScreen()}else{if(a.webkitRequestFullscreen){a.webkitRequestFullscreen()}else{if(a.msRequestFullscreen){a.msRequestFullscreen()}}}}}function exitFullscreen(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}};
/* /htapps/roger.babel/pt/web/js/reader-min.js */
var HT=HT||{};HT.Manager={init:function(a,b){this.options=$.extend({},this.options,a);this.data={};this.page_num_map={};this.num_seq_map={};this.seq_num_map={};return this},options:{zooms:{}},start:function(){var c=this;var a=HT.engines.reader.getView();var d=-1;if(this.options.zooms[a]&&this.options.zooms[a]!=100){d=this.options.zooms[a]/100}HT.engines.view=Object.create(HT.engines.reader.getViewModule()).init({manager:c,reader:HT.engines.reader,zoom:d});if(!HT.engines.view.options.is_dynamic){HT.engines.view.start();return}var b=HT.engines.imgsrv.get_action_url("meta",{});$.getJSON(b+"callback=?",{id:this.options.id,format:"items",limit:1000002,method:"fudged",start:0,debug:HT.params.debug||""},function(e){c.data=e;c.num_pages=e.items.length;c.reading_order=e.readingOrder;c.parse_page_numbers();$.ajaxSetup({async:true});HT.engines.view.start()},"json")},restart:function(){var b=this;HT.engines.view.end();delete HT.engines.view;var a=HT.engines.reader.getView();var c=b.get_zoom(a);c=c==100?-1:c/100;console.log("RESTARTING",a,c);HT.engines.view=Object.create(HT.engines.reader.getViewModule()).init({manager:b,reader:HT.engines.reader,zoom:c});setTimeout(function(){HT.engines.view.start();$(window).trigger("reset")},100)},update_zoom:function(a,b){this.options.zooms[a]=b},get_zoom:function(a){return this.options.zooms[a]||100},parse_page_numbers:function(){var a=this;a.num_seq_map={};a.seq_num_map={};for(var b=0;b<a.data.items.length;b++){var c=a.data.items[b];if(c.page_num){if(a.num_seq_map[c.page_num]===undefined){a.num_seq_map[c.page_num]=c.seq}a.seq_num_map[c.seq]=c.page_num}}},getSeqForPageNum:function(a){return this.num_seq_map[a]},getPageNumForSeq:function(a){return this.seq_num_map?this.seq_num_map[a]:null},getLastSeq:function(){var a=this.num_pages;if(this.has_feature(a,"BACK_COVER")||(this.has_feature(1,"COVER")&&this.has_feature(1,"LEFT"))){a-=1}return a},getAltTextForSeq:function(a){var c="";var b=this.getPageNumForSeq(a);if(b){c+="page "+b}else{c+="sequence "+a}return c},rotate_image:function(b){var a=this.get_page_meta(b);if(!a.orient){a.orient=0}a.orient+=1;if(a.orient==4){a.orient=0}this.set_page_meta({seq:b.seq,meta:a})},set_page_meta:function(a){this.data.items[a.seq]=a.meta},get_page_meta:function(e){var d;if(this.data.items[e.seq-1]){d=this.data.items[e.seq-1]}else{var a=680;var b=a*1.294;d={width:a,height:b,orient:0}}if(e.width){var c=e.width/d.width;d.width=e.width;d.height=d.height*c}return d},has_feature:function(b,a){if(typeof(b)=="number"){b=this.get_page_meta({seq:b})}if(b.features&&_.indexOf(b.features,a)>-1){return true}return false},has_features:function(a){if(typeof(a)=="number"){a=this.get_page_meta({seq:a})}if(a.features&&a.features.length>0){if(a.features.length==1&&a.features[0]=="FUDGED"){return false}return true}return false},get_text:function(g){var b=this;var d=this.get_page_meta(g);args={seq:g.seq,id:this.options.id};var f=HT.engines.imgsrv.get_action_url(g.action||"ocr",args);var e=false;var c=$.ajax({url:f,dataType:"html"});var a=$("<div class='ocr_page'></div>");$.when(c.promise()).done(function(h){a.append($(h).children());if(!$.trim(a.text())){a.addClass("empty").empty().append('<div class="ocr_page"><div class="ocrx_block"><div class="ocr_par"><div class="alert alert-block alert-info alert-headline"><p>NO TEXT ON PAGE</p></div><p>This page does not contain any text recoverable by the OCR engine.</p></div></div>')}a.trigger("text.loaded")});return a},get_image_src:function(c){var a=this.get_page_meta(c);args={seq:c.seq,id:this.options.id,width:c.width};if(c.height){args.height=c.height}if(c.orient){args.orient=c.orient}c.seq=10;var b=HT.engines.imgsrv.get_action_url(c.action||"image",args);return b},get_image:function(f){var a=this;var e=a.get_image_src(f);var d=false;var c=$.Deferred();var b=$("<img/>");b.load(c.resolve);b.error(c.reject);b.get(0).src=e;$.when(c.promise()).done(function(){var g=new Image();$(g).load(function(){var k;var j;var i;if(f.orient==1||f.orient==3){j=g.width;i=g.height}else{i=g.width;j=g.height}k=680/i;j=j*k;a.data.items[f.seq]={width:680,height:j};b.data("seq",f.seq);b.data("natural-height",g.height);b.data("natural-width",g.width);b.trigger("image.fudge")}).attr("src",b.get(0).src)}).fail(function(g){b.get(0).src="/imgsrv/common-web/graphics/503_image_distorted.jpg";b.data("natural-width",320);b.data("natural-height",480);b.trigger("image.fudge")});return b},EOT:true};
/* /htapps/roger.babel/pt/web/js/manager-min.js */
var HT=HT||{};HT.ImgSrv={init:function(a){this.options=$.extend({},this.options,a);return this},options:{},get_action_url:function(c,d){var b=this.options.base+"/"+c+"?";var a=[];if(d.id){a.push("id="+d.id)}if(d.seq){a.push("seq="+d.seq)}if(d.width){a.push("width="+Math.ceil(d.width))}if(d.height){a.push("height="+Math.ceil(d.height))}if(d.orient!==undefined){a.push("orient="+d.orient)}if(d.format){a.push("format="+d.format)}if(d.limit){a.push("limit="+d.limit)}if(d.method){a.push("method="+d.method)}if(d.start){a.push("start="+d.start)}if(a.length&&HT.params.debug){a.push("debug="+HT.params.debug)}return b+a.join(";")},EOT:true};
/* /htapps/roger.babel/pt/web/js/imgsrv-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Image={name:"image",init:function(b){var a=this;return this},options:{},start:function(){$body.addClass("view-image");this.bindEvents()},bindEvents:function(){var a=this;$.publish("disable.toggle.fullscreen");$body.find(".page-item img").load(function(){$(window).scroll()})},_gotoLink:function(a){window.location.href=$(a).attr("href")},EOT:true};
/* /htapps/roger.babel/pt/web/js/image-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Scroll={name:"scroll",init:function(b){var a=this;this.options=$.extend({},this.options,b);this.w=this.options.default_w;this.zoom=this.options.zoom;this.zoom_levels=[0.25,0.5,0.75,1,1.25,1.5,1.75,2,3,4];this.orient_cache={};return this},options:{default_w:680,zoom:-1,is_dynamic:true},start:function(){$("body").addClass("view-1up");$.publish("enable.download.page");this.options.seq=HT.engines.reader.getCurrentSeq();this.bindEvents();this.bindScroll();this._calculateBestFitZoom();if(this.zoom<0){this.zoom=this.reset_zoom}else{var a=this.zoom_levels.indexOf(this.zoom);if(a<0){this.zoom=this.reset_zoom}}this.w=this.options.default_w*this.zoom;this.drawPages()},end:function(){$.unsubscribe(".scroll");$.publish("view.end");$(window).unbind(".scroll");$("body").unbind(".scroll");$("#content").empty();$(window).scrollTop(0);$("body").removeClass("view-1up")},bindEvents:function(){var a=this;$.subscribe("action.go.next.scroll",function(c){a.gotoPage(null,1)});$.subscribe("action.go.prev.scroll",function(c){a.gotoPage(null,-1)});$.subscribe("action.go.first.scroll",function(c){a.gotoPage(1)});$.subscribe("action.go.last.scroll",function(c){a.gotoPage(HT.engines.manager.num_pages)});$.subscribe("action.go.page.scroll",function(d,c){a.gotoPage(c)});$.subscribe("action.zoom.in.scroll",function(c){a.incrementZoom(1)});$.subscribe("action.zoom.out.scroll",function(c){a.incrementZoom(-1)});$.subscribe("action.zoom.reset.scroll",function(c){a.updateZoom(a.reset_zoom)});$.subscribe("action.rotate.clockwise.scroll",function(c){a.rotateCurrentPage(1)});$.subscribe("action.rotate.counterclockwise.scroll",function(c){a.rotateCurrentPage(-1)});$("body").on("image.fudge.scroll","img",function(){var e=$(this).data("natural-height");var c=$(this).parent().height();$(this).parent().addClass("loaded");var d=50;if(Math.abs(e-c)>d){$(this).parent().height(e);$(this).parent().addClass("imaged").addClass("expanded")}});var b=_.debounce(function(){if(a._resizing){return}a._resizing=true;a._calculateBestFitZoom();a.drawPages();a._resizing=false;console.log("RESIZE SCROLL")},250);$.subscribe("action.resize.scroll",function(c){b()})},incrementZoom:function(d){var b=this;var c=b.zoom_levels.indexOf(b.zoom);var a=c+d;if(a+d<0){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}if(a+d>=b.zoom_levels.length){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}b.updateZoom(b.zoom_levels[a])},updateZoom:function(b){var a=this;a.zoom=b;a.w=a.options.default_w*a.zoom;a.drawPages();$.publish("update.zoom.size",(a.zoom))},rotateCurrentPage:function(e){var b=this;var d=$(".page-item.current");var a=d.data("seq");var c=this.getPageOrient(a);this.orient_cache[a]=c=((c+e)+4)%4;this.drawPages();$.publish("update.rotate.orient",(c))},getPageOrient:function(a){return this.orient_cache[a]||0},bindScroll:function(){var a=this;var c=$(window);var b=_.debounce(function(){var n=Date.now();var s=[];var g=c.scrollTop();var m=c.height();var j=$(".page-item.current");var q=0;if(j.length){try{q=j.fracs().visible}catch(v){}}if(!$(".page-item").length){return}var x=$(".page-item.imaged");x.addClass("checking");var h=$(".page-item");var p=$();var k=0;var d;var w=false;for(var r=0;r<h.length;r++){var o=h.slice(r,r+1);var t=o.fracs();if(t.visible){a.loadPage(o);p.push(o.get(0));if(t.visible>k){k=t.visible;d=o}w=true}else{if(w){break}}}if(d.attr("id")!=j.attr("id")){j.removeClass("current").attr("aria-hidden","true");d.addClass("current").attr("aria-hidden","false");$.publish("update.go.page",(d.data("seq")))}var l=p.slice(0,1).prev();var u=p.slice(-1).next();a.loadPage(l);a.loadPage(u);$(".page-item.checking").removeClass("imaged").removeClass("loaded").removeClass("checking").find("img").remove();a.checkPageStatus()},250);$(window).on("scroll.viewer.scroll",b)},gotoPage:function(b,d){var a=this;if(b==null){var c=$(".page-item.current");var b=c.data("seq")}if(d!=null){b+=d}var c=$("#page"+b);if(!c.length){return}$("html,body").animate({scrollTop:c.offset().top-100},"fast",function(){$(window).trigger("scroll.viewer.scroll")})},loadPage:function(b){if(!b.length){return}if(!b.is(".imaged")){b.addClass("imaged");var a=b.data("seq");if(!a){console.log("NO SEQUENCE?",b);return}var c=HT.engines.manager.get_image({seq:a,width:this.w,orient:this.getPageOrient(a)});var d="image of "+HT.engines.manager.getAltTextForSeq(a);c.attr("alt",d);b.append(c)}else{b.removeClass("checking")}},getCurrentSeq:function(){var a=$(".page-item.current");if(a.length){return a.data("seq")}return null},drawPages:function(){var c=this;var i=c.getCurrentSeq();if(i==null&&c.options.seq){i=c.options.seq;delete c.options.seq}$("#content").empty();var e=document.createDocumentFragment();for(var b=1;b<=HT.engines.manager.num_pages;b++){var g=HT.engines.manager.get_page_meta({seq:b,width:c.w,orient:c.getPageOrient(b)});var d=$('<div class="page-item" aria-hidden="true"><div class="page-num">{SEQ}</div>'.replace("{SEQ}",b)).appendTo($(e));d.attr("id","page"+b);var a=g.width;var f=g.height;if(c.getPageOrient(b)==1||c.getPageOrient(b)==3){f=g.width;a=g.height}d.css({height:f+2,width:a+4});d.data("seq",b)}$("#content").append(e);$(window).scroll();if(i&&i>1){setTimeout(function(){c.gotoPage(i);$.publish("view.ready")},500)}else{setTimeout(function(){$.publish("view.ready")},500)}},checkPageStatus:function(){var a=this;var c=$("#page1").fracs();var b=$("#page"+HT.engines.manager.num_pages).fracs();if(c.visible>=0.9){$.publish("disable.go.first")}else{$.publish("enable.go.first")}if(b.visible>=0.9){$.publish("disable.go.last")}else{$.publish("enable.go.last")}},_getPageMargin:function(){return 1.2},_calculateBestFitZoom:function(){var d=this;var e=$("#content");var c=e.width();if($("html").is(".mobile")){c*=0.9;console.log("WIDTH =",c)}var b=-1;var a=0;for(var f=0;f<d.zoom_levels.length;f++){var g=d.zoom_levels[f];var h=d.options.default_w*g*d._getPageMargin();if(h>c){if(h/c<1.25){d.reset_zoom=g}break}d.reset_zoom=g}},EOT:true};
/* /htapps/roger.babel/pt/web/js/scroll-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Thumbnail={name:"thumbnail",init:function(b){var a=this;this.options=$.extend({},this.options,b);this.inited=false;this.zoom=this.options.zoom;this.zoom_levels=[0.25,0.5,0.75,1,1.25,1.5,1.75,2,3,4];this.w=-1;return this},options:{default_w:150,min_w:75,max_w:250,zoom:-1,is_dynamic:true},start:function(){this.inited=false;$("body").addClass("view-thumb");this.bindEvents();this.bindScroll();this._calculateAverages();this._calculateBestFitZoom();var b=1;if(this.zoom>0){console.log("INIT THUMBNAIL WITH ZOOM",this.zoom,this.options.default_w*this.zoom,this.options.min_w,this.options.max_w);var a=this.zoom_levels.indexOf(this.zoom);if(a<0||this.options.default_w*this.zoom>this.options.max_w||this.options.default_w*this.zoom<this.options.min_w){this.zoom=this.reset_zoom}}else{this.zoom=this.reset_zoom}this.updateZoom(0,this.zoom);$.publish("disable.rotate");$.publish("disable.download.page");this.inited=true},end:function(){$.unsubscribe(".thumb");$.publish("view.end");$("#content").empty();$(window).unbind(".thumb");$("body").unbind(".thumb");$(window).scrollTop(0);$("body").removeClass("view-thumb");console.log("UNBOUND THUMBNAIL")},bindEvents:function(){var a=this;var c=$("body");$.subscribe("action.go.first.thumb",function(f){a.gotoPage(1)});$.subscribe("action.go.last.thumb",function(f){a.gotoPage(HT.engines.manager.getLastSeq())});$.subscribe("action.go.next.thumb",function(f){a.gotoPage(null,-1)});$.subscribe("action.go.prev.thumb",function(f){a.gotoPage(null,1)});$.subscribe("action.go.page.thumb",function(g,f){a.gotoPage(f)});$.subscribe("action.zoom.in.thumb",function(f){a.updateZoom(1)});$.subscribe("action.zoom.out.thumb",function(f){a.updateZoom(-1)});c.on("click.thumb",".page-link",function(g){g.preventDefault();var f=$(this).attr("href").substr(1);$.publish("update.focus.page",(f))});c.on("image.fudge.thumb","img",function(){var g=$(this).data("natural-height");var h=$(this).parents(".page-item");var e=h.height();var f=50;var j=(g>e)?e:g;var i=(g>e)?g:e;h.addClass("loaded").removeClass("loading")});var d=_.debounce(function(){if(!a.inited){return}if(a._resizing){return}console.log("THUMBNAIL RESIZE EVENT",a.inited);a._resizing=true;a.w=-1;a.drawPages();a._resizing=false},250);var b=get_resize_root();b.on("resize.viewer.thumb",d)},updateZoom:function(e,c){var b=this;var d=b.zoom_levels.indexOf(b.zoom);if(e==0){e=b.zoom_levels.indexOf(c)-d}var a=d+e;if(a+e<0||b.default_w*b.zoom_levels[a+e]<b.options.min_w){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}if(a+e>=b.zoom_levels.length||b.default_w*b.zoom_levels[a+e]>b.options.max_w){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}b.zoom=b.zoom_levels[a];b.w=(b.default_w*b.zoom);b.drawPages();$.publish("update.zoom.size",(b.zoom))},updateZoom_XX:function(b){var a=this;a.w=a.w*b;a.zoom=a.zoom*b;if(a.w*b>a.options.max_w){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}if(b*a.w<a.options.min_w){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}a.drawPages();$.publish("update.zoom.size",(a.zoom))},bindScroll:function(){var a=this;var b=_.debounce(function(){console.log("REPAINTING THUMBNIAL");var k=Date.now();if(!$(".page-item").length){return}var n=$(".page-item.imaged");n.addClass("checking");var m=$();var c=$(".page-item");var e=false;for(var h=0;h<c.length;h++){var j=c.slice(h,h+1);var l=j.fracs();if(l.visible){m=m.add(j);e=true}else{if(e){break}}}a.loadPage(m);var d=m.slice(0,1).prevAll().slice(0,6);var g=m.slice(-1).nextAll().slice(0,6);a.loadPage(d);a.loadPage(g);$(".page-item.checking").removeClass("imaged checking loaded loading").find("img").remove();a.checkPageStatus()},250);$(window).on("scroll.viewer.thumb",b);console.log("DEFINED SCROLL EVENT")},gotoPage:function(a,d){var b;if(a==null){var c=$(".page-item:in-viewport");b=c.slice(d);a=b.data("seq");if(d<0){a-=1}else{a+=1}}if(a<1){a=1}else{if(a>HT.engines.manager.getLastSeq()){a=HT.engines.manager.getLastSeq()}}var b=$("#page"+a);if(!b.length){return}$("html,body").animate({scrollTop:b.offset().top-100},"fast")},loadPage:function(b){var a=this;b.removeClass("checking");a._processLoadQueue(b.toArray())},_processLoadQueue:function(b){var c=this;var a=[];var e=0;while(e<b.length){var d=b.slice(e,e+4);if(d.length){a.push(d)}e+=4}if(!a.length){return}var g;var f=function(){var i=$(".loading");if(i.length>2){return}var h=a.shift();if(a.length==0){clearInterval(g)}_.each(h,function(o){var k=$(o);if(!k.is(".imaged")){k.addClass("imaged").addClass("loading");var j=k.data("seq");var n=k.find("a.page-link");var m=k.data("h");var l=HT.engines.manager.get_image({seq:j,width:c.w,height:m,action:"thumbnail"});l.attr("alt","image of "+HT.engines.manager.getAltTextForSeq(j));n.append(l)}else{k.removeClass("checking")}})};g=setInterval(f,500)},_calculateAverages:function(){var j=this;var b={};for(var k=1;k<=HT.engines.manager.num_pages;k++){var g=HT.engines.manager.get_page_meta({seq:k,width:680});b[g.height]=(b[g.height]||0)+1}var a=-1;var f;var e=_.keys(b);j.h=e[0];for(var c=0;c<e.length;c++){var d=e[c];if(b[d]>a){a=b[d];j.h=d}}},drawPages:function(){var b=this;$("#content").empty();b.$container=$('<div class="thumbnails"></div>');if(HT.engines.manager.reading_order=="right-to-left"){b.$container.addClass("rtl")}var d=document.createDocumentFragment();for(var a=1;a<=HT.engines.manager.num_pages;a++){var i=HT.engines.manager.get_page_meta({seq:a,width:680});var f=b.w/i.width;var e=b.h*f;var c=$('<div class="page-item"><div class="page-num">{SEQ}</div><a class="page-link" href="#{SEQ}"></a></div>'.replace(/\{SEQ\}/g,a)).appendTo($(d));c.attr("id","page"+a);c.css({height:e,width:b.w});c.data("seq",a);c.data("h",e)}b.$container.append(d);$("#content").append(b.$container);b.$container.show();$(window).scroll();var g=HT.engines.reader.getCurrentSeq();if(g&&g>1){b.gotoPage(g)}$.publish("view.ready")},checkPageStatus:function(){var a=this;var g=$("#page1").fracs();var e=$("#page"+HT.engines.manager.num_pages).fracs();if(g.visible>=0.9){$.publish("disable.go.first")}else{$.publish("enable.go.first")}if(e.visible>=0.9){$.publish("disable.go.last")}else{$.publish("enable.go.last")}var d=$(".page-item:in-viewport");for(var b=0;b<d.length;b++){var c=d.slice(b,b+1);var f=c.fracs();if(f&&f.visible>=0.75){$.publish("update.go.page",(c.data("seq")));break}}},_calculateBestFitZoom:function(){var c=this;var f=$("#content").width();var a=c.options.min_w;var b=a;var e=1;var d=1.25;while(a*4<f){b=a;a*=d;e*=d}if(b>c.options.max_w){b=c.options.max_w}c.default_w=b;c.reset_zoom=1},EOT:true};
/* /htapps/roger.babel/pt/web/js/thumb-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.Flip={name:"flip",init:function(b){var a=this;this.options=$.extend({},this.options,b);this.w=-1;this.zoom=this.options.zoom;this.zoom_levels=[0.25,0.5,0.75,1,1.25,1.5,1.75,2,3,4];this.orient_cache={};this.rotate=0;return this},options:{default_w:680,zoom:-1,is_dynamic:true},start:function(){$("body").addClass("view-2up");$.publish("enable.download.page");$.publish("disable.rotate");this.is_rtl=HT.engines.manager.reading_order=="right-to-left";this.options.seq=HT.engines.reader.getCurrentSeq();this._calculateBestFitZoom();if(this.zoom<0){this.zoom=this.reset_zoom}else{var a=this.zoom_levels.indexOf(this.zoom);if(a<0){this.zoom=this.reset_zoom}}this.bindEvents();this.updateZoom(0,this.zoom)},end:function(){$.unsubscribe(".flip");$.publish("view.end");$(window).unbind(".flip");$(document).unbind(".flip");$("body").unbind(".flip");$("#content").empty().css("margin-top","");$("body").removeClass("view-2up")},bindEvents:function(){var a=this;$.subscribe("action.go.next.flip",function(d){a.gotoPage(null,1)});$.subscribe("action.go.prev.flip",function(d){a.gotoPage(null,-1)});$.subscribe("action.go.first.flip",function(d){a.gotoPage(a.is_rtl?HT.engines.manager.num_pages:1)});$.subscribe("action.go.last.flip",function(d){a.gotoPage(a.is_rtl?1:HT.engines.manager.num_pages)});$.subscribe("action.go.page.flip",function(f,d){a.gotoPage(d)});$.subscribe("action.zoom.in.flip",function(d){a.updateZoom(1)});$.subscribe("action.zoom.out.flip",function(d){a.updateZoom(-1)});$.subscribe("action.zoom.reset.flip",function(d){a.updateZoom(0,a.reset_zoom)});$.subscribe("action.rotate.clockwise.flip",function(d){a.rotateBook(1)});$.subscribe("action.rotate.counterclockwise.flip",function(d){a.rotateBook(-1)});$.subscribe("action.toggle.fullscreen.flip",function(d){a._calculateBestFitZoom();a.updateZoom(0,a.reset_zoom)});a.resize_timer=null;var c=false;var b=_.debounce(function(){if(a._resizing){return}a._resizing=true;if(a.resize_timer===null){a.resize_timer=setTimeout(function(){if(a.zoom==a.reset_zoom){c=true}a._calculateBestFitZoom();if(c){a.zoom=a.reset_zoom}a.updateZoom(0,a.zoom);a.reset_timer=null},500)}a._resizing=false},250);$.subscribe("action.resize.flip",function(d){setTimeout(function(){a.handleResize()},100)});$("body").on("image.fudge.flip","img",function(){var j=$(this);var f=$(this).data("seq");var i=$(this).data("natural-height");var g=$(this).parent().height();var e=$(this).data("natural-width");var d=$(this).parent().parent().width()/2;var h=100;$(this).parent().addClass("loaded");if(e-a.w>h){var k=$(this).parent();$(this).parent().addClass("untypical-page");if(!k.find("button").length){$('<button href="{SRC}" class="btn btn-mini">View Larger</button>'.replace("{SRC}",j.attr("src"))).appendTo($(this).parent()).click(function(l){l.preventDefault();$.fancybox.open([{href:j.attr("src"),type:"image"}]);return false})}}});$(document).on("keydown.flip",function(g){var f=g.keyCode||g.which;var d={left:37,up:38,right:39,down:40};switch(f){case d.left:a.gotoPage(null,-1);break;case d.right:a.gotoPage(null,1);break}})},handleResize:function(){var b=this;b._resizing=true;var c=false;var a=b.reset_zoom;if(b.zoom==b.reset_zoom){c=true}b._calculateBestFitZoom();if(c){b.zoom=b.reset_zoom}console.log("FLIP RESIZE",c,b.zoom,a,b.reset_zoom);b.updateZoom(0,b.zoom);b._resizing=false},updateZoom:function(e,c){var b=this;var d=b.zoom_levels.indexOf(b.zoom);if(e==0){e=b.zoom_levels.indexOf(c)-d}var a=d+e;if(a+e<0){$.publish("disable.zoom.out")}else{$.publish("enable.zoom.out")}if(a+e>=b.zoom_levels.length){$.publish("disable.zoom.in")}else{$.publish("enable.zoom.in")}b.zoom=b.zoom_levels[a];b.target_h=b.reset_target_h*b.zoom;console.log("UPDATE ZOOM",b.target_h,b.zoom);b.drawPages();$.publish("update.zoom.size",(b.zoom))},rotateBook:function(b){var a=this;a.$wrapper.addClass("flip-rotating");if(a.rotate>0){a.$wrapper.removeClass("flip-rotated-"+a.rotate)}a.rotate+=(90*b);if(a.rotate<0){a.rotate+=360}if(a.rotate==360||a.rotate==0){a.rotate=0}else{a.$wrapper.addClass("flip-rotated-"+a.rotate)}$.publish("update.rotate.orient",(a.rotate))},getPageOrient:function(a){return this.orient_cache[a]||0},gotoPage:function(b,d){var a=this;if(b!=null){var c=a._seq2page(b);a.loadPage(c);a.book.bookblock("jump",c+1)}else{if(d>0){a.book.bookblock("next")}else{a.book.bookblock("prev")}}a.checkPageStatus()},loadPage:function(b){var a=this;_.each(a._page2seq(b),function(c){if(c!=null){var d=$("#page"+c);if(!d.size()){return}if(d.find("img").size()){return}var e=HT.engines.manager.get_image({seq:c,height:Math.ceil(a.h)});e.attr("alt","image of "+HT.engines.manager.getAltTextForSeq(c));e.appendTo(d)}})},unloadPage:function(b){var a=this;_.each(a._page2seq(b),function(c){if(c==null){return}var d=$("#page"+c);if(!d.size()){return}d.find("img").remove()})},removeImage:function(a){var b=$("#page"+a);if(!b.size()){return}b.find("img").remove();b=$("#page"+(a+1));b.find("img").remove()},getCurrentSeq:function(){var a=this.book.data("bookblock").status();var b=this._page2seq(a.current);return b[0]||b[1]},drawPages:function(){var q=this;var s=q.is_rtl?-1:0;var t;if(q.book!=null){t=q.book.data("bookblock").status();s=t.current;q.book.bookblock("destroy");delete q.book}$("#content").empty();var e;if(Modernizr.canvas){e='<div class="bb-custom-wrapper"><div class="bb-bookblock"></div><div class="bb-edge"></div></div>'}else{e='<div class="bb-custom-wrapper"><div class="bb-bookblock"></div></div>'}$("#content").append(e);var u=$(".bb-bookblock");q.$container=u;q.$wrapper=$("#content").find(".bb-custom-wrapper");var w;var m=HT.engines.manager.get_page_meta({seq:1,width:680});q.r=m.width/m.height;var b=q.$target;var n=q.target_h;var A=q.margin_w;var j=q.height_target;var o=m.height/n;q.w=(m.width/o)*1;w=n;q.h=w;var g=(q.w*2)+q.margin_w;if(q.height_target=="window"&&g>$(window).width()&&q.zoom==q.reset_zoom){g=$(window).width()-25}if(q.zoom==q.reset_zoom&&n>0){if(w>n){var d=["REDEFINING",n,":",q.w,"x",q.h];o=n/w;w=n;q.h=w;q.w=q.w*o;d.push("/",q.w,"x",q.h);g=(q.w*2)+A;if(j=="window"&&g>$(window).width()&&q.zoom==q.reset_zoom){g=$(window).width()-25}}}console.log("META: ",m,q.zoom,q.reset_zoom,o,"/",q.w,q.h,"/",w,n);q.$wrapper.css({width:g});q.$wrapper.height(w);u.height(w);if(b!=null&&w<b.height()){var k=b.height()/2;k-=(w/2);q.$wrapper.css("margin-top",k+"px")}var l=[];var c=[];var v=1;var i=HT.engines.manager.num_pages;if(HT.engines.manager.has_feature(1,"FRONT_COVER")||(HT.engines.manager.has_feature(1,"COVER")&&HT.engines.manager.has_feature(1,"RIGHT"))||HT.engines.manager.has_feature(1,"COVER")||!HT.engines.manager.has_features(1)){if(HT.engines.manager.reading_order=="right-to-left"){l.push([1,null])}else{l.push([null,1])}v=2}var a;if(HT.engines.manager.has_feature(i,"BACK_COVER")||(HT.engines.manager.has_feature(1,"COVER")&&HT.engines.manager.has_feature(1,"LEFT"))){if(HT.engines.manager.reading_order=="right-to-left"){a=[null,i]}else{a=[i,null]}i-=1}for(var p=v;p<=i;p+=2){var z=p+1;if(z>HT.engines.manager.num_pages){z=null}if(HT.engines.manager.reading_order=="right-to-left"){l.push([z,p])}else{l.push([p,z])}}if(a){l.push(a)}if(HT.engines.manager.reading_order=="right-to-left"){l.reverse()}q._seq2page_map={};q._page2seq_map={};_.each(l,function(C,y){if(!C){return}var B=C[0];var h=C[1];var r='<div class="bb-item" aria-hidden="true">';q._page2seq_map[y]=[null,null];if(B){r+='<div id="page{SEQ}" class="bb-custom-side page-item page-left"><div class="page-num">{SEQ}</div></div>'.replace(/{SEQ}/g,B);q._seq2page_map[B]=y;q._page2seq_map[y][0]=B}else{r+='<div class="bb-custom-side page-item page-left empty"></div>'}if(h){r+='<div id="page{SEQ}" class="bb-custom-side page-item page-right"><div class="page-num">{SEQ}</div></div>'.replace(/{SEQ}/g,h);q._seq2page_map[h]=y;q._page2seq_map[y][1]=h}else{r+='<div class="bb-custom-side page-item page-right empty"></div>'}r+="</div>";q._attachPageHTML(r);$.each([B,h],function(){if(this){var D=HT.engines.manager.get_page_meta({seq:this});if(HT.engines.manager.has_feature(D,"UNTYPICAL_PAGE")){$("#page"+this).addClass("untypical-page")}}})});this.$leafs=u.find(".bb-item");var f=(($("#content").width()-u.width())*0.85)/2;this.book=u.bookblock({speed:600,shadowSides:0.8,shadowFlip:0.4,edges:{$edge:$(".bb-edge"),max_edge_width:f},n:l.length,onBeforeFlip:function(r,h){u.addClass("flipping");q.$leafs.slice(r,r+1).attr("aria-hidden","true")},onEndFlip:function(r,y,h){u.removeClass("flipping");q.$leafs.slice(y,y+1).attr("aria-hidden","false");q.loadPage(y-1);q.loadPage(y-2);q.loadPage(y+1);q.loadPage(y+2);q.unloadPage(y-8);q.unloadPage(y+8)},onEdgeClick:function(r,y,h){var B=q._page2seq(y);q.gotoPage(B[0])}});this.book.n=l.length;q.pages=l;if(q.options.seq){s=q._seq2page(q.options.seq);delete q.options.seq}else{if(s<0){s=l.length}}var x=HT.engines.manager.getPageNumForSeq(i);if(!x){x="n"+i}q.options.last_num=x;q.loadPage(s);q.loadPage(s+1);q.loadPage(s-1);q.book.bookblock("toggleLayoutSupport");q.book.bookblock("jump",s+1);q.book.bookblock("toggleLayoutSupport");$(window).scroll();setTimeout(function(){q.checkPageStatus()},100);u.on("click",".page-right",function(){q.gotoPage(null,1)}).on("click",".page-left",function(){q.gotoPage(null,-1)}).on("swipeleft",function(h){q.gotoPage(null,1)}).on("swiperight",function(h){q.gotoPage(null,-1)});$.publish("view.ready")},buildSlider:function(a,e){var b=this;var c=$('<input type="text" class="nob" value="1" />').appendTo($("#content"));var d=b.options.last_num;b.$slider=c.slider({min:0,max:a.length-1,value:e,selection:"none",tooltip:"show",label:function(i,h){var f=b._page2seq(i);if(f[0]==null){f=f[1]}else{f=f[0]}var g=HT.engines.manager.getPageNumForSeq(f);var j=" / "+d;if(g){j=g+j}else{j="n"+f+j}return j},handle:"square"}).on("slideStop",function(g){var h=g.value;var f=b._page2seq(h);b.gotoPage(f[0])})},checkPageStatus:function(){var c=this;var a=c.book.data("bookblock").status();if(a.current==0){$.publish("disable.go.first")}else{$.publish("enable.go.first")}if(a.end){$.publish("disable.go.last")}else{$.publish("enable.go.last")}var b=c._page2seq(a.current);$.publish("update.go.page",[b])},_calculateBestFitZoom:function(){var d=this;var c=$("#content").width();var f=$(window);var b;var h=-1;var e=$("#content").data("height-target");var a=0;if(e){b=(e=="window")?$(window):$("#"+e);h=b.height()*0.98}else{var g=$(window).height();console.log("BEST FIT target_h",g,$(window).height(),$(".navbar").height(),$(".toolbar-horizontal").height());h=g-$(".navbar").height()-$(".toolbar-horizontal").height()-25-75;a=75}d.reset_zoom=1;d.$target=b;d.height_target=e;d.target_h=h;d.reset_target_h=h;d.margin_w=a;console.log("BEST FIT",h,a)},_page2seq:function(a){return this._page2seq_map[a]},_seq2page:function(a){return this._seq2page_map[a]},_attachPageHTML:function(a){if(false&&HT.engines.manager.do_ltr){$(a).prependTo(this.$container)}else{$(a).appendTo(this.$container)}},isRTL:function(){return HT.engines.manager.reading_order=="right-to-left"},EOT:true};
/* /htapps/roger.babel/pt/web/js/flip-min.js */
var HT=HT||{};HT.Viewer=HT.Viewer||{};HT.Viewer.PlainText={name:"plaintext",init:function(b){var a=this;return this},options:{},start:function(){$body.addClass("view-plaintext");this.bindEvents()},bindEvents:function(){var a=this;$.publish("disable.toggle.fullscreen");$.publish("disable.zoom.in");$.publish("disable.zoom.out");$.publish("disable.rotate.clockwise");$.publish("disable.rotate.counterclockwise")},_gotoLink:function(a){window.location.href=$(a).attr("href")},EOT:true};
/* /htapps/roger.babel/pt/web/js/plaintext-min.js */
