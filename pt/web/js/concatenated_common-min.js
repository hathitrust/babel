(function(a){if(typeof define==="function"&&define.amd){if(typeof jQuery!=="undefined"){define(["jquery"],a)}else{define([],a)}}else{if(typeof jQuery!=="undefined"){a(jQuery)}else{a()}}})(function(b,e){var q={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],p={anchor:"fragment"},a={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},l=Object.prototype.toString,s=/^[0-9]+$/;function o(u,x){var z=decodeURI(u),w=a[x||false?"strict":"loose"].exec(z),y={attr:{},param:{},seg:{}},v=14;while(v--){y.attr[t[v]]=w[v]||""}y.param.query=f(y.attr.query);y.param.fragment=f(y.attr.fragment);y.seg.path=y.attr.path.replace(/^\/+|\/+$/g,"").split("/");y.seg.fragment=y.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");y.attr.base=y.attr.host?(y.attr.protocol?y.attr.protocol+"://"+y.attr.host:y.attr.host)+(y.attr.port?":"+y.attr.port:""):"";return y}function m(v){var u=v.tagName;if(typeof u!=="undefined"){return q[u.toLowerCase()]}return u}function c(x,w){if(x[w].length==0){return x[w]={}}var v={};for(var u in x[w]){v[u]=x[w][u]}x[w]=v;return v}function k(y,w,v,z){var u=y.shift();if(!u){if(g(w[v])){w[v].push(z)}else{if("object"==typeof w[v]){w[v]=z}else{if("undefined"==typeof w[v]){w[v]=z}else{w[v]=[w[v],z]}}}}else{var x=w[v]=w[v]||[];if("]"==u){if(g(x)){if(""!=z){x.push(z)}}else{if("object"==typeof x){x[j(x).length]=z}else{x=w[v]=[w[v],z]}}}else{if(~u.indexOf("]")){u=u.substr(0,u.length-1);if(!s.test(u)&&g(x)){x=c(w,v)}k(y,x,u,z)}else{if(!s.test(u)&&g(x)){x=c(w,v)}k(y,x,u,z)}}}}function d(y,x,B){if(~x.indexOf("]")){var A=x.split("["),u=A.length,z=u-1;k(A,y,"base",B)}else{if(!s.test(x)&&g(y.base)){var w={};for(var v in y.base){w[v]=y.base[v]}y.base=w}i(y.base,x,B)}return y}function f(u){return h(String(u).split(/&|;/),function(v,A){try{A=decodeURIComponent(A.replace(/\+/g," "))}catch(x){}var B=A.indexOf("="),z=n(A),w=A.substr(0,z||B),y=A.substr(z||B,A.length),y=y.substr(y.indexOf("=")+1,y.length);if(""==w){w=A,y=""}return d(v,w,y)},{base:{}}).base}function i(x,w,y){var u=x[w];if(e===u){x[w]=y}else{if(g(u)){u.push(y)}else{x[w]=[u,y]}}}function n(x){var u=x.length,w,y;for(var v=0;v<u;++v){y=x[v];if("]"==y){w=false}if("["==y){w=true}if("="==y&&!w){return v}}}function h(y,v){var w=0,u=y.length>>0,x=arguments[2];while(w<u){if(w in y){x=v.call(e,x,y[w],w,y)}++w}return x}function g(u){return Object.prototype.toString.call(u)==="[object Array]"}function j(v){var u=[];for(prop in v){if(v.hasOwnProperty(prop)){u.push(prop)}}return u}function r(u,v){if(arguments.length===1&&u===true){v=true;u=e}v=v||false;u=u||window.location.toString();return{data:o(u,v),attr:function(w){w=p[w]||w;return typeof w!=="undefined"?this.data.attr[w]:this.data.attr},param:function(w){return typeof w!=="undefined"?this.data.param.query[w]:this.data.param.query},fparam:function(w){return typeof w!=="undefined"?this.data.param.fragment[w]:this.data.param.fragment},segment:function(w){if(typeof w==="undefined"){return this.data.seg.path}else{w=w<0?this.data.seg.path.length+w:w-1;return this.data.seg.path[w]}},fsegment:function(w){if(typeof w==="undefined"){return this.data.seg.fragment}else{w=w<0?this.data.seg.fragment.length+w:w-1;return this.data.seg.fragment[w]}}}}if(typeof b!=="undefined"){b.fn.url=function(v){var u="";if(this.length){u=b(this).attr(m(this[0]))||""}return r(u,v)};b.url=r}else{window.purl=r}});
/* /htapps/roger.babel/pt/web/js/purl-min.js */
if(window.console===undefined){window.console={log:function(){}}}if(!Array.indexOf){Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a}}return -1}}if(!Array.prototype.reduce){Array.prototype.reduce=function(b){var a=this.length;if(typeof b!="function"){throw new TypeError()}if(a==0&&arguments.length==1){throw new TypeError()}var c=0;if(arguments.length>=2){var d=arguments[1]}else{do{if(c in this){d=this[c++];break}if(++c>=a){throw new TypeError()}}while(true)}for(;c<a;c++){if(c in this){d=b.call(null,d,this[c],c,this)}}return d}}if(!Date.now){Date.now=function(){return new Date().valueOf()}}var get_resize_root=function(){if(window.$resize_root===undefined){window.$resize_root=$(window);if($.browser.msie){if(parseInt($.browser.version)<=8){window.$resize_root=$("body");console.log("REDEFINING $window")}}}return window.$resize_root};head.ready(function(){!function(a){if(!Object.create){Object.create=function(c){if(arguments.length>1){throw new Error("Object.create implementation only accepts the first parameter.")}function b(){}b.prototype=c;return new b()}}a.plugin=function(c,b){a.fn[c]=function(d){return this.each(function(){if(!a.data(this,c)){a.data(this,c,Object.create(b).init(d,this))}else{var e=a.data(this,c);e.handle(d)}})}}}(window.jQuery);(function(a){var b=a({});a.subscribe=function(){b.on.apply(b,arguments)};a.unsubscribe=function(){b.off.apply(b,arguments)};a.publish=function(){b.trigger.apply(b,arguments)};a.fn.subscribe=function(c,e){var d=this;a.subscribe(c,function(){var f=arguments;d.each(function(){e.apply(this,f)})});return d}}(jQuery));$(document).ready(function(){$("#form-search-volume").submit(function(){var a=$(this);var c=a.find("button[type=submit]");if(c.hasClass("btn-loading")){alert("Your search query has been submitted and is currently being processed.");return false}var b=a.find("input[type=text]");if(!$.trim(b.val())){bootbox.alert("Please enter a term in the search box.");return false}c.addClass("btn-loading").attr("disabled","disabled");return true});$("#form-go-page").submit(function(){var a=$(this);var b=a.find("input[type=text]");if(!$.trim(b.val())){bootbox.alert("Please enter a page number.");return false}return true})});HT.analytics.getContentGroupData=function(){var b="";var a=4;if($("body").hasClass("view-restricted")){a=2;b="#restricted"}else{if(window.location.href.indexOf("debug=super")>-1){a=3;b="#super"}}return{index:a,value:HT.params.id+b}};HT.analytics._simplifyPageHref=function(b){$;var c=$.url(b);var d=c.segment();d.push($("html").data("content-provider"));d.push(c.param("id"));var a="";if(d.indexOf("search")>-1&&c.param("q1")){a="?q1="+c.param("q1")}d="/"+d.join("/")+a;return d};HT.analytics.getPageHref=function(){return HT.analytics._simplifyPageHref()}});
/* /htapps/roger.babel/pt/web/js/base-min.js */
var HT=HT||{};HT.feedback={};HT.feedback.dialog=function(){var b='<form>    <fieldset>        <legend>Email Address</legend>        <label for="email" class="offscreen">EMail Address</label>        <input type="text" class="input-xlarge" placeholder="[Your email address]" name="email" id="email" />        <span class="help-block">We will make every effort to address copyright issues by the next business day after notification.</span>    </fieldset>    <fieldset>        <legend>Overall page readability and quality</legend>        <label class="radio">            <input type="radio" name="Quality" value="readable" />            Few problems, entire page is readable        </label>        <label class="radio">            <input type="radio" name="Quality" value="someproblems" />            Some problems, but still readable        </label>        <label class="radio">            <input type="radio" name="Quality" value="difficult" />            Significant problems, difficult or impossible to read        </label>    </fieldset>    <fieldset>        <legend>Specific page image problems?</legend>        <label class="checkbox">            <input type="checkbox" name="missing" value="1" />            Missing parts of the page        </label>        <label class="checkbox">            <input type="checkbox" name="blurry" value="1" />            Blurry text        </label>        <label class="checkbox">            <input type="checkbox" name="curved" value="1" />            Curved or distorted text        </label>        <label>Other problem <input type="text" class="input-medium" name="other" value="" /></label>    </fieldset>    <fieldset>        <legend>Problems with access rights?</legend>        <span class="help-block"><strong>            (See also: <a href="http://www.hathitrust.org/take_down_policy" target="_blank">take-down policy</a>)        </strong></span>        <label class="radio">            <input type="radio" name="Rights" value="noaccess" />            This item is in the public domain, but I don\'t have access to it.        </label>        <label class="radio">            <input type="radio" name="Rights" value="access" />            I have access to this item, but should not.        </label>    </fieldset>    <p>        <label for="comments">Other problems or comments?</label>        <textarea id="comments" name="comments" rows="3"></textarea>    </p></form>';var a=$(b);$("<input type='hidden' name='SysID' />").val(HT.params.id).appendTo(a);$("<input type='hidden' name='RecordURL' />").val(HT.params.RecordURL).appendTo(a);if(HT.reader){$("<input type='hidden' name='SeqNo' />").val(HT.reader.getCurrentSeq()).appendTo(a)}else{if(HT.params.seq){$("<input type='hidden' name='SeqNo' />").val(HT.params.seq).appendTo(a)}}$("<input type='hidden' name='view' />").val(HT.params.view).appendTo(a);if(HT.crms_state){a.find("#email").val(HT.crms_state)}return a};
/* /htapps/roger.babel/pt/web/js/feedback-min.js */
var HT=HT||{};HT.Downloader={init:function(a){this.options=$.extend({},this.options,a);this.id=this.options.params.id;this.pdf={};return this},options:{},start:function(){var a=this;this.bindEvents()},bindEvents:function(){var a=this;$("a[data-toggle*=download]").addClass("interactive").click(function(b){b.preventDefault();bootbox.hideAll();if($(this).attr("rel")=="allow"){if(a.options.params.download_progress_base==null){return true}a.downloadPdf(this)}else{a.explainPdfAccess(this)}return false})},explainPdfAccess:function(b){var a=$("#noPdfAccess").html();this.$dialog=bootbox.alert(a);this.$dialog.addClass("login")},downloadPdf:function(d){var a=this;a.$link=$(d);a.src=$(d).attr("href");a.item_title=$(d).data("title")||"PDF";if(a.$link.data("range")=="yes"){if(!a.$link.data("seq")){return}}var b='<div class="initial"><p>Setting up download...</p></div><div class="progress progress-striped active hide"><div class="bar" width="0%"></div></div><div class="done hide"><p>All done!</p></div>';var f="Building your "+a.item_title;var c=a.$link.data("total")||0;if(c>0){var e=c==1?"page":"pages";f+=" ("+c+" "+e+")"}a.$dialog=bootbox.dialog(b,[{label:"Cancel","class":"btn-dismiss",callback:function(){if(a.$dialog.data("deactivated")){a.$dialog.modal("hide");return}$.ajax({url:a.src+";callback=HT.downloader.cancelDownload;stop=1",dataType:"script",cache:false,error:function(g,i,h){console.log("DOWNLOAD CANCELLED ERROR");a.$dialog.modal("hide");console.log(g,i,h);if(g.status==503){a.displayWarning(g)}else{a.displayError()}}})}}],{header:f});a.requestDownload()},requestDownload:function(){var a=this;var b={};if(a.$link.data("seq")){b.seq=a.$link.data("seq")}$.ajax({url:a.src.replace(/;/g,"&")+"&callback=HT.downloader.startDownloadMonitor",dataType:"script",cache:false,data:b,error:function(c,e,d){console.log("DOWNLOAD STARTUP NOT DETECTED");if(a.$dialog){a.$dialog.modal("hide")}if(c.status==503){a.displayWarning(c)}else{a.displayError(c)}}})},cancelDownload:function(c,a,d){var b=this;b.clearTimer();b.$dialog.modal("hide")},startDownloadMonitor:function(c,a,d){var b=this;if(b.timer){console.log("ALREADY POLLING");return}b.pdf.progress_url=c;b.pdf.download_url=a;b.pdf.total=d;b.is_running=true;b.num_processed=0;b.i=0;b.timer=setInterval(function(){b.checkStatus()},1000);b.checkStatus()},checkStatus:function(){var a=this;a.i+=1;$.ajax({url:a.pdf.progress_url,data:{ts:(new Date).getTime()},cache:false,dataType:"html",success:function(d){var b=a.updateProgress(d);var c=$.trim(d).split("\n").reverse();a.num_processed+=1;if(b.done){a.clearTimer()}else{if(b.error){a.$dialog.modal("hide");a.displayError();a.clearTimer()}}},error:function(b,d,c){console.log("FAILED: ",b,"/",d,"/",c);a.$dialog.modal("hide");a.clearTimer();if(b.status==404&&(a.i>25||a.num_processed>0)){a.displayError()}}})},updateProgress:function(e){var c=this;var a={done:false,error:false};var d;var f=$(e).find("#current").data("value");if(f=="EOT"){a.done=true;d=100}else{f=parseInt(f);d=100*(f/c.pdf.total)}if(c.last_percent!=d){c.last_percent=d;c.num_attempts=0}else{c.num_attempts+=1}if(c.num_attempts>100){a.error=true}if(c.$dialog.find(".initial").is(":visible")){c.$dialog.find(".initial").hide();c.$dialog.find(".progress").removeClass("hide")}c.$dialog.find(".bar").css({width:d+"%"});if(d==100){c.$dialog.find(".progress").hide();c.$dialog.find(".done").show();var b=c.$dialog.find(".download-pdf");if(!b.length){b=$('<a class="download-pdf btn btn-primary">Download {ITEM_TITLE}</a>'.replace("{ITEM_TITLE}",c.item_title)).attr("href",c.pdf.download_url);b.appendTo(c.$dialog.find(".modal-footer")).on("click",function(g){console.log("SHOULD BE THE FIRST TO FIRE");c.$link.trigger("click.google");setTimeout(function(){c.$dialog.modal("hide");b.remove();HT.engines.reader._clearRangeSelection()},1000);g.stopPropagation()})}c.$dialog.data("deactivated",true)}return a},clearTimer:function(){var a=this;if(a.timer){clearInterval(a.timer);a.timer=null}},displayWarning:function(f){var a=this;var g=parseInt(f.getResponseHeader("X-Choke-UntilEpoch"));var e=f.getResponseHeader("X-Choke-Rate");if(g<=5){setTimeout(function(){a.requestDownload()},5000);return}g*=1000;var b=(new Date).getTime();var d=(Math.ceil((g-b)/1000));var c=('<div><p>You have exceeded the download rate of {rate}. You may proceed in <span id="throttle-timeout">{countdown}</span> seconds.</p><p>Download limits protect HathiTrust resources from abuse and help ensure a consistent experience for everyone.</p></div>').replace("{rate}",e).replace("{countdown}",d);a.$dialog=bootbox.dialog(c,[{label:"OK","class":"btn-dismiss btn-primary",callback:function(){clearInterval(a.countdown_timer);return true}}]);a.countdown_timer=setInterval(function(){d-=1;a.$dialog.find("#throttle-timeout").text(d);if(d==0){clearInterval(a.countdown_timer)}console.log("TIC TOC",d)},1000)},displayError:function(b){var a="<p>There was a problem building your "+this.item_title+"; staff have been notified.</p><p>Please try again in 24 hours.</p>";bootbox.dialog(a,[{label:"OK","class":"btn-dismiss btn-inverse"}],{classes:"error"});console.log(b)},EOT:true};head.ready(function(){HT.downloader=Object.create(HT.Downloader).init({params:HT.params});HT.downloader.start()});
/* /htapps/roger.babel/pt/web/js/downloader-min.js */
head.ready(function(){$("#versionIcon").click(function(a){a.preventDefault();bootbox.alert('<p>This is the date when this item was last updated. Version dates are updated when improvements such as higher quality scans or more complete scans have been made. <br /><br /><a href="/cgi/feedback?page=form" data-default-form="data-default-form" data-toggle="feedback tracking-action" data-id="" data-tracking-action="Show Feedback">Contact us</a> for more information.</p>')})});
/* /htapps/roger.babel/pt/web/js/version_popup-min.js */
head.ready(function(){var b="450";var e="700";var d=HT.params.id;var f="http://www.hathitrust.org/embed";var a=function(i,j){return'<iframe width="'+i+'" height="'+j+'" '};var g='src="http://hdl.handle.net/2027/'+d+'?urlappend=%3Bui=embed"></iframe>';var c=$('<div class="embedUrlContainer"><h3>Embed This Book</h3><a id="embedHelpIcon" default-form="data-default-form" href="'+f+'" target="_blank">Help</a><form>    <span class="help-block">Copy the code below and paste it into the HTML of any website or blog.</span>    <label for="codeblock" class="offscreen">Code Block</label>    <textarea class="input-xlarge" id="codeblock" name="codeblock" rows="3">'+a(b,e)+g+'</textarea><div class="controls"><label class="radio inline"><input type="radio" name="view" id="view-scroll" value="0" checked="checked" ><span class="icomoon-scroll"/> Scroll View </label><label class="radio inline"><input type="radio" name="view" id="view-flip" value="1" ><span class="icomoon-book-alt2"/> Flip View </label></div></form></div>');$("#embedHtml").click(function(i){i.preventDefault();bootbox.dialog(c,[{label:"Cancel","class":"btn-dismiss"}]);c.closest(".modal").addClass("bootboxMediumWidth");var h=c.find("textarea[name=codeblock]");h.on("click",function(){$(this).select()});$('input:radio[id="view-scroll"]').click(function(){codeblock_txt=a(b,e)+g;h.val(codeblock_txt)});$('input:radio[id="view-flip"]').click(function(){codeblock_txt=a(e,b)+g;h.val(codeblock_txt)})})});
/* /htapps/roger.babel/pt/web/js/embedHtml_popup-min.js */
head.ready(function(){var m="a";var f="b";var e="This item is in your collection(s):";var d=$(".collectionLinks .select-collection");var b=$(".errormsg");var j=$(".infomsg");function o(q){if(!b.length){b=$('<div class="alert alert-error errormsg"></div>').insertAfter(d)}b.text(q).show()}function p(q){if(!j.length){j=$('<div class="alert alert-info infomsg"></div>').insertAfter(d)}j.text(q).show()}function l(){b.hide().text()}function h(){j.hide().text()}function n(){var q="/cgi/mb";if(location.pathname.indexOf("/shcgi/")>-1){q="/shcgi/mb"}return q}function i(t){var q={};var s=t.split("|");for(var r=0;r<s.length;r++){kv=s[r].split("=");q[kv[0]]=kv[1]}return q}function k(r){var q=$.extend({creating:false,label:"Save Changes"},r);var s=$('<form class="form-horizontal" action="mb"><div class="control-group"><label class="control-label" for="edit-cn">Collection Name</label><div class="controls"><input type="text" class="input-large" maxlength="100" name="cn" id="edit-cn" value="" placeholder="Your collection name" /><span class="label counter" id="edit-cn-count">100</span></div></div><div class="control-group"><label class="control-label" for="edit-desc">Description</label><div class="controls"><textarea id="edit-desc" name="desc" rows="4" maxlength="255" class="input-large" placeholder="Add your collection description."></textarea><span class="label counter" id="edit-desc-count">255</span></div></div><div class="control-group"><div class="controls"><label class="radio inline"><input type="radio" name="shrd" id="edit-shrd-0" value="0" checked="checked" > Private </label><label class="radio inline"><input type="radio" name="shrd" id="edit-shrd-1" value="1" > Public </label></div></div></form>');if(q.cn){s.find("input[name=cn]").val(q.cn)}if(q.desc){s.find("textarea[name=desc]").val(q.desc)}if(q.shrd!=null){s.find("input[name=shrd][value="+q.shrd+"]").attr("checked","checked")}else{if(!HT.login_status.logged_in){s.find("input[name=shrd][value=0]").attr("checked","checked");$('<div class="alert alert-info">Login to create public/permanent collections.</div>').appendTo(s);s.find("input[name=shrd][value=1]").parent().remove()}}if(q.$hidden){q.$hidden.clone().appendTo(s)}else{$("<input type='hidden' name='c' />").appendTo(s).val(q.c);$("<input type='hidden' name='a' />").appendTo(s).val(q.a)}if(q.iid){$("<input type='hidden' name='iid' />").appendTo(s).val(q.iid)}var t=bootbox.dialog(s,[{label:"Cancel","class":"btn-dismiss"},{label:q.label,"class":"btn-primary",callback:function(){var v=$.trim(s.find("input[name=cn]").val());var u=$.trim(s.find("textarea[name=desc]").val());if(!v){$('<div class="alert alert-error">You must enter a collection name.</div>').appendTo(s);return false}p("Submitting; please wait...");a({a:"additsnc",cn:v,desc:u,shrd:s.find("input[name=shrd]:checked").val()})}}]);t.find("input[type=text],textarea").each(function(){var w=$(this);var v=$("#"+w.attr("id")+"-count");var u=w.attr("maxlength");v.text(u-w.val().length);w.bind("keyup",function(){v.text(u-w.val().length)})})}function a(r){var q=$.extend({},{page:"ajax",id:HT.params.id},r);$.ajax({url:n(),data:q}).done(function(s){var t=i(s);h();if(t.result=="ADD_ITEM_SUCCESS"){c(t)}else{if(t.result=="ADD_ITEM_FAILURE"){o("Item could not be added at this time.")}else{console.log(s)}}}).fail(function(s,u,t){console.log(u,t)})}function c(u){var r=$(".collection-membership");var q=n()+"?a=listis;c="+u.coll_id;var s=$("<a>").attr("href",q).text(u.coll_name);$("<li></li>").appendTo(r).append(s);$(".collection-membership-summary").text(e);var t=d.find("option[value='"+u.coll_id+"']");t.remove()}function g(q,u,t){if(q<=1000&&q+u>1000){var r;if(u>1){r="these "+u+" items"}else{r="this item"}var s="Note: Your collection contains "+q+" items.  Adding "+r+" to your collection will increase its size to more than 1000 items.  This means your collection will not be searchable until it is indexed, usually within 48 hours.  After that, just newly added items will see this delay before they can be searched. \n\nDo you want to proceed?";confirm(s,function(v){if(v){t()}})}else{t()}}$("#PTaddItemBtn").click(function(t){t.preventDefault();var s="addI";l();var q=d.find("select").val();var r=d.find("select option:selected").text();if((q==m)){o("You must select a collection.");return}if(q==f){k({creating:true,c:q,id:HT.params.id,a:s});return}p("Submitting; please wait...");a({c2:q,a:"addits"})})});
/* /htapps/roger.babel/pt/web/js/collection_tools-min.js */
$(document).ready(function(){if($("#accessBannerID").length>0){var f=$("html").hasClass("supaccban");if(f){return}var a=$("html").hasClass("htdev");var h=$.cookie("access.hathitrust.org",undefined,{json:true});var b=$.url();var c=b.param("id");if(h==null){h={}}var d=[];for(var g in h){if(h.hasOwnProperty(g)){d.push(g)}}if((d.indexOf(c)<0)||a){h[c]=1;$.cookie("access.hathitrust.org",h,{json:true,path:"/",domain:".hathitrust.org"});function e(){var i=$("#accessBannerID").html();var j=bootbox.dialog(i,[{label:"OK","class":"btn-primary btn-dismiss"}],{header:"Special access"})}window.setTimeout(e,3000,true)}}});
/* /htapps/roger.babel/pt/web/js/access_banner_02-min.js */
head.ready(function(){var b=$("html");var a="UA-39581946-1";var c=function(){var d=[];d.push("id="+HT.params.id.replace(/\//g,"___"));if(window.location.href.indexOf("/pt/search")>-1){d.push("view=search")}else{d.push("view="+HT.params.view)}if(HT.params.seq){d.push("seq="+HT.params.seq)}return"/"+d.join("/")};$.subscribe("update.reader.state",function(){HT.analytics.trackPageview(c(),a)});if($.trim(b.data("analytics-skip"))=="true"){return}setTimeout(function(){if(HT.analytics.enabled){HT.analytics.trackPageview(c(),a)}},500)});
/* /htapps/roger.babel/pt/web/js/google_analytics_experiment-min.js */
head.ready(function(){var b=$(".search-form form");var g=b.find("input.search-input-text");var c=b.find("select");var f=b.find(".search-input-options");var d=b.find("span.funky-full-view");var a=null;b.delegate(":input","focus change",function(h){console.log("FOCUSING",this);b.addClass("focused");if(a==null){a=$('<div class="modal-backdrop invisible"></div>');a.on("click",function(){e()})}a.appendTo($("body")).show()});$("body").on("focus",":input,a",function(i){var h=$(this);if(!h.closest(".search-form").length){e()}});var e=function(){b.removeClass("focused");if(a!=null){a.detach();a.hide()}};window.focus_form=function(){b.toggleClass("focused")}});
/* /htapps/roger.babel/pt/web/js/header_search-min.js */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(f,d){var i="social-links";var m=i+"__";var h=i+"_opened";var q=location.protocol==="https:"?"https:":"http:";var p=q==="https:";var l={facebook:{label:"Facebook",counterUrl:"https://graph.facebook.com/fql?q=SELECT+total_count+FROM+link_stat+WHERE+url%3D%22{url}%22&callback=?",convertNumber:function(r){return r.data[0].total_count},popupUrl:"https://www.facebook.com/sharer/sharer.php?u={url}",popupWidth:600,popupHeight:500},twitter:{label:"Twitter",counterUrl:"https://cdn.api.twitter.com/1/urls/count.json?url={url}&callback=?",convertNumber:function(r){return r.count},popupUrl:"https://twitter.com/intent/tweet?url={url}&text={post_title}",popupWidth:600,popupHeight:450,click:function(){if(!/[\.\?:\-–—]\s*$/.test(this.options.title)){this.options.title+=":"}return true}},mailru:{counterUrl:q+"//connect.mail.ru/share_count?url_list={url}&callback=1&func=?",convertNumber:function(s){for(var r in s){if(s.hasOwnProperty(r)){return s[r].shares}}},popupUrl:q+"//connect.mail.ru/share?share_url={url}&title={post_title}",popupWidth:550,popupHeight:360},vkontakte:{label:"VK",counterUrl:"https://vk.com/share.php?act=count&url={url}&index={index}",counter:function(u,r){var t=l.vkontakte;if(!t._){t._=[];if(!window.VK){window.VK={}}window.VK.Share={count:function(v,w){t._[v].resolve(w)}}}var s=t._.length;t._.push(r);f.getScript(e(u,{index:s})).fail(r.reject)},popupUrl:q+"//vk.com/share.php?url={url}&title={post_title}",popupWidth:550,popupHeight:330},odnoklassniki:{counterUrl:p?d:"http://connect.ok.ru/dk?st.cmd=extLike&ref={url}&uid={index}",counter:function(u,r){var t=l.odnoklassniki;if(!t._){t._=[];if(!window.ODKL){window.ODKL={}}window.ODKL.updateCount=function(v,w){t._[v].resolve(w)}}var s=t._.length;t._.push(r);f.getScript(e(u,{index:s})).fail(r.reject)},popupUrl:"http://connect.ok.ru/dk?st.cmd=WidgetSharePreview&service=odnoklassniki&st.shareUrl={url}",popupWidth:550,popupHeight:360},plusone:{label:"Google+",counterUrl:p?d:"http://share.yandex.ru/gpp.xml?url={url}",counter:function(t,r){var s=l.plusone;if(s._){r.reject();return}if(!window.services){window.services={}}window.services.gplus={cb:function(u){if(typeof u==="string"){u=u.replace(/\D/g,"")}s._.resolve(parseInt(u,10))}};s._=r;f.getScript(e(t)).fail(r.reject)},popupUrl:"https://plus.google.com/share?url={url}",popupWidth:700,popupHeight:500},pinterest:{label:"Pinterest",counterUrl:q+"//api.pinterest.com/v1/urls/count.json?url={url}&callback=?",convertNumber:function(r){return r.count},popupUrl:q+"//pinterest.com/pin/create/button/?url={url}&description={post_title}",popupWidth:630,popupHeight:360},tumblr:{label:"Tumblr",counterUrl:q+"//api.pinterest.com/v1/urls/count.json?url={url}&callback=?",convertNumber:function(r){return r.count},popupUrl1:q+"//www.tumblr.com/share/link?url={url}&description={post_title}",popupUrl2:q+"//www.tumblr.com/share/photo?source={media}&click_thru={url}&description={post_title}",click:function(){if(this.widget.data("media")){this.options.popupUrl=this.options.popupUrl2}else{this.options.popupUrl=this.options.popupUrl1}return true},popupWidth:630,popupHeight:360},reddit:{label:"Reddit",counterUrl:q+"//api.pinterest.com/v1/urls/count.json?url={url}&callback=?",convertNumber:function(r){return r.count},popupUrl:q+"//reddit.com/submit?url={url}&description={post_title}",popupWidth:630,popupHeight:360},EOT:true};f.fn.socialLinks=function(r){return this.each(function(){var t=f(this);var s=t.data(i);if(s){if(f.isPlainObject(r)){s.update(r)}}else{s=new a(t,f.extend({},f.fn.socialLinks.defaults,r,k(t)));t.data(i,s)}})};var c=document.title.split(" | ")[0].split(" - ");if(f.inArray(c[c.length-1],["Full View","Limited View","Item Not Available"])!==-1){c.pop()}c=c.join(" - ")+" | HathiTrust";console.log("TITLE",c);f.fn.socialLinks.defaults={url:window.location.href.replace(window.location.hash,""),post_title:c,counters:true,zeroes:false,wait:500,timeout:10000,popupCheckInterval:500,singleTitle:"Share"};function a(r,s){this.container=r;this.options=s;this.init()}a.prototype={init:function(){this.container.addClass(i);this.initUserButtons();var r=this.container.children();this.buttons=[];r.each(f.proxy(function(s,u){var t=new g(f(u),this.options);this.buttons.push(t)},this))},initUserButtons:function(){if(!this.userButtonInited&&window.socialLinksButtons){f.extend(true,l,socialLinksButtons)}this.userButtonInited=true},appear:function(){this.container.addClass(i+"_visible")},ready:function(r){if(this.timeout){clearTimeout(this.timeout)}this.container.addClass(i+"_ready");if(!r){this.container.trigger("ready."+i,this.number)}},};function g(s,r){this.widget=s;this.options=f.extend({},r);this.detectService();if(this.service){this.init()}}g.prototype={init:function(){this.detectParams();this.initHtml();setTimeout(f.proxy(this.initCounter,this),0)},update:function(r){f.extend(this.options,{forceUpdate:false},r);this.widget.find("."+i+"__counter").remove();this.initCounter()},detectService:function(){var r=this.widget.data("service");if(!r){var u=this.widget[0];var t=u.classList||u.className.split(" ");for(var v=0;v<t.length;v++){var s=t[v];if(l[s]){r=s;break}}if(!r){return}}this.service=r;f.extend(this.options,l[r])},detectParams:function(){var s=this.widget.data();if(s.counter){var r=parseInt(s.counter,10);if(isNaN(r)){this.options.counterUrl=s.counter}else{this.options.counterNumber=r}}if(s.title){this.options.title=s.title;delete s.title}if(s.url){this.options.url=s.url}},initHtml:function(){var s=this.options;var v=this.widget;var t=v;if(s.clickUrl){var r=e(s.clickUrl,{url:s.url,post_title:s.post_title});var u=f("<a>",{href:r});this.cloneDataAttrs(v,u);v.replaceWith(u);this.widget=v=u}else{v.on("click",f.proxy(this.click,this))}v.tooltip({title:v.text(),animation:false});this.button=t},initCounter:function(){},cloneDataAttrs:function(u,r){var t=u.data();for(var s in t){if(t.hasOwnProperty(s)){r.data(s,t[s])}}},getElementClassNames:function(r){return j(r,this.service)},updateCounter:function(s){s=parseInt(s,10)||0;var t={"class":this.getElementClassNames("counter"),text:s};if(!s&&!this.options.zeroes){t["class"]+=" "+i+"__counter_empty";t.text=""}var r=f("<span>",t);this.widget.append(r);this.widget.trigger("counter."+i,[this.service,s])},click:function(v){var s=this.options;var u=true;if(f.isFunction(s.click)){u=s.click.call(this,v)}if(u){var t={url:s.url,post_title:s.post_title};if(this.widget.data("media")){t.media=this.widget.data("media")}var r=e(s.popupUrl,t);r=this.addAdditionalParamsToUrl(r);this.openPopup(r,{width:s.popupWidth,height:s.popupHeight})}return false},addAdditionalParamsToUrl:function(r){var t=k(this.widget);var u=f.param(f.extend(t,this.options.data));if(f.isEmptyObject(u)){return r}var s=r.indexOf("?")===-1?"?":"&";return r+s+u},openPopup:function(r,v){var u=Math.round(screen.width/2-v.width/2);var t=0;if(screen.height>v.height){t=Math.round(screen.height/3-v.height/2)}var s=window.open(r,"sl_"+this.service,"left="+u+",top="+t+",width="+v.width+",height="+v.height+",personalbar=0,toolbar=0,scrollbars=1,resizable=1");if(s){s.focus();this.widget.trigger("popup_opened."+i,[this.service,s]);var w=setInterval(f.proxy(function(){if(!s.closed){return}clearInterval(w);this.widget.trigger("popup_closed."+i,this.service)},this),this.options.popupCheckInterval)}else{location.href=r}}};function k(u){function t(x,y){return y.toUpper()}var r={};var w=u.data();for(var s in w){if(s=="tooltip"){continue}var v=w[s];if(v==="yes"){v=true}else{if(v==="no"){v=false}}r[s.replace(/-(\w)/g,t)]=v}return r}function e(r,s){return o(r,s,encodeURIComponent)}function o(r,s,t){return r.replace(/\{([^\}]+)\}/g,function(u,v){return v in s?(t?t(s[v]):s[v]):u})}function j(t,s){var r=m+t;return r+" "+r+"_"+s}function n(t,v){function s(w){if((w.type==="keydown"&&w.which!==27)||f(w.target).closest(t).length){return}t.removeClass(h);u.off(r,s);if(f.isFunction(v)){v()}}var u=f(document);var r="click touchstart keydown";u.on(r,s)}function b(s){var v=10;if(document.documentElement.getBoundingClientRect){var u=parseInt(s.css("left"),10);var t=parseInt(s.css("top"),10);var r=s[0].getBoundingClientRect();if(r.left<v){s.css("left",v-r.left+u)}else{if(r.right>window.innerWidth-v){s.css("left",window.innerWidth-r.right-v+u)}}if(r.top<v){s.css("top",v-r.top+t)}else{if(r.bottom>window.innerHeight-v){s.css("top",window.innerHeight-r.bottom-v+t)}}}s.addClass(h)}f(function(){f("."+i).socialLinks()})}));
/* /htapps/roger.babel/pt/web/js/social_links-min.js */
